<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ã€Œ15ã€Plan9 æ±‡ç¼–å°è®°</title>
    <url>/archives/2ce846ed.html</url>
    <content><![CDATA[<h4 id="å‰åº"><a href="#å‰åº" class="headerlink" title="å‰åº"></a>å‰åº</h4><blockquote>
<p>å¹³å¸¸codingæ—¶ï¼Œå¶å°”ä¼šæŸ¥çœ‹è®¡ç®—æœºçš„å…·ä½“æ‰§è¡Œè¿‡ç¨‹ï¼Œé‚£æœ€åŸºæœ¬çš„å°±æ˜¯æ±‡ç¼–äº†ï¼Œäº†è§£æ±‡ç¼–æ˜¯è°ƒè¯•è¿‡ç¨‹ä¸­å¿…ä¸å¯å°‘çš„ï¼Œå°¤å…¶æ˜¯ä¸€äº›ç»†èŠ‚çš„å¤„ç†æ–¹é¢.Goçš„æ±‡ç¼–æ˜¯Plan 9(è´å°”å®éªŒå®¤çš„äº§ç‰©)ï¼Œå’Œæ±‡ç¼–å¾ˆç±»ä¼¼ã€‚</p>
</blockquote>
<h4 id="å¦‚ä½•å¾—åˆ°æ±‡ç¼–ç»“æœï¼Ÿ"><a href="#å¦‚ä½•å¾—åˆ°æ±‡ç¼–ç»“æœï¼Ÿ" class="headerlink" title="å¦‚ä½•å¾—åˆ°æ±‡ç¼–ç»“æœï¼Ÿ"></a>å¦‚ä½•å¾—åˆ°æ±‡ç¼–ç»“æœï¼Ÿ</h4><ul>
<li>å®˜ç½‘æ–‡æ¡£</li>
<li>Google</li>
</ul>
<h5 id="3ç§æ–¹å¼ï¼š"><a href="#3ç§æ–¹å¼ï¼š" class="headerlink" title="3ç§æ–¹å¼ï¼š"></a>3ç§æ–¹å¼ï¼š</h5><blockquote>
<p>ç¬¬ä¸€ç§</p>
</blockquote>
<a id="more"></a>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">go</span> tool compile -N -l -S ***.<span class="keyword">go</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>ç¬¬äºŒç§</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>ã€å…ˆç¼–è¯‘ï¼š</span><br><span class="line">    <span class="keyword">go</span> tool compile -N -l ***.<span class="keyword">go</span></span><br><span class="line"><span class="number">2</span>ã€å†åç¼–è¯‘ï¼š</span><br><span class="line">    <span class="keyword">go</span> tool objdump ***.o</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç¬¬ä¸‰ç§</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">go</span> build -gcflags -S ***.<span class="keyword">go</span></span><br></pre></td></tr></table></figure>


<h4 id="å¸¸ç”¨å¯„å­˜å™¨"><a href="#å¸¸ç”¨å¯„å­˜å™¨" class="headerlink" title="å¸¸ç”¨å¯„å­˜å™¨"></a>å¸¸ç”¨å¯„å­˜å™¨</h4><h5 id="AX-BX-CX-DX-BP-SI-SP-IP"><a href="#AX-BX-CX-DX-BP-SI-SP-IP" class="headerlink" title="AX BX CX DX BP SI SP IP"></a>AX BX CX DX BP SI SP IP</h5><table>
<thead>
<tr>
<th align="left">å¯„å­˜å™¨</th>
<th align="left">16ä½</th>
<th align="left">32ä½</th>
<th align="left">64ä½</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ç´¯åŠ å¯„å­˜å™¨</td>
<td align="left">AX</td>
<td align="left">EAX</td>
<td align="left">RAX</td>
</tr>
<tr>
<td align="left">åŸºå€å¯„å­˜å™¨</td>
<td align="left">BX</td>
<td align="left">EBX</td>
<td align="left">RBX</td>
</tr>
<tr>
<td align="left">è®¡æ•°å¯„å­˜å™¨</td>
<td align="left">CX</td>
<td align="left">ECX</td>
<td align="left">RCX</td>
</tr>
<tr>
<td align="left">æ•°æ®å¯„å­˜å™¨</td>
<td align="left">DX</td>
<td align="left">EDX</td>
<td align="left">RDX</td>
</tr>
<tr>
<td align="left">å †æ ˆåŸºæŒ‡é’ˆ</td>
<td align="left">BP</td>
<td align="left">EBP</td>
<td align="left">RBP</td>
</tr>
<tr>
<td align="left">å˜å€å¯„å­˜å™¨</td>
<td align="left">SI</td>
<td align="left">ESI</td>
<td align="left">RSI</td>
</tr>
<tr>
<td align="left">å †æ ˆé¡¶æŒ‡é’ˆ</td>
<td align="left">SP</td>
<td align="left">ESP</td>
<td align="left">RSP</td>
</tr>
<tr>
<td align="left">æŒ‡ä»¤å¯„å­˜å™¨</td>
<td align="left">IP</td>
<td align="left">EIP</td>
<td align="left">RIP</td>
</tr>
</tbody></table>
<h5 id="MOV"><a href="#MOV" class="headerlink" title="MOV"></a>MOV</h5><blockquote>
<p>movbï¼ˆ8ä½ï¼‰ã€movwï¼ˆ16ä½ï¼‰ã€movlï¼ˆ32ä½ï¼‰ã€movqï¼ˆ64ä½ï¼‰</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">MOVSS: ç§»åŠ¨å•ç²¾åº¦æµ®ç‚¹æ•°</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥è¯¢åœ°å€"><a href="#æŸ¥è¯¢åœ°å€" class="headerlink" title="æŸ¥è¯¢åœ°å€"></a>æŸ¥è¯¢åœ°å€</h4><p><a href="https://c9x.me/x86/html/file_module_x86_id_205.html">MOVSS</a><br><a href="https://www.felixcloutier.com/x86/index.html">Intelæ±‡ç¼–æŒ‡ä»¤æŸ¥è¯¢</a><br><a href="https://plan9.io/sources/contrib/ericvh/go-plan9/src/pkg/runtime/slice.c">Plan9æŸ¥è¯¢</a></p>
<h4 id="æŒç»­æ›´æ–°â€¦"><a href="#æŒç»­æ›´æ–°â€¦" class="headerlink" title="æŒç»­æ›´æ–°â€¦."></a>æŒç»­æ›´æ–°â€¦.</h4>]]></content>
      <tags>
        <tag>Go</tag>
        <tag>Day</tag>
        <tag>Plan9</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ13ã€Linux è¿›ç¨‹</title>
    <url>/archives/ba455c1d.html</url>
    <content><![CDATA[<p>è¿›ç¨‹è¿™æ˜¯ä¸ªè€ç”Ÿå¸¸è°ˆçš„é—®é¢˜ï¼Œå½“ç„¶æˆ‘ä¸æ˜¯é‚£ä¸ªè€ç”Ÿï¼Œæˆ‘åªæ˜¯ä¸ªloserã€‚</p>
<p>ä»Šå¤©ç”¨chromeï¼Œå ç”¨å¾ˆå¤šçš„å†…å­˜å’Œèµ„æºï¼ŒæŸ¥äº†æŸ¥ï¼Œè¯´chromeæ˜¯å¤šè¿›ç¨‹çš„ï¼Œäºæ˜¯å°±æƒ³äº†è§£ä¸‹è¿›ç¨‹ä¸€äº›ç›¸å…³çš„å†…å®¹ã€‚<br>ä¸»è¦ä»ä»¥ä¸‹å‡ ä¸ªè§’åº¦äº†è§£ä¸‹è¿›ç¨‹ï¼š</p>
<ul>
<li>æ¥æº</li>
<li>å®šä¹‰</li>
<li>ç‰¹å¾</li>
<li>å¤šè¿›ç¨‹å¦‚ä½•å·¥ä½œï¼Ÿ</li>
<li>é€šä¿¡</li>
</ul>
<a id="more"></a>

<h3 id="æ¥æº"><a href="#æ¥æº" class="headerlink" title="æ¥æº"></a>æ¥æº</h3><p>æŠ½è±¡æ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼Œæˆ–è€…è¯´æ˜¯å¯¹è®¡ç®—æœºç³»ç»Ÿå­˜å‚¨å™¨çš„è°ƒåº¦å’Œç®¡ç†ã€‚</p>
<h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>è¿›ç¨‹ï¼šå¹¶å‘ç¨‹åºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­èµ„æºåˆ†é…å’Œç®¡ç†çš„æœ€åŸºæœ¬çš„å•å…ƒï¼ˆèµ„æºåˆ†é…çš„æœ€å°å•å…ƒï¼Œæ‰§è¡Œçš„æœ€å°å•å…ƒï¼‰ã€‚ä¸€ä¸ªç¨‹åºä¸€æ—¦å¼€å§‹æ‰§è¡Œï¼Œå°±æ˜¯ä¸€ä¸ªè¿›ç¨‹ã€‚æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹ç©ºé—´ï¼Œç³»ç»Ÿä¼šåˆ†é…ä¸€å®šçš„åœ°å€ç©ºé—´å’Œå®Œæ•´çš„æ•°æ®æ®µç©ºé—´ã€‚</p>
<p>ps:[çº¿ç¨‹ï¼šç¨‹åºæ‰§è¡Œçš„æœ€å°å•ä½ã€‚]</p>
<p>ç»„æˆï¼šç¨‹åºã€æ•°æ®ã€æ§åˆ¶å—ç»„æˆã€‚</p>
<h3 id="ç‰¹å¾"><a href="#ç‰¹å¾" class="headerlink" title="ç‰¹å¾"></a>ç‰¹å¾</h3><ul>
<li>åŠ¨æ€æ€§ ï¼š å¤šä¸ªç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¸€æ¬¡æ‰§è¡Œè¿‡ç¨‹ï¼Œè¿›ç¨‹æ˜¯åŠ¨æ€äº§ç”Ÿï¼ŒåŠ¨æ€é”€æ¯çš„ã€‚</li>
<li>å¹¶å‘æ€§ ï¼š ä»»ä½•è¿›ç¨‹å¯ä»¥å’Œå…¶å®ƒè¿›ç¨‹å¹¶å‘æ‰§è¡Œã€‚</li>
<li>ç‹¬ç«‹æ€§ ï¼š æ˜¯ç‹¬ç«‹è¿è¡Œçš„åŸºæœ¬å•å…ƒï¼Œä¹Ÿæ˜¯èµ„æºåˆ†é…å’Œè°ƒåº¦çš„ç‹¬ç«‹å•å…ƒã€‚</li>
<li>å¼‚æ­¥æ€§ ï¼š ç”±äºè¿›ç¨‹é—´çš„ç›¸äº’åˆ¶çº¦ï¼Œè¿›ç¨‹é—´æ˜¯å„è‡ªç‹¬ç«‹ï¼Œå„è‡ªå‘å‰ã€‚</li>
</ul>
<h3 id="å¤šè¿›ç¨‹å·¥ä½œï¼š"><a href="#å¤šè¿›ç¨‹å·¥ä½œï¼š" class="headerlink" title="å¤šè¿›ç¨‹å·¥ä½œï¼š"></a>å¤šè¿›ç¨‹å·¥ä½œï¼š</h3><h4 id="è¿›ç¨‹çš„çŠ¶æ€ï¼š"><a href="#è¿›ç¨‹çš„çŠ¶æ€ï¼š" class="headerlink" title="è¿›ç¨‹çš„çŠ¶æ€ï¼š"></a>è¿›ç¨‹çš„çŠ¶æ€ï¼š</h4><blockquote>
<p>3ç§çŠ¶æ€ï¼š</p>
</blockquote>
<ul>
<li>å°±ç»ª</li>
<li>è¿è¡Œ</li>
<li>é˜»å¡</li>
</ul>
<h5 id="3æ€å›¾ï¼š"><a href="#3æ€å›¾ï¼š" class="headerlink" title="3æ€å›¾ï¼š"></a>3æ€å›¾ï¼š</h5><p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/linux_process_3.1.png"></p>
<h5 id="5æ€å›¾ï¼š"><a href="#5æ€å›¾ï¼š" class="headerlink" title="5æ€å›¾ï¼š"></a>5æ€å›¾ï¼š</h5><p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/linux_p3.png"></p>
<h5 id="7æ€å›¾ï¼š"><a href="#7æ€å›¾ï¼š" class="headerlink" title="7æ€å›¾ï¼š"></a>7æ€å›¾ï¼š</h5><p>æ–°å¢ä¸¤ç§çŠ¶æ€ï¼š</p>
<ul>
<li>æŒ‚èµ·å°±ç»ªçŠ¶æ€ï¼šè¡¨æ˜è¿›ç¨‹å…·å¤‡äº†è¿è¡Œçš„æ¡ä»¶ï¼Œç›®å‰åœ¨äºŒçº§å­˜å‚¨å™¨é‡Œé¢ã€‚</li>
<li>æŒ‚èµ·ç­‰å¾…çŠ¶æ€ï¼šè¡¨æ˜è¿›ç¨‹æ­£åœ¨ç­‰å¾…æŸä¸€ä¸ªäº‹ä»¶çš„ç»“æŸä¸”ç›®å‰åœ¨äºŒçº§å­˜å‚¨å™¨é‡Œé¢ã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/linux_process_7.png"></p>
<h3 id="è¿›ç¨‹é—´é€šä¿¡"><a href="#è¿›ç¨‹é—´é€šä¿¡" class="headerlink" title="è¿›ç¨‹é—´é€šä¿¡"></a>è¿›ç¨‹é—´é€šä¿¡</h3><h4 id="å…±äº«å†…å­˜"><a href="#å…±äº«å†…å­˜" class="headerlink" title="å…±äº«å†…å­˜"></a>å…±äº«å†…å­˜</h4><p>æ˜ å°„ä¸€æ®µèƒ½è¢«å…¶å®ƒè¿›ç¨‹è®¿é—®çš„å†…å­˜ï¼Œä¸€ä¸ªè¿›ç¨‹åˆ›å»ºï¼Œå…¶å®ƒè¿›ç¨‹å¯è®¿é—®ã€‚å…±äº«å†…å­˜æ˜¯æœ€å¿«çš„IPCæ–¹å¼ï¼Œå¾€å¾€å’Œä¿¡å·é‡ä¸€èµ·ä½¿ç”¨ï¼Œè¾¾åˆ°è¿›ç¨‹é—´çš„åŒæ­¥å’Œäº’æ–¥ã€‚</p>
<h4 id="ç®¡é“"><a href="#ç®¡é“" class="headerlink" title="ç®¡é“"></a>ç®¡é“</h4><p>å®è´¨å°±æ˜¯ä¸€ä¸ªç¼“å†²åŒºã€‚<br>ç®¡é“é™åˆ¶ï¼š</p>
<ul>
<li>åŠåŒå·¥</li>
<li>åªèƒ½åœ¨äº²ç¼˜è¿›ç¨‹é—´é€šä¿¡</li>
</ul>
<p><strong>ç‰¹ç‚¹:</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å†™æ»¡æ—¶ï¼Œä¸èƒ½å†å†™ï¼Œè¯»ç©ºæ—¶ï¼Œä¸èƒ½å†è¯»</span><br><span class="line">æ²¡å†™æ»¡ï¼Œä¸èƒ½è¯»ï¼Œæ²¡è¯»ç©ºï¼Œä¸èƒ½å†™</span><br></pre></td></tr></table></figure>

<h4 id="æ¶ˆæ¯é˜Ÿåˆ—"><a href="#æ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—"></a>æ¶ˆæ¯é˜Ÿåˆ—</h4><p>æ˜¯ä¸€ç§æ¶ˆæ¯çš„é“¾è¡¨ï¼Œè§£å†³äº†ä¿¡å·ä¼ é€’ä¿¡æ¯å°‘ï¼Œç®¡é“åªèƒ½æ‰¿è½½æ— æ ¼å¼å­—èŠ‚æµåŠç®¡é“å¤§å°é™åˆ¶çš„ç¼ºç‚¹ã€‚</p>
<h4 id="ä¿¡å·"><a href="#ä¿¡å·" class="headerlink" title="ä¿¡å·"></a>ä¿¡å·</h4><p>é€šçŸ¥å’Œæ¥å—è¿›ç¨‹æŸä¸ªäº‹ä»¶å·²ç»å‘ç”Ÿäº†çš„ã€‚</p>
<h4 id="ä¿¡å·é‡"><a href="#ä¿¡å·é‡" class="headerlink" title="ä¿¡å·é‡"></a>ä¿¡å·é‡</h4><p>å®è´¨ä¸Šå°±æ˜¯ä¸ªè®¡æ•°å™¨ï¼Œç”¨æ¥æ§åˆ¶å¤šä¸ªè¿›ç¨‹å¯¹äºå…±äº«èµ„æºçš„è®¿é—®æƒ…å†µã€‚</p>
<h4 id="å¥—æ¥å­—ï¼ˆSocketï¼‰"><a href="#å¥—æ¥å­—ï¼ˆSocketï¼‰" class="headerlink" title="å¥—æ¥å­—ï¼ˆSocketï¼‰"></a>å¥—æ¥å­—ï¼ˆSocketï¼‰</h4><p>è¿›ç¨‹é—´é€šä¿¡çš„ä¸€ç§æœºåˆ¶ï¼Œå¤šç”¨äºä¸åŒæœºå™¨è¿›ç¨‹é—´çš„é€šä¿¡ã€‚</p>
<h4 id="ä¼˜ç¼ºç‚¹ï¼š"><a href="#ä¼˜ç¼ºç‚¹ï¼š" class="headerlink" title="ä¼˜ç¼ºç‚¹ï¼š"></a>ä¼˜ç¼ºç‚¹ï¼š</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>ã€ç®¡é“ï¼šé€Ÿåº¦æ…¢ï¼Œå®¹é‡æœ‰é™ï¼Œåªæœ‰çˆ¶å­è¿›ç¨‹èƒ½é€šè®¯.</span><br><span class="line"><span class="number">2</span>ã€FIFOï¼šä»»ä½•è¿›ç¨‹é—´éƒ½èƒ½é€šè®¯ï¼Œä½†é€Ÿåº¦æ…¢.</span><br><span class="line"><span class="number">3</span>ã€æ¶ˆæ¯é˜Ÿåˆ—ï¼šå®¹é‡å—åˆ°ç³»ç»Ÿé™åˆ¶ï¼Œä¸”è¦æ³¨æ„ç¬¬ä¸€æ¬¡è¯»çš„æ—¶å€™ï¼Œè¦è€ƒè™‘ä¸Šä¸€æ¬¡æ²¡æœ‰è¯»å®Œæ•°æ®çš„é—®é¢˜.</span><br><span class="line"><span class="number">4</span>ã€ä¿¡å·é‡ï¼šä¸èƒ½ä¼ é€’å¤æ‚æ¶ˆæ¯ï¼Œåªèƒ½ç”¨æ¥åŒæ­¥.</span><br><span class="line"><span class="number">5</span>ã€å…±äº«å†…å­˜åŒºï¼šèƒ½å¤Ÿå¾ˆå®¹æ˜“æ§åˆ¶å®¹é‡ï¼Œé€Ÿåº¦å¿«ï¼Œä½†è¦ä¿æŒåŒæ­¥ï¼Œæ¯”å¦‚ä¸€ä¸ªè¿›ç¨‹åœ¨å†™çš„æ—¶å€™ï¼Œå¦ä¸€ä¸ªè¿›ç¨‹è¦æ³¨æ„è¯»å†™çš„é—®é¢˜ï¼Œç›¸å½“äºçº¿ç¨‹ä¸­çš„çº¿ç¨‹å®‰å…¨ï¼Œå½“ç„¶ï¼Œå…±äº«å†…å­˜åŒºåŒæ ·å¯ä»¥ç”¨ä½œçº¿ç¨‹é—´é€šè®¯ï¼Œä¸è¿‡æ²¡è¿™ä¸ªå¿…è¦ï¼Œçº¿ç¨‹é—´æœ¬æ¥å°±å·²ç»å…±äº«äº†åŒä¸€è¿›ç¨‹å†…çš„ä¸€å—å†…å­˜.</span><br></pre></td></tr></table></figure>

<h3 id="END"><a href="#END" class="headerlink" title="END"></a>END</h3>]]></content>
      <tags>
        <tag>Linux</tag>
        <tag>è¿›ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ20ã€åšå®¢è¯¡å¼‚äº‹ä»¶</title>
    <url>/archives/5ce14ff5.html</url>
    <content><![CDATA[<h3 id="åšå®¢CI-CDå´©äº†"><a href="#åšå®¢CI-CDå´©äº†" class="headerlink" title="åšå®¢CI CDå´©äº†"></a>åšå®¢CI CDå´©äº†</h3><blockquote>
<p>å°±åœ¨åˆšæ‰ä¿®æ”¹äº†éƒ¨åˆ†çš„configé…ç½®ï¼Œåæ‰“äº†tag pushäº†ä¸Šå»,</p>
</blockquote>
<blockquote>
<p>ohâ€¦â€¦GGäº†</p>
</blockquote>
<a id="more"></a>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">err: FATAL Something&#39;s wrong. Maybe you can find the solution here: https:&#x2F;&#x2F;hexo.io&#x2F;docs&#x2F;troubleshooting.html</span><br><span class="line">err: TypeError: Cannot read property &#39;enable&#39; of undefined</span><br><span class="line">err:     at ***&#x2F;themes&#x2F;nextTheme&#x2F;scripts&#x2F;filters&#x2F;comment&#x2F;disqus.js:11:21</span><br><span class="line">err:     at Filter.execSync (&#x2F;***&#x2F;node_modules&#x2F;hexo&#x2F;lib&#x2F;extend&#x2F;filter.js:74:28)</span><br><span class="line">err:     at Hexo.execFilterSync (&#x2F;***&#x2F;node_modules&#x2F;hexo&#x2F;lib&#x2F;hexo&#x2F;index.js:432:29)</span><br><span class="line">err:     at module.exports (***&#x2F;themes&#x2F;nextTheme&#x2F;scripts&#x2F;events&#x2F;lib&#x2F;injects.js:58:8)</span><br><span class="line">err:     at Hexo.&lt;anonymous&gt; (***&#x2F;themes&#x2F;nextTheme&#x2F;scripts&#x2F;events&#x2F;index.js:9:27)</span><br><span class="line">err:     at Hexo.emit (events.js:314:20)</span><br><span class="line">err:     at Hexo._generate (&#x2F;***&#x2F;node_modules&#x2F;hexo&#x2F;lib&#x2F;hexo&#x2F;index.js:399:8)</span><br><span class="line">err:     at &#x2F;***&#x2F;node_modules&#x2F;hexo&#x2F;lib&#x2F;hexo&#x2F;index.js:249:***</span><br><span class="line">err:     at tryCatcher (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;util.js:16:23)</span><br><span class="line">err:     at Promise._settlePromiseFromHandler (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:547:31)</span><br><span class="line">err:     at Promise._settlePromise (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:604:18)</span><br><span class="line">err:     at Promise._settlePromise0 (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:649:10)</span><br><span class="line">err:     at Promise._settlePromises (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:729:18)</span><br><span class="line">err:     at Promise._fulfill (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:673:18)</span><br><span class="line">err:     at PromiseArray._resolve (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise_array.js:127:19)</span><br><span class="line">err:     at PromiseArray._promiseFulfilled (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise_array.js:145:14)</span><br><span class="line">err:     at Promise._settlePromise (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:609:26)</span><br><span class="line">err:     at Promise._settlePromise0 (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:649:10)</span><br><span class="line">err:     at Promise._settlePromises (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:729:18)</span><br><span class="line">err:     at Promise._fulfill (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:673:18)</span><br><span class="line">err:     at Promise._resolveCallback (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:466:57)</span><br><span class="line">err:     at Promise._settlePromiseFromHandler (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:559:17)</span><br><span class="line">out: INFO  Start processing</span><br><span class="line">err: FATAL Something&#39;s wrong. Maybe you can find the solution here: https:&#x2F;&#x2F;hexo.io&#x2F;docs&#x2F;troubleshooting.html</span><br><span class="line">err: TypeError: Cannot read property &#39;enable&#39; of undefined</span><br><span class="line">err:     at ***&#x2F;themes&#x2F;nextTheme&#x2F;scripts&#x2F;filters&#x2F;comment&#x2F;disqus.js:11:21</span><br><span class="line">err:     at Filter.execSync (&#x2F;***&#x2F;node_modules&#x2F;hexo&#x2F;lib&#x2F;extend&#x2F;filter.js:74:28)</span><br><span class="line">err:     at Hexo.execFilterSync (&#x2F;***&#x2F;node_modules&#x2F;hexo&#x2F;lib&#x2F;hexo&#x2F;index.js:432:29)</span><br><span class="line">err:     at module.exports (***&#x2F;themes&#x2F;nextTheme&#x2F;scripts&#x2F;events&#x2F;lib&#x2F;injects.js:58:8)</span><br><span class="line">err:     at Hexo.&lt;anonymous&gt; (***&#x2F;themes&#x2F;nextTheme&#x2F;scripts&#x2F;events&#x2F;index.js:9:27)</span><br><span class="line">err:     at Hexo.emit (events.js:314:20)</span><br><span class="line">err:     at Hexo._generate (&#x2F;***&#x2F;node_modules&#x2F;hexo&#x2F;lib&#x2F;hexo&#x2F;index.js:399:8)</span><br><span class="line">err:     at &#x2F;***&#x2F;node_modules&#x2F;hexo&#x2F;lib&#x2F;hexo&#x2F;index.js:249:***</span><br><span class="line">err:     at tryCatcher (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;util.js:16:23)</span><br><span class="line">err:     at Promise._settlePromiseFromHandler (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:547:31)</span><br><span class="line">err:     at Promise._settlePromise (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:604:18)</span><br><span class="line">err:     at Promise._settlePromise0 (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:649:10)</span><br><span class="line">err:     at Promise._settlePromises (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:729:18)</span><br><span class="line">err:     at Promise._fulfill (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:673:18)</span><br><span class="line">err:     at PromiseArray._resolve (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise_array.js:127:19)</span><br><span class="line">err:     at PromiseArray._promiseFulfilled (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise_array.js:145:14)</span><br><span class="line">err:     at Promise._settlePromise (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:609:26)</span><br><span class="line">err:     at Promise._settlePromise0 (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:649:10)</span><br><span class="line">err:     at Promise._settlePromises (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:729:18)</span><br><span class="line">err:     at Promise._fulfill (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:673:18)</span><br><span class="line">err:     at Promise._resolveCallback (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:466:57)</span><br><span class="line">err:     at Promise._settlePromiseFromHandler (&#x2F;***&#x2F;node_modules&#x2F;bluebird&#x2F;js&#x2F;release&#x2F;promise.js:559:17)</span><br></pre></td></tr></table></figure>

<p>ç®€å•ç‚¹ï¼Œæ˜¾ç¤ºæ²¡æœ‰enableè¿™ä¸ªå±æ€§ï¼Œï¼Œï¼Œï¼Œæˆ‘æ‡µäº†ï¼Œè¿™éƒ¨ç½²äº†å¤šå°‘æ¬¡äº†ï¼Œæ²¡æœ‰å‡ºç°è¿™ä¹ˆä¸ªé”™è¯¯å•Šã€‚</p>
<p>å…ˆåˆ äº†jsï¼Œæœ¬åœ°è·‘okäº†ï¼Œè¿œç«¯æŒ‚äº†ï¼Œåˆæç¤ºå¦ä¸€ä¸ªjsé”™è¯¯ã€‚<br>å†åˆ ä¸€ä¸ªé”™è¯¯çš„js,å†è·‘â€¦.åˆæŒ‚äº†!</p>
<h3 id="æ’æŸ¥â€¦"><a href="#æ’æŸ¥â€¦" class="headerlink" title="æ’æŸ¥â€¦"></a>æ’æŸ¥â€¦</h3><blockquote>
<p>åˆæ­¥å®šä½ä¸ºæ–‡ä»¶æ²¡æœ‰æ›´åˆ°æœ€æ–°</p>
</blockquote>
<p>æœ¬åœ°ok,æœåŠ¡å™¨éƒ¨ç½²ä¸èµ·æ¥â€¦..</p>
<p>æŸ¥ä¸‹æ–‡ä»¶scp copyçš„å·¥ä½œæµ</p>
<p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A120201117-000817@2x.png"></p>
<p>çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä¹Ÿå¾ˆå¥½ç”¨ï¼Œä½†æ˜¯å‘¢ï¼Œå¤§å‘æ¥äº†â€¦â€¦â€¦.<br>å½“æ—¶æ²¡æœ‰é€‰æ‹©æ˜¯å¦é€‰æ‹©è¦†ç›–æ–‡ä»¶ï¼š</p>
<p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A120201117-001054@2x.png"></p>
<h3 id="é—®é¢˜ç‚¹"><a href="#é—®é¢˜ç‚¹" class="headerlink" title="é—®é¢˜ç‚¹"></a>é—®é¢˜ç‚¹</h3><p>æ²¡æœ‰è¦†ç›–é…ç½®æ–‡ä»¶ï¼Œå¯¼è‡´æ®‹ç•™æˆ–è€…ä¿®æ”¹ä¸å½»åº•ï¼ŒåŒåçš„å§‹ç»ˆä¸ä¿®æ”¹ï¼Œå¯¼è‡´çš„é—®é¢˜ã€‚</p>
<p>PSï¼šèŠ±äº†åŠä¸ªå°æ—¶å®šä½è¿™ä¹ˆä¸ªrewriteçš„é—®é¢˜ï¼ è®°ç€å§ï¼Œæé†’è‡ªå·±â€¦.</p>
<h3 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h3><p><a href="https://github.com/appleboy/scp-action/blob/master/action.yml#L44">copy workflow Github</a><br><a href="https://github.com/marketplace/actions/scp-files">scp copy workflow</a></p>
]]></content>
      <tags>
        <tag>Day</tag>
        <tag>åšå®¢</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ19ã€GPM-2.1-è°ƒåº¦æµç¨‹</title>
    <url>/archives/5c6a362f.html</url>
    <content><![CDATA[<p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆçŸ¥å…¶æ‰€ä»¥ç„¶â€¦â€¦<br>å­¦ä¹ GPMè°ƒåº¦ä¹‹å‰ï¼Œå…ˆçœ‹ä¸‹æºç éƒ¨åˆ†çš„å‡†å¤‡å·¥ä½œå§ï¼Œä¸ç„¶ä¸€è„¸èŒ«ç„¶çš„çœ‹æºç ï¼ŒåŸºæœ¬ä¸ä¼šæœ‰å¤ªå¤šçš„æ”¶è·.</p>
<h3 id="å‡½æ•°-amp-å˜é‡åˆè¯†"><a href="#å‡½æ•°-amp-å˜é‡åˆè¯†" class="headerlink" title="å‡½æ•°&amp; å˜é‡åˆè¯†"></a>å‡½æ•°&amp; å˜é‡åˆè¯†</h3><blockquote>
</blockquote>
<a id="more"></a>

<h4 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h4><blockquote>
<p>/proc.go</p>
</blockquote>
<ul>
<li>main</li>
<li>sysmon</li>
<li>findrunnable</li>
<li>goparkã€Œ1.1ã€</li>
<li>gosched ã€Œ1.2ã€</li>
<li>mstart</li>
<li>wakep</li>
<li>schedule</li>
<li>cpuinit</li>
<li>schedinit</li>
<li>ready</li>
<li>readgstatus</li>
<li>startm</li>
<li>pollWork</li>
<li>injectglist</li>
<li>park_m</li>
<li>goyield</li>
<li>retake</li>
<li>globrunqput</li>
<li>globrunqputbatch</li>
<li>globrunqputhead</li>
</ul>
<h4 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h4><blockquote>
<p>/proc.go</p>
</blockquote>
<ul>
<li>m0</li>
<li>g0</li>
<li>allgs</li>
<li>allglock</li>
</ul>
<blockquote>
<p>/runtime2.go</p>
</blockquote>
<ul>
<li>g</li>
<li>p</li>
<li>m</li>
<li>allglen</li>
<li>allm</li>
<li>allp</li>
<li>allpLock</li>
<li>gomaxprocs</li>
<li>sched</li>
</ul>
<blockquote>
<p>/runtime2.go å¸¸é‡</p>
</blockquote>
<ul>
<li>_Grunnable/_Grunning/_Gwaitingâ€¦..</li>
</ul>
<h3 id="ä¸Šè¿°è¿™äº›å‡½æ•°-å˜é‡-å¸¸é‡-whatï¼Ÿ"><a href="#ä¸Šè¿°è¿™äº›å‡½æ•°-å˜é‡-å¸¸é‡-whatï¼Ÿ" class="headerlink" title="ä¸Šè¿°è¿™äº›å‡½æ•°/å˜é‡/å¸¸é‡ whatï¼Ÿ"></a>ä¸Šè¿°è¿™äº›å‡½æ•°/å˜é‡/å¸¸é‡ whatï¼Ÿ</h3><p>å†™è¿™ä¹ˆå¤šï¼Œè‚¯å®šä¸æ˜¯ç®€å•çš„ä»æºç ä»“åº“é‡Œé¢è¶…å‡ºæ¥ï¼Œè¿™äº›æ˜¯ä¸€äº›æ¯”è¾ƒé‡è¦çš„å‡½æ•°ï¼Œå½“ç„¶è¿˜æœ‰å¾ˆå¤šæ²¡æœ‰ç½—åˆ—ï¼Œè¿™é‡Œä¸»è¦æƒ³è®°å½•ï¼Œä¹Ÿæ˜¯æ€è€ƒçš„ç‚¹ï¼š</p>
<ul>
<li>GPMä¸ºä½•ä¼šæœ‰è¿™ä¹ˆå¤šçš„çŠ¶æ€</li>
<li>è¿™äº›çŠ¶æ€ä¹‹é—´æ˜¯å¦‚ä½•é…åˆå’Œåè°ƒçš„</li>
<li>è‘—åçš„å·¥ä½œå·å–ã€ŒPã€æ˜¯æ€ä¹ˆæ“ä½œçš„</li>
<li>å¦‚æœè®©ä½ è®¾è®¡ï¼Œä½ åº”è¯¥ä¼šæ€ä¹ˆè®¾è®¡GPMè¿™ä¸ªè°ƒåº¦çš„è¿‡ç¨‹ã€ŒğŸé‡ç‚¹ã€</li>
</ul>
<h3 id="åˆ‡å…¥ç‚¹"><a href="#åˆ‡å…¥ç‚¹" class="headerlink" title="åˆ‡å…¥ç‚¹"></a>åˆ‡å…¥ç‚¹</h3><ul>
<li>main:å…¥å£å‡½æ•°</li>
<li>sysmonï¼šç›‘æ§è°ƒåº¦çº¿ç¨‹</li>
<li>scheduleï¼šçœŸå®çš„è°ƒåº¦å™¨é€»è¾‘</li>
<li>m0/g0ï¼šç‰¹æ®Šçš„å­˜åœ¨ä½“</li>
</ul>
<h3 id="å¦‚ä½•å¼€å§‹ï¼Ÿ"><a href="#å¦‚ä½•å¼€å§‹ï¼Ÿ" class="headerlink" title="å¦‚ä½•å¼€å§‹ï¼Ÿ"></a>å¦‚ä½•å¼€å§‹ï¼Ÿ</h3><blockquote>
<p>ç®€å•ç‚¹ï¼Œä»mainå¼€å§‹.</p>
</blockquote>
<h3 id="çæ‰¯"><a href="#çæ‰¯" class="headerlink" title="çæ‰¯"></a>çæ‰¯</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">çœ‹äº†å¾ˆé•¿æ—¶é—´çš„goæºç äº†ï¼Œè§‰å¾—ä¸€ä¸ªå¥½çš„è®¾è®¡ï¼Œä»æ¥ä¸æ˜¯ç®€å•çš„å­¦ä¹ åˆ«äººçš„æºç ï¼Œ</span><br><span class="line">æ›´å¤šçš„æ˜¯å­¦ä¹ æºç çš„è®¾è®¡æ€è·¯å’Œå½“æ—¶è®¾è®¡æ—¶æ˜¯åŸºäºå“ªç§åœºæ™¯ä¸‹çš„ã€‚</span><br><span class="line"></span><br><span class="line">è€ƒè™‘æ›´å¤šçš„åœºæ™¯ï¼Œæœ‰æ²¡æœ‰å…¶å®ƒçš„è®¾è®¡æ€è·¯ï¼Œå¯èƒ½æ²¡æœ‰ç°æœ‰çš„è®¾è®¡æ›´å‡ºè‰²ï¼Œä½†æ›´åŠ é€‚åˆåˆ«çš„åœºæ™¯ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="æœªå®Œå¾…ç»­"><a href="#æœªå®Œå¾…ç»­" class="headerlink" title="æœªå®Œå¾…ç»­."></a>æœªå®Œå¾…ç»­.</h3>]]></content>
      <tags>
        <tag>Go</tag>
        <tag>Goæºç </tag>
        <tag>GPM</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ18ã€GPM-1-[åˆè¯†/è®¾è®¡]</title>
    <url>/archives/b885f9f7.html</url>
    <content><![CDATA[<h3 id="å‰åº"><a href="#å‰åº" class="headerlink" title="å‰åº"></a>å‰åº</h3><p>å­¦goæœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œæœ€è¿‘æ€»æ„Ÿè§‰å¿™ç¢Œæ— ä¸ºï¼Œä¹Ÿè¯¥æ€»ç»“ä¸‹å‰æ®µæ—¶é—´è¯»æºç çš„ä¸€äº›å¿ƒå¾—å’Œä½“ä¼šäº†ã€‚</p>
<p>GPMè°ƒåº¦ç®—æ˜¯åœ¨Goä¸­æ¯”è¾ƒç»å…¸çš„äº†ï¼Œæœ‰å¿…è¦æ·±å…¥å­¦ä¹ ä¸‹ã€‚</p>
<blockquote>
<p><a href="https://golang.org/s/go11sched">Go GPMè®¾è®¡æ–‡æ¡£</a></p>
</blockquote>
<h3 id="GPMè®¾è®¡çš„ç”±æ¥"><a href="#GPMè®¾è®¡çš„ç”±æ¥" class="headerlink" title="GPMè®¾è®¡çš„ç”±æ¥"></a>GPMè®¾è®¡çš„ç”±æ¥</h3><p>ä¸€ä¸ªå¥½çš„è®¾è®¡ï¼Œæ€»ä¼šä¼´éšå‘ç°ç°æœ‰çš„é—®é¢˜ï¼Œåœ¨è§£å†³çš„åŸºç¡€ä¸Šè€ƒè™‘åœºæ™¯å¹¶æé«˜æ‰©å±•æ€§ï¼Œå…ˆæ¥äº†è§£ä¸‹Goä¸ºä½•è¦é‡æ–°è®¾è®¡GPMè¿™ä¸ªæ¨¡å‹ï¼š</p>
<a id="more"></a>

<h4 id="ç°æœ‰çš„é—®é¢˜ï¼š"><a href="#ç°æœ‰çš„é—®é¢˜ï¼š" class="headerlink" title="ç°æœ‰çš„é—®é¢˜ï¼š"></a>ç°æœ‰çš„é—®é¢˜ï¼š</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1. Single global mutex (Sched.Lock) and centralized state. The mutex protects all goroutine-related operations (creation, completion, rescheduling, etc).</span><br><span class="line">2. Goroutine (G) hand-off (G.nextg). Worker threads (M&#39;s) frequently hand-off runnable goroutines between each other, this may lead to increased latencies and additional overheads. Every M must be able to execute any runnable G, in particular the M that just created the G.</span><br><span class="line">3. Per-M memory cache (M.mcache). Memory cache and other caches (stack alloc) are associated with all M&#39;s, while they need to be associated only with M&#39;s running Go code (an M blocked inside of syscall does not need mcache). A ratio between M&#39;s running Go code and all M&#39;s can be as high as 1:100. This leads to excessive resource consumption (each MCache can suck up up to 2M) and poor data locality.</span><br><span class="line">4. Aggressive thread blocking&#x2F;unblocking. In presence of syscalls worker threads are frequently blocked and unblocked. This adds a lot of overhead.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1ã€å•ä¸€çš„å…¨å±€é”å’Œé›†ä¸­çš„çŠ¶æ€.æ­¤é”æ‰€æœ‰gçš„æ“ä½œã€‚</span><br><span class="line">2ã€gé€€å‡ºã€‚å·¥ä½œä¸­çš„Mé¢‘ç¹çš„äº¤å‡ºæ­£åœ¨runningçš„gï¼Œå¯¼è‡´å»¶è¿Ÿå¢åŠ å’Œé¢å¤–çš„è´Ÿè½½ã€‚æ¯ä¸ªMæ‰§è¡Œä»»ä½•gï¼Œå°¤å…¶æ˜¯Mè‡ªèº«åˆ›å»ºçš„gã€‚</span><br><span class="line">3ã€Mçš„å†…å­˜ç¼“å­˜é—®é¢˜ã€‚   å†…å­˜ç¼“å­˜å’Œå…¶å®ƒçš„ç¼“å­˜å…³è”è¿™æ‰€æœ‰çš„Mï¼Œå½“ä»–ä»¬éœ€è¦å…³è”Mæ¥running codeæ—¶ã€‚æ¯”ç‡æ˜¾ç¤ºMè¿è¡Œçš„codeå’Œæ‰€æœ‰Mçš„å‘ˆ1:100ã€‚å¯¼è‡´å¾ˆå¤šèµ„æºçš„æµªè´¹å’Œå†…å­˜çš„è´«ç˜ ã€‚</span><br><span class="line">4ã€ä¾µç•¥æ€§çš„åŠ é”ï¼Œåœ¨ç³»ç»Ÿçº¿ç¨‹é¢‘ç¹çš„åŠ é”å’Œè§£é”ã€‚è¿™æ ·ä¼šé€ æˆå¾ˆå¤§çš„è´Ÿè½½ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="è®¾è®¡æ”¹å˜"><a href="#è®¾è®¡æ”¹å˜" class="headerlink" title="è®¾è®¡æ”¹å˜"></a>è®¾è®¡æ”¹å˜</h3><blockquote>
<p>ä»¥å‰çš„è®¾è®¡ï¼š<br><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/GPM-1.png"></p>
</blockquote>
<blockquote>
<p>æ–°å¢Processor</p>
</blockquote>
<p> <img src="https://raw.githubusercontent.com/crab21/Images/master/blog/GPM-2.png"></p>
<h3 id="å®ç°è®¡åˆ’"><a href="#å®ç°è®¡åˆ’" class="headerlink" title="å®ç°è®¡åˆ’"></a>å®ç°è®¡åˆ’</h3> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1. Introduce the P struct (empty for now); implement allp&#x2F;idlep containers (idlep is mutex-protected for starters); associate a P with M running Go code. Global mutex and atomic state is still preserved.</span><br><span class="line">2. Move G freelist to P.</span><br><span class="line">3. Move mcache to P.</span><br><span class="line">4. Move stackalloc to P.</span><br><span class="line">5. Move ncgocall&#x2F;gcstats to P.</span><br><span class="line">&#x2F;&#x2F; work-stealå·¥ä½œçªƒå–æ¨¡å¼,ä»ç„¶åœ¨å…¨å±€é”ä¸‹ã€‚</span><br><span class="line">6. Decentralize run queue, implement work-stealing. Eliminate G hand off. Still under global mutex.</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ç§»é™¤å…¨å±€é”ï¼Œå®ç°åˆ†æ•£çš„æ£€æµ‹ã€‚</span><br><span class="line">7. Remove global mutex, implement distributed termination detection, LockOSThread.</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; å®ç°è‡ªæ—‹æ›¿ä»£æç¤ºé”ã€Œæ™®é€šé”ã€ã€‚</span><br><span class="line">8. Implement spinning instead of prompt blocking&#x2F;unblocking.</span><br><span class="line">The plan may turn out to not work, there are a lot of unexplored details.</span><br></pre></td></tr></table></figure>

<h3 id="Potential-Improvement"><a href="#Potential-Improvement" class="headerlink" title="Potential Improvement"></a>Potential Improvement</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># åè¿›å…ˆå‡ºè®¡åˆ’ã€‚æä¾›å…¬å¹³å’Œä¼˜é›…çš„å¤„ç†gã€‚</span><br><span class="line">1. Try out LIFO scheduling, this will improve locality. However, it still must provide some degree of fairness and gracefully handle yielding goroutines.</span><br><span class="line"></span><br><span class="line"># ä¸åˆ†é…å†…å­˜å’Œæ ˆç©ºé—´ï¼Œç›´åˆ°gè·‘èµ·æ¥ã€‚å¯¹äºä¸€ä¸ªæ–°åˆ›å»ºçš„gï¼Œéœ€è¦ä¸‹é¢å‡ ä¸ªå‡½æ•°ã€‚ è¿™å°†åˆ›å»ºtoå®Œæˆä¼´éšç€è¾ƒä½å†…å­˜çš„è´Ÿè½½ã€‚</span><br><span class="line">2. Do not allocate G and stack until the goroutine first runs. For a newly created goroutine we need just callerpc, fn, narg, nret and args, that is, about 6 words. This will allow to create a lot of running-to-completion goroutines with significantly lower memory overhead.</span><br><span class="line"></span><br><span class="line"># æ›´å¥½çš„G-Pã€‚å°è¯•å…¥é˜Ÿæœªé”å®šçš„Gåˆ°Pï¼Œä»ä¸Šä¸€æ¬¡è¿è¡Œã€‚</span><br><span class="line">4. Better locality of G-to-P. Try to enqueue an unblocked G to a P on which it was last running.</span><br><span class="line"></span><br><span class="line"># æ›´å¥½çš„P-Mã€‚å°è¯•æ‰§è¡Œpï¼Œåœ¨åŒæ ·çš„Mæœ€åä¸€æ¬¡è¿è¡Œã€‚</span><br><span class="line">5. Better locality of P-to-M. Try to execute P on the same M it was last running.</span><br><span class="line"></span><br><span class="line"># Mé™æµåˆ›å»ºã€‚è°ƒåº¦å™¨åˆ›å»ºä¸Šåƒå“¥Måœ¨æ¯«ç§’ä¹‹é—´ï¼Œç›´åˆ°OSæ‹’ç»åˆ›å»ºæ›´å¤šçš„threadã€‚Må¿…é¡»ç«‹åˆ»åˆ›å»ºï¼Œæœ€å¤šåˆ›å»ºk*GOMAXPROCS,åç»­æ–°çš„Mä¼šé€šè¿‡å®šæ—¶å™¨åˆ›å»ºã€‚</span><br><span class="line">6. Throttling of M creation. The scheduler can be easily forced to create thousands of M&#39;s per second until OS refuses to create more threads. Mâ€™s must be created promptly up to k*GOMAXPROCS, after that new Mâ€™s may added by a timer.</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h3><ul>
<li><p><a href="https://golang.org/s/go11scheds">GPM g11è®¾è®¡æ–‡æ¡£</a></p>
</li>
<li><p><a href="http://supertech.csail.mit.edu/papers/steal.pdf">work stealæ¨¡å¼</a></p>
</li>
</ul>
]]></content>
      <tags>
        <tag>Go</tag>
        <tag>Goæºç </tag>
        <tag>GPM</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ17ã€chrome headlessã€Œæˆªå›¾/PDF/DOM...ã€</title>
    <url>/archives/5544baea.html</url>
    <content><![CDATA[<blockquote>
<p>æœ€è¿‘åœ¨æä¸€ä¸ªéœ€æ±‚ï¼šhtmlã€Œæ–‡ä»¶ã€æ¸²æŸ“æˆpng/jpgï¼›chromeä¸èƒ½è£…åœ¨æœåŠ¡å™¨ä¸­ï¼Œå¯ä»¥æ‰“æˆdockeré•œåƒã€‚<br>è¯´åˆ°è¿™ä¸ªï¼Œå¾ˆå¤šäººè‚¯å®šè¯´å¾ˆå®¹æ˜“å•Šï¼Œchrome headlessæœ‰ç°æˆçš„ï¼Œç›´æ¥ç”¨ï¼Œå®ƒæ˜¯ä¸é¦™ä¹ˆã€‚<br>ç„¶è€Œäº‹æƒ…å¹¶æ²¡æœ‰è¿™ä¹ˆç®€å•ï¼›</p>
</blockquote>
<h3 id="éš¾ç‚¹ï¼š"><a href="#éš¾ç‚¹ï¼š" class="headerlink" title="éš¾ç‚¹ï¼š"></a>éš¾ç‚¹ï¼š</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>ã€æœåŠ¡å™¨ä¸­ä¸èƒ½è£…chrome</span><br><span class="line"><span class="number">2</span>ã€chromeå¿…é¡»æ‰“åœ¨dockeré‡Œé¢</span><br><span class="line"><span class="number">3</span>ã€æ¸²æŸ“æ•ˆæœè¦å’Œåœ¨æœ¬åœ°æ•ˆæœä¸€æ ·ï¼šå›¾ç‰‡ä¸èƒ½ä¸¢å¤±å­—ä½“ï¼Œä¸èƒ½å¤±çœŸã€‚</span><br><span class="line"><span class="number">4</span>ã€ä¸èƒ½å¯åŠ¨æ–°çš„æœåŠ¡</span><br></pre></td></tr></table></figure>

<a id="more"></a>
<h3 id="åˆ‡å…¥ç‚¹ï¼š"><a href="#åˆ‡å…¥ç‚¹ï¼š" class="headerlink" title="åˆ‡å…¥ç‚¹ï¼š"></a>åˆ‡å…¥ç‚¹ï¼š</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">docker &amp;&amp; chrome</span><br></pre></td></tr></table></figure>

<blockquote>
<p>soå…ˆå»æœä¸€æŠŠæœ‰æ²¡æœ‰ç°æˆçš„å¯ç”¨ï¼Ÿ</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/20201110-193745.png"></p>
<p>åˆ†æåˆ†æå§ï¼š</p>
<ul>
<li><a href="https://github.com/browserless/chrome">browserless</a></li>
<li><a href="https://github.com/puppeteer/puppeteer">puppeteer</a></li>
<li><a href="https://github.com/prisma-archive/chromeless">prisma-archive</a><br>â€¦â€¦â€¦.<ul>
<li>é€‚åˆå¯åŠ¨æœåŠ¡ï¼Œç„¶åè¿›è¡Œæµ‹è¯•æˆ–è€…è·‘æœåŠ¡</li>
<li>å…¥å‚æ•°ä¸ºurl</li>
</ul>
</li>
</ul>
<blockquote>
<p>æ‰€ä»¥ä¸Šè¿°çš„åŸºæœ¬ä¸ç¬¦åˆéœ€æ±‚ï¼Œå†å¯»æ‰¾â€¦..</p>
</blockquote>
<h3 id="Zenika-alpine-chrome"><a href="#Zenika-alpine-chrome" class="headerlink" title="Zenika/alpine-chrome"></a><a href="https://github.com/Zenika/alpine-chrome">Zenika/alpine-chrome</a></h3><blockquote>
<p>çœ‹èµ·æ¥å¯è¡Œï¼š</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/20201110-194452.png"></p>
<p>è¿™ä¸ªç»è¿‡éªŒè¯æ€»ä¼šæœ‰ä¸€ä¸ªé”™è¯¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[1110&#x2F;031547.366909:ERROR:bus.cc(393)] Failed to connect to the bus: Failed to connect to socket &#x2F;var&#x2F;run&#x2F;dbus&#x2F;system_bus_socket: No such file or directory</span><br><span class="line">[1110&#x2F;031547.367451:WARNING:dns_config_service_posix.cc(342)] Failed to read DnsConfig.</span><br><span class="line">[1110&#x2F;031547.437879:WARNING:dns_config_service_posix.cc(342)] Failed to read DnsConfig.</span><br><span class="line">[1110&#x2F;031549.073431:ERROR:headless_shell.cc(591)] Writing to file code&#x2F;ss.png was unsuccessful, could not open file: FILE_ERROR_ACCESS_DENIED</span><br></pre></td></tr></table></figure>

<p>æ–‡ä»¶æ²¡æƒé™å“¦ï¼Œå°´å°¬äº†,å†ä¿®æ­£ï¼š</p>
<blockquote>
<p>å‘ç°æºç æœ‰ä¸€æ®µæ·»åŠ äº†ç”¨æˆ·ï¼Œæ±—ï¼Œå¤ªæäº†.</p>
</blockquote>
<p><a href="https://github.com/Zenika/alpine-chrome/blob/master/Dockerfile#L38">ç‚¹å‡»æŸ¥çœ‹</a></p>
<p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/20201110-194711.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å¾ˆéƒé—·è¿™ä¸ªchromeç”¨æˆ·å¹²å˜›çš„ï¼Œå¦‚æœçœŸç”¨è¿™ä¸ªï¼Œé‚£å¾—ç¡®å®šä½ è·‘çš„ç¯å¢ƒè¦å…è®¸ä½ æ·»åŠ ä¸€ä¸ªuserå‡ºæ¥ï¼Œå¾ˆæ˜æ˜¾ä¸è¡Œ,</span><br><span class="line">è¿™æ ·å¯¼è‡´æ•´ä¸ªalpine-chromeæœåŠ¡æƒé™éƒ½æ˜¯ä¹±çš„ã€Œchromeç”¨æˆ·çš„ã€,æœ€æ˜æ˜¾çš„æ˜¯æ— æ³•è¯»å†™æ–‡ä»¶ï¼Œå› ä¸ºä½ è¿™ä¸ªadd chromeæ²¡æƒé™ã€‚</span><br><span class="line"></span><br><span class="line">æœ€ç›´æ¥çš„ï¼Œå»æ‰å°±å¥½äº†ã€‚</span><br><span class="line"></span><br><span class="line">æœç„¶å»æ‰åï¼Œè·‘dockerå°±å¯ä»¥äº†</span><br></pre></td></tr></table></figure>

<p><a href="https://hub.docker.com/r/zenika/alpine-chrome">dockeré•œåƒåœ°å€</a></p>
<p>è¿™ä¸ªæ˜¯å¯ä»¥äº†ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼Œå›¾åƒå¤±çœŸäº†ï¼Œå†å»æŸ¥githubæºç ï¼Œå‘é‚£ï¼Œå‹æ ¹æ²¡æœ‰è£…å…¨æ–‡å­—åº“ï¼Œåªç®€å•è£…äº†lib***çš„åº“ã€‚</p>
<h3 id="å†å°è¯•ã€Œè‡ªå·±æä¸ªdocker-imagesã€"><a href="#å†å°è¯•ã€Œè‡ªå·±æä¸ªdocker-imagesã€" class="headerlink" title="å†å°è¯•ã€Œè‡ªå·±æä¸ªdocker imagesã€"></a>å†å°è¯•ã€Œè‡ªå·±æä¸ªdocker imagesã€</h3><blockquote>
<p>åˆ«äººéƒ½èƒ½æï¼Œä¸ºä½•æˆ‘ä¸å¯ä»¥å‹’</p>
</blockquote>
<h3 id="åˆ†æï¼š"><a href="#åˆ†æï¼š" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h3><ul>
<li>æœ¬åœ°è·‘è¿™ä¸ªæœåŠ¡æ˜¯okçš„ï¼Œé‚£chromeå°±æ˜¯ä¾èµ–macos/linuxç³»ç»Ÿçš„</li>
<li>é‚£å¯ä»¥æä¸ªlinuxç³»ç»Ÿï¼Œå†è£…ä¸ªchrome</li>
<li>æœ€åæŠŠå­—ä½“è£…å®Œå°±okäº†</li>
<li>æœ€åçš„æœ€åï¼Œæƒ³åŠæ³•ç›´æ¥å¯ä»¥ç”¨è¿™ä¸ªdockerï¼Œä¸ç”¨å¯åŠ¨æœåŠ¡ï¼Œä¹Ÿå°±æ˜¯è¯´docker runä¹‹åæœ‰äº†ç»“æœï¼Œç›´æ¥rmæ‰ã€‚</li>
</ul>
<h3 id="æ€è·¯ï¼š"><a href="#æ€è·¯ï¼š" class="headerlink" title="æ€è·¯ï¼š"></a>æ€è·¯ï¼š</h3><ul>
<li>1ã€æä¸ªdocker debainç³»ç»Ÿ</li>
<li>2ã€æƒ³åŠæ³•æŠŠchromeè£…ä¸Š</li>
<li>3ã€åœ¨é‡Œé¢è·‘ä¸€ä¸ªæµ‹è¯•ï¼Œçœ‹èƒ½å¦ç”Ÿæˆå›¾ç‰‡</li>
<li>4ã€å®‰è£…ç¼ºå¤±çš„å­—ä½“</li>
<li>5ã€containerè·‘èµ·æ¥</li>
<li>6ã€å¯¼å‡ºcontainerï¼Œå†å¯¼å…¥åˆ°æœ¬åœ°çš„imagesï¼›è®©containerå˜æˆimages</li>
<li>7ã€è‡ªå·±æä¸ªDockerfileï¼ŒæŠŠã€ŒRUNã€æ¥å£ç•™å‡ºæ¥ï¼Œæ–¹ä¾¿å¯ä»¥ç›´æ¥è·‘èµ·æ¥</li>
<li>8ã€å†æŠŠæå¥½çš„imageså¯¼å‡ºæ¥ç”¨å°±å¯ä»¥äº†ã€‚</li>
</ul>
<h3 id="æ­¥éª¤ï¼š"><a href="#æ­¥éª¤ï¼š" class="headerlink" title="æ­¥éª¤ï¼š"></a>æ­¥éª¤ï¼š</h3><h4 id="1"><a href="#1" class="headerlink" title="1"></a>1</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker pull debian</span><br></pre></td></tr></table></figure>

<h4 id="2-3-4-5"><a href="#2-3-4-5" class="headerlink" title="2/3/4/5"></a>2/3/4/5</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1ã€è¿›å…¥ç³»ç»Ÿ</span><br><span class="line">docker exec -it XXXXX &#x2F;bin&#x2F;bash</span><br><span class="line">2ã€æ›´æ–°æº</span><br><span class="line">apt-get update</span><br><span class="line">3ã€ä¸‹è½½wget</span><br><span class="line">apt-get install wget</span><br><span class="line">4ã€ä¸‹è½½chrome linuxç‰ˆæœ¬çš„</span><br><span class="line">wget https:&#x2F;&#x2F;dl.google.com&#x2F;linux&#x2F;direct&#x2F;google-chrome-stable_current_amd64.deb</span><br><span class="line">5ã€å®‰è£…chrome</span><br><span class="line"> dpkg -i ******.deb</span><br><span class="line"> è§£å†³ä¾èµ–å…³ç³»ï¼š</span><br><span class="line">    apt-get -f install</span><br><span class="line">6ã€è·‘ä¸€æŠŠå‘ç°æ±‰å­—å˜é—®å¥½ã€Œï¼Ÿã€äº†</span><br><span class="line">7ã€å®‰è£…ç¼ºå¤±çš„å­—ä½“</span><br><span class="line">apt-get install ttf-wqy-microhei ttf-wqy-zenhei xfonts-wqy</span><br></pre></td></tr></table></figure>

<h4 id="6å¯¼å‡ºcontainer"><a href="#6å¯¼å‡ºcontainer" class="headerlink" title="6å¯¼å‡ºcontainer"></a>6å¯¼å‡ºcontainer</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1ã€å¯¼å‡ºcontainer</span><br><span class="line">docker export container_name &gt; chrome.tar</span><br><span class="line">2ã€å¯¼å…¥åˆ°imagesä¸­</span><br><span class="line">docker load &lt; chrome.tar</span><br></pre></td></tr></table></figure>

<h4 id="7è‡ªå·±æDockerfile-é¢„ç•™ã€ŒRUNã€æ¥å£"><a href="#7è‡ªå·±æDockerfile-é¢„ç•™ã€ŒRUNã€æ¥å£" class="headerlink" title="7è‡ªå·±æDockerfile,é¢„ç•™ã€ŒRUNã€æ¥å£"></a>7è‡ªå·±æDockerfile,é¢„ç•™ã€ŒRUNã€æ¥å£</h4><p>Dockerfileæ–‡ä»¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#è¿™ä¸ªæ˜¯ä¸Šä¸€æ­¥å¯¼å…¥çš„images</span><br><span class="line">FROM gogoowang&#x2F;chrome:v1</span><br><span class="line">RUN mkdir -p &#x2F;home</span><br><span class="line">WORKDIR &#x2F;home</span><br><span class="line">ENTRYPOINT [&quot;chrome&quot;,&quot;--headless&quot;,&quot;--disable-gpu&quot;]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ„å»ºæˆé•œåƒï¼šdocker build -t gogoo/chrome:v2 . </p>
</blockquote>
<p>PS:ã€Œ/homeã€çš„å«ä¹‰å°±æ˜¯è¿™ä¸ªimagesçš„å·¥ä½œç›®å½•æ˜¯/homeæ–‡ä»¶å¤¹ä¸‹é¢</p>
<h4 id="8è·‘ä¸€æŠŠï¼Œæ”¶å·¥"><a href="#8è·‘ä¸€æŠŠï¼Œæ”¶å·¥" class="headerlink" title="8è·‘ä¸€æŠŠï¼Œæ”¶å·¥"></a>8è·‘ä¸€æŠŠï¼Œæ”¶å·¥</h4><h3 id="æ³¨æ„ç‚¹ï¼š"><a href="#æ³¨æ„ç‚¹ï¼š" class="headerlink" title="æ³¨æ„ç‚¹ï¼š"></a>æ³¨æ„ç‚¹ï¼š</h3><h4 id="PS-1"><a href="#PS-1" class="headerlink" title="PS-1"></a>PS-1</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1ã€é”™è¯¯âŒ</span><br><span class="line">docker container run -it --rm -v &#x2F;tmp:&#x2F;home gogoowang&#x2F;chrome:v1 --no-sandbox --screenshot --hide-scrollbars &#x2F;XXXX&#x2F;XXXX.html</span><br><span class="line">2ã€æ­£ç¡®</span><br><span class="line">docker container run -i --rm -v &#x2F;tmp:&#x2F;home gogoowang&#x2F;chrome:v1 --no-sandbox --screenshot&#x3D;&#x2F;home&#x2F;xx.png --hide-scrollbars &#x2F;XXXX&#x2F;XXXX.html</span><br><span class="line"></span><br><span class="line">å°‘ä¸€ä¸ª -tï¼Œè¿™ä¸ª -tï¼šå†æä¸€ä¸ªä¸´æ—¶çš„TTyæ¥è·‘ç¨‹åºï¼Œæ—¢ç„¶æ˜¯åå°è·‘çš„ï¼Œé‚£å°±æ²¡å¿…è¦äº†</span><br></pre></td></tr></table></figure>

<h4 id="PS-2"><a href="#PS-2" class="headerlink" title="PS-2"></a>PS-2</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker container run -i --rm -v &#x2F;tmp:&#x2F;home gogoowang&#x2F;chrome:v1 --no-sandbox --screenshot&#x3D;&#x2F;home&#x2F;xx.png --hide-scrollbars &#x2F;XXXX&#x2F;XXXX.html</span><br><span class="line"></span><br><span class="line">1ã€å…³äºè¿™ä¸ª-vçš„é—®é¢˜,åé¢å°±å›ºå®šäº†ï¼Œå…·ä½“è§Dockerfileä¸­</span><br><span class="line">2ã€--screenshotè·¯å¾„é—®é¢˜ï¼Œæ—¢ç„¶æ˜¯dockeré•œåƒï¼Œé‚£å°±å¾—å¡«ä¸ªdockeré•œåƒä¸­çš„åœ°å€ï¼Œé‚£å°±æ˜¯&#x2F;homeä¸‹é¢äº†</span><br></pre></td></tr></table></figure>


<h3 id="ä¼˜åŒ–åä¸€é”®è„šæœ¬"><a href="#ä¼˜åŒ–åä¸€é”®è„šæœ¬" class="headerlink" title="ä¼˜åŒ–åä¸€é”®è„šæœ¬"></a>ä¼˜åŒ–åä¸€é”®è„šæœ¬</h3><p>Dockerfileæ–‡ä»¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">FROM debian</span><br><span class="line">RUN apt-get update </span><br><span class="line">RUN apt-get install -y wget </span><br><span class="line">RUN wget https:&#x2F;&#x2F;dl.google.com&#x2F;linux&#x2F;direct&#x2F;google-chrome-stable_current_amd64.deb </span><br><span class="line">RUN dpkg -i google-chrome-stable_current_amd64.deb || true</span><br><span class="line">RUN apt-get -f -y install</span><br><span class="line">RUN apt-get install -y ttf-wqy-microhei ttf-wqy-zenhei xfonts-wqy</span><br><span class="line">RUN mkdir -p &#x2F;home</span><br><span class="line">WORKDIR &#x2F;home</span><br><span class="line">ENTRYPOINT [&quot;&#x2F;opt&#x2F;google&#x2F;chrome&#x2F;chrome&quot;,&quot;--headless&quot;,&quot;--disable-gpu&quot;]</span><br></pre></td></tr></table></figure>
<p>æ„å»ºï¼š</p>
<blockquote>
<p>docker build -t google-chrome:latest .</p>
</blockquote>
]]></content>
      <tags>
        <tag>Day</tag>
        <tag>chrome</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ16ã€goæºç wordså½’çº³</title>
    <url>/archives/425d5e80.html</url>
    <content><![CDATA[<h3 id="å‰åº"><a href="#å‰åº" class="headerlink" title="å‰åº"></a>å‰åº</h3><p>å¥½ä¹…æ²¡æœ‰æ›´æ–°äº†ï¼Œä¸æ˜¯ä¸æ›´æ–°ï¼Œæœ€è¿‘æ„Ÿå†’ä¸¥é‡ï¼Œä¸€ç›´æ²¡å¥½ï¼Œå¤ªå½±å“èº«ä½“äº†â€¦..ã€Œèº«ä½“è¿˜æ˜¯å¾ˆé‡è¦çš„!ã€</p>
<p>å½“ç„¶äº†ï¼Œåœ¨ç”Ÿç—…æœŸé—´ä¹Ÿçœ‹äº†å¾ˆå¤šä¸œè¥¿ï¼Œæ›´å¤šçš„æ€è€ƒäº†è®¸å¤šï¼šäººç”Ÿè§„åˆ’çš„ã€å¦‚ä½•å­¦ä¹ æŠ€æœ¯ã€åç»­çš„ç”Ÿæ¶¯å‘å±•ä¹‹ç±»çš„ã€‚ã€Œæ€è€ƒçš„æ–¹å¼å¾ˆå¤šç§ï¼Œä¸å»ºè®®å»ç”Ÿç—…äº†æ‰å»æ€è€ƒ.ã€</p>
<blockquote>
<p>åç»­ä¼šæ›´æ–°ä¸€ç¯‡ï¼Œä¸»è¦æ˜¯ç»“åˆä¹‹å‰çš„æˆé•¿å’ŒæŠ€æœ¯çš„å£å’æ¥è¯´è¯´åç»­æƒ³æ€ä¹ˆå­¦ï¼Œæ€ä¹ˆå‘å±•ï¼Œç”Ÿæ¶¯è§„åˆ’å§ã€‚</p>
</blockquote>
<p>ä¸æ‰¯äº†ï¼Œè¿™ç¯‡ä¸»è¦æƒ³è®°å½•ä¸€äº›è¯æ±‡ï¼Œä¸»è¦è¿˜æ˜¯åœ¨é˜…è¯»Goæºç ä¸­çš„ä¸€äº›è¯æ±‡ï¼Œæ¯•ç«Ÿè‹±æ–‡æœ‰ç‚¹å·®ï¼Œå†ä¸ç§¯ç´¯å°±æ›´å·®äº†ã€‚</p>
<h3 id="Words"><a href="#Words" class="headerlink" title="Words"></a>Words</h3><h4 id="å…¨ç§°"><a href="#å…¨ç§°" class="headerlink" title="å…¨ç§°"></a>å…¨ç§°</h4><a id="more"></a>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">ã€Œ<span class="number">11</span>/<span class="number">3</span>ã€</span><br><span class="line">Preempt  v æŠ¢å ã€æ å¤º                                   --&gt; /proc.<span class="keyword">go</span></span><br><span class="line">retake   v é‡æ–°è·å–ã€Œé‡æ–°åˆ†é…ã€                           --&gt; /proc.<span class="keyword">go</span></span><br><span class="line">syscall  v ç³»ç»Ÿè°ƒç”¨                                     --&gt; /proc.<span class="keyword">go</span></span><br><span class="line">decrement v é€’å‡                                       --&gt; /proc.<span class="keyword">go</span></span><br><span class="line">pretending  v å‡è£…ã€ä¼ªè£…                                --&gt; /proc.<span class="keyword">go</span></span><br><span class="line">contended  v ç«äº‰                                      --&gt; /proc.<span class="keyword">go</span></span><br><span class="line">procresize  v æ‰©å¤§                                     --&gt; /proc.<span class="keyword">go</span> </span><br><span class="line">corruption  n è…è´¥ï¼Œè¯‘ï¼šæŸå</span><br><span class="line"></span><br><span class="line">ã€Œ<span class="number">11</span>/<span class="number">5</span>ã€</span><br><span class="line">assembly  n  è£…é…                                      --&gt; /proc.<span class="keyword">go</span></span><br><span class="line">amortizes  v  ç¼“å†²                                     --&gt; /proc.<span class="keyword">go</span></span><br></pre></td></tr></table></figure>


<h4 id="ç®€å†™"><a href="#ç®€å†™" class="headerlink" title="ç®€å†™"></a>ç®€å†™</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">ã€Œ<span class="number">11</span>/<span class="number">3</span>ã€</span><br><span class="line">sysmon -&gt; system monitor ç³»ç»Ÿç›‘æ§                                               /proc.<span class="keyword">go</span></span><br><span class="line">incidlelocked  --&gt; increment idle locked   å¢åŠ ç©ºé—²é”                           /proc.<span class="keyword">go</span></span><br><span class="line">sysmontick  --&gt; system monitor ticket   ç³»ç»Ÿç›‘æ§æ•°é‡                            /proc.<span class="keyword">go</span></span><br></pre></td></tr></table></figure>

<h3 id="æŒç»­æ›´æ–°â€¦"><a href="#æŒç»­æ›´æ–°â€¦" class="headerlink" title="æŒç»­æ›´æ–°â€¦."></a>æŒç»­æ›´æ–°â€¦.</h3>]]></content>
      <tags>
        <tag>Go</tag>
        <tag>Day</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ14ã€hexo-å®‰è£…&amp;æ’ä»¶</title>
    <url>/archives/ae4aba0d.html</url>
    <content><![CDATA[<p>hexoå®‰è£…åŠå…¶ç¬¬ä¸‰æ–¹æ’ä»¶åŒ…ä¸‹è½½æ€»ç»“ï¼Œä»¥ä¾¿åç»­CIä¸€æ¬¡åˆ°ä½ã€‚</p>
<a id="more"></a>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br><span class="line">npm install hexo-renderer-sass --save</span><br><span class="line">npm install hexo-generator-searchdb --save</span><br><span class="line">npm install hexo-generator-sitemap --save</span><br><span class="line">npm install hexo-generator-baidu-sitemap --save</span><br><span class="line">npm install request --save</span><br><span class="line">npm install xml-parser --save</span><br><span class="line">npm install yamljs --save</span><br><span class="line">npm install md5 --save</span><br><span class="line">npm install request --save</span><br><span class="line">npm install xml-parser --save</span><br><span class="line">npm install yamljs --save</span><br><span class="line">npm install cheerio --save</span><br><span class="line">npm install blueimp-md5 --save</span><br><span class="line">npm install hexo-abbrlink --save</span><br><span class="line">npm audit fix</span><br><span class="line"></span><br><span class="line">npm uninstall hexo-generator-index --save</span><br><span class="line">npm install hexo-generator-index-pin-top --save</span><br><span class="line">npm audit fix</span><br><span class="line"></span><br><span class="line">npm install hexo-neat --save</span><br><span class="line">npm audit fix</span><br><span class="line">npm install hexo-leancloud-counter-security --save</span><br><span class="line">npm audit fix</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æœªå®Œå¾…ç»­â€¦â€¦</p>
</blockquote>
]]></content>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ12ã€go æŒ‡é’ˆå’Œå¼•ç”¨</title>
    <url>/archives/1191d613.html</url>
    <content><![CDATA[<p>ä»Šå†™ä»£ç æ—¶ï¼Œä¼ å‡½æ•°æ— æ„é—´æƒ³åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œsliceé€šè¿‡å‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼Œä¸ºä½•å¯ä»¥æ”¹å˜å…·ä½“çš„å€¼å‘¢ï¼Ÿ</p>
<p>å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ</p>
<ul>
<li>å®˜æ–¹æŸ¥æ–‡æ¡£</li>
<li>çœ‹æºç </li>
<li>googleçœ‹çœ‹æœ‰æ²¡æœ‰å¥½çš„è§è§£</li>
<li>æ€è€ƒğŸ¤”+å†¥æƒ³ğŸ§˜â€â™‚ï¸</li>
</ul>
<p>ï¼ˆps:è§£å†³é—®é¢˜ï¼Œä¸»è¦ä¸æ˜¯çœ‹ç»“æœæ˜¯æ€ä¹ˆæ ·çš„ï¼Œä¸»è¦æ˜¯è€ƒè™‘é—®é¢˜çš„è§’åº¦ï¼‰</p>
<a id="more"></a>

<h3 id="æŸ¥èµ„æ–™"><a href="#æŸ¥èµ„æ–™" class="headerlink" title="æŸ¥èµ„æ–™"></a>æŸ¥èµ„æ–™</h3><p><a href="https://golang.google.cn/doc/effective_go.html#slices">å®˜ç½‘æŒ‡å—ä¹‹Slice</a><br>æœ‰ä¸€æ®µæ˜¯è¿™ä¹ˆæè¿°ï¼š<br><em>Slices hold references to an underlying array, and if you assign one slice to another, both refer to the same array.</em></p>
<h3 id="æŸ¥æºç "><a href="#æŸ¥æºç " class="headerlink" title="æŸ¥æºç "></a>æŸ¥æºç </h3><h4 id="src-runtime-slice-go"><a href="#src-runtime-slice-go" class="headerlink" title="/src/runtime/slice.go"></a>/src/runtime/slice.go</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> slice <span class="keyword">struct</span> &#123;</span><br><span class="line">	array unsafe.Pointer  <span class="comment">//æŒ‡é’ˆç±»å‹å“¦</span></span><br><span class="line">	<span class="built_in">len</span>   <span class="keyword">int</span></span><br><span class="line">	<span class="built_in">cap</span>   <span class="keyword">int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h3><blockquote>
<p>åŸæ¥ä¸‹å±‚æ˜¯ç”¨è¿‡arrayè¿™ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å…·ä½“çš„æ•°æ®çš„</p>
</blockquote>
<blockquote>
<p>é‚£ä¹ˆå…¶ä»–çš„å¼•ç”¨ç±»å‹å‘¢ï¼Ÿ</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Map?</span><br><span class="line">chan?</span><br><span class="line">interface?</span><br><span class="line">&#x2F;&#x2F;Slice?</span><br></pre></td></tr></table></figure>

<h3 id="å¼•ç”¨ç±»å‹ä¹‹Map"><a href="#å¼•ç”¨ç±»å‹ä¹‹Map" class="headerlink" title="å¼•ç”¨ç±»å‹ä¹‹Map"></a>å¼•ç”¨ç±»å‹ä¹‹Map</h3><h4 id="çœ‹æºç -src-runtime-map-goï¼š"><a href="#çœ‹æºç -src-runtime-map-goï¼š" class="headerlink" title="çœ‹æºç  /src/runtime/map.goï¼š"></a>çœ‹æºç  /src/runtime/map.goï¼š</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// A header for a Go map.</span></span><br><span class="line"><span class="keyword">type</span> hmap <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// Note: the format of the hmap is also encoded in cmd/compile/internal/gc/reflect.go.</span></span><br><span class="line">	<span class="comment">// Make sure this stays in sync with the compiler&#x27;s definition.</span></span><br><span class="line">	count     <span class="keyword">int</span> <span class="comment">// # live cells == size of map.  Must be first (used by len() builtin)</span></span><br><span class="line">	flags     <span class="keyword">uint8</span></span><br><span class="line">	B         <span class="keyword">uint8</span>  <span class="comment">// log_2 of # of buckets (can hold up to loadFactor * 2^B items)</span></span><br><span class="line">	noverflow <span class="keyword">uint16</span> <span class="comment">// approximate number of overflow buckets; see incrnoverflow for details</span></span><br><span class="line">	hash0     <span class="keyword">uint32</span> <span class="comment">// hash seed</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//é€šè¿‡æ­¤æŒ‡é’ˆç±»å‹</span></span><br><span class="line">	buckets    unsafe.Pointer <span class="comment">// array of 2^B Buckets. may be nil if count==0.</span></span><br><span class="line">	oldbuckets unsafe.Pointer <span class="comment">// previous bucket array of half the size, non-nil only when growing</span></span><br><span class="line">	nevacuate  <span class="keyword">uintptr</span>        <span class="comment">// progress counter for evacuation (buckets less than this have been evacuated)</span></span><br><span class="line"></span><br><span class="line">	extra *mapextra <span class="comment">// optional fields</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å¼•ç”¨ç±»å‹ä¹‹Chan"><a href="#å¼•ç”¨ç±»å‹ä¹‹Chan" class="headerlink" title="å¼•ç”¨ç±»å‹ä¹‹Chan"></a>å¼•ç”¨ç±»å‹ä¹‹Chan</h3><h4 id="æºç -src-runtime-chan-go"><a href="#æºç -src-runtime-chan-go" class="headerlink" title="æºç :/src/runtime/chan.go"></a>æºç :/src/runtime/chan.go</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> hchan <span class="keyword">struct</span> &#123;</span><br><span class="line">	qcount   <span class="keyword">uint</span>           <span class="comment">// total data in the queue</span></span><br><span class="line">    dataqsiz <span class="keyword">uint</span>           <span class="comment">// size of the circular queue</span></span><br><span class="line">    <span class="comment">//é€šè¿‡æ­¤æŒ‡é’ˆç±»å‹æ¥å¤„ç†</span></span><br><span class="line">	buf      unsafe.Pointer <span class="comment">// points to an array of dataqsiz elements</span></span><br><span class="line">	elemsize <span class="keyword">uint16</span></span><br><span class="line">	closed   <span class="keyword">uint32</span></span><br><span class="line">	elemtype *_type <span class="comment">// element type</span></span><br><span class="line">	sendx    <span class="keyword">uint</span>   <span class="comment">// send index</span></span><br><span class="line">	recvx    <span class="keyword">uint</span>   <span class="comment">// receive index</span></span><br><span class="line">	recvq    waitq  <span class="comment">// list of recv waiters</span></span><br><span class="line">	sendq    waitq  <span class="comment">// list of send waiters</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// lock protects all fields in hchan, as well as several</span></span><br><span class="line">	<span class="comment">// fields in sudogs blocked on this channel.</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="comment">// Do not change another G&#x27;s status while holding this lock</span></span><br><span class="line">	<span class="comment">// (in particular, do not ready a G), as this can deadlock</span></span><br><span class="line">	<span class="comment">// with stack shrinking.</span></span><br><span class="line">	lock mutex</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å¼•ç”¨ç±»å‹ä¹‹Interface"><a href="#å¼•ç”¨ç±»å‹ä¹‹Interface" class="headerlink" title="å¼•ç”¨ç±»å‹ä¹‹Interface"></a>å¼•ç”¨ç±»å‹ä¹‹Interface</h3><h4 id="æºç -src-runtime-runtime2-go"><a href="#æºç -src-runtime-runtime2-go" class="headerlink" title="æºç /src/runtime/runtime2.go"></a>æºç /src/runtime/runtime2.go</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> iface <span class="keyword">struct</span> &#123;</span><br><span class="line">    tab  *itab</span><br><span class="line">    <span class="comment">//æŒ‡é’ˆç±»å‹</span></span><br><span class="line">	data unsafe.Pointer</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> eface <span class="keyword">struct</span> &#123;</span><br><span class="line">    _type *_type</span><br><span class="line">    <span class="comment">//æŒ‡é’ˆç±»å‹</span></span><br><span class="line">	data  unsafe.Pointer</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç»“è®ºï¼Ÿé€šè¿‡æŒ‡é’ˆï¼Ÿ"><a href="#ç»“è®ºï¼Ÿé€šè¿‡æŒ‡é’ˆï¼Ÿ" class="headerlink" title="ç»“è®ºï¼Ÿé€šè¿‡æŒ‡é’ˆï¼Ÿ"></a>ç»“è®ºï¼Ÿé€šè¿‡æŒ‡é’ˆï¼Ÿ</h3><p>ä»ä¸Šè¿°æºç çœ‹æ¥ï¼Œå†…éƒ¨ç»“æ„ä¸­éƒ½æ˜¯ç”¨æŒ‡é’ˆç±»å‹æ¥æŒ‡å‘å…·ä½“çš„å€¼ï¼Œ</p>
<blockquote>
<p>Soï¼šå½¢åŒè¿™ç±»çš„ç»“æ„ï¼Œè‚¯å®šæ˜¯å¼•ç”¨ç±»å‹çš„ï¼Œå…·ä½“æ˜¯æŒ‡é’ˆæŒ‡å‘åˆ«çš„åœ°å€ï¼Œä»è€Œæ¥å¼•ç”¨å€¼ã€‚</p>
</blockquote>
<p>å…¶å®è¿™ä¸ªç‰¹æ€§å¾ˆæ—©å°±æ™“å¾—äº†ï¼Œåªæ˜¯ä»Šå¤©åˆçœ‹åˆ°äº†ï¼Œè§‰å¾—è¿˜æ˜¯è®°å½•ç€å§ï¼Œä¹Ÿè®¸åç»­å“ªä¸€å¤©å°±æœ‰äº†åˆ›æ–°çš„çµæ„Ÿæ¥ç€~~.</p>
<p>[ç¡è§‰äº†ï½æœ€è¿‘æœ‰ç‚¹ä¹ï½ZZzzzâ€¦]</p>
<h3 id="END"><a href="#END" class="headerlink" title="END"></a>END</h3>]]></content>
      <tags>
        <tag>Go</tag>
        <tag>Go Package</tag>
        <tag>Day</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ11ã€hexo ä¸»é¢˜&amp;è¯„è®º&amp;è¿›åº¦æ¡&amp;èƒŒæ™¯æ•ˆæœ</title>
    <url>/archives/e18c94ab.html</url>
    <content><![CDATA[<p>æ™šä¸ŠæŠ˜è…¾äº†ä¸‹åšå®¢ï¼Œç¨å¾®è£…é¥°äº†ä¸‹ï¼Œä¸»è¦è¿˜æ˜¯åŠ äº†ä¸ªè¯„è®ºå§ï¼Œå…¶å®ƒéå¸¸ç§€çš„æ’ä»¶å°±æ²¡æœ‰æ¥å…¥äº†ï¼Œæ‡’å¾—æŠ˜è…¾ï¼Œå¥½å¥½å†™åšå®¢ï¼Œå†…å®¹æ‰æ˜¯ç²¾åã€‚<br>è®°å½•ä¸‹æŠ˜è…¾å²ï¼š</p>
<h3 id="gitalkè¯„è®ºæ’ä»¶"><a href="#gitalkè¯„è®ºæ’ä»¶" class="headerlink" title="gitalkè¯„è®ºæ’ä»¶"></a>gitalkè¯„è®ºæ’ä»¶</h3><h4 id="æ­¥éª¤ï¼š"><a href="#æ­¥éª¤ï¼š" class="headerlink" title="æ­¥éª¤ï¼š"></a>æ­¥éª¤ï¼š</h4><h5 id="ç”³è¯·idå’Œsecret"><a href="#ç”³è¯·idå’Œsecret" class="headerlink" title="ç”³è¯·idå’Œsecret"></a>ç”³è¯·idå’Œsecret</h5><p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/36f31671-8ada-4cbe-b60b-d1595dd701ee.png"></p>
<a id="more"></a>

<h4 id="é…ç½®æ–‡ä»¶ï¼š"><a href="#é…ç½®æ–‡ä»¶ï¼š" class="headerlink" title="é…ç½®æ–‡ä»¶ï¼š"></a>é…ç½®æ–‡ä»¶ï¼š</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gitalk:</span><br><span class="line">  enable: true</span><br><span class="line">  github_id: crab21 # GitHub repo owner</span><br><span class="line">  repo: blog # Repository name to store issues</span><br><span class="line">  client_id: XXX # GitHub Application Client ID</span><br><span class="line">  client_secret: XXX # GitHub Application Client Secret</span><br><span class="line">  admin_user: crab21 # GitHub repo owner and collaborators, only these guys can initialize gitHub issues</span><br><span class="line">  distraction_free_mode: true # Facebook-like distraction free mode</span><br><span class="line">  perPage: 15 #æ¯é¡µå¤šå°‘ä¸ªè¯„è®º</span><br><span class="line">  pagerDirection: last  #æ’åºæ–¹å¼æ˜¯ä»æ—§åˆ°æ–°ï¼ˆfirstï¼‰è¿˜æ˜¯ä»æ–°åˆ°æ—§ï¼ˆlastï¼‰</span><br><span class="line">  createIssueManually: true #å¦‚æœå½“å‰é¡µé¢æ²¡æœ‰ç›¸åº”çš„ isssue ï¼Œä¸”ç™»å½•çš„ç”¨æˆ·å±äº adminï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ›å»º issueã€‚å¦‚æœè®¾ç½®ä¸º trueï¼Œåˆ™æ˜¾ç¤ºä¸€ä¸ªåˆå§‹åŒ–é¡µé¢ï¼Œåˆ›å»º issue éœ€è¦ç‚¹å‡» init æŒ‰é’®ã€‚</span><br><span class="line">  distractionFreeMode: true #æ˜¯å¦å¯ç”¨å¿«æ·é”®(cmd|ctrl + enter) æäº¤è¯„è®º.</span><br><span class="line"></span><br><span class="line">  # Gitalk&#39;s display language depends on user&#39;s browser or system environment</span><br><span class="line">  # If you want everyone visiting your site to see a uniform language, you can set a force language value</span><br><span class="line">  # Available values: en | es-ES | fr | ru | zh-CN | zh-TW</span><br><span class="line">  language:</span><br></pre></td></tr></table></figure>

<h3 id="pacé˜…è¯»è¿›åº¦ç™¾åˆ†æ¯”"><a href="#pacé˜…è¯»è¿›åº¦ç™¾åˆ†æ¯”" class="headerlink" title="pacé˜…è¯»è¿›åº¦ç™¾åˆ†æ¯”"></a>pacé˜…è¯»è¿›åº¦ç™¾åˆ†æ¯”</h3><p>1ã€githubåœ°å€ï¼š <a href="https://github.com/HubSpot/pace%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%9C%8B%E4%B8%8B%E4%BB%8B%E7%BB%8D">https://github.com/HubSpot/paceï¼Œå¯ä»¥çœ‹ä¸‹ä»‹ç»</a><br>2ã€ä¿®æ”¹å€¼ï¼š<br>    ä¿®æ”¹ä¸»é¢˜ä¸‹é¢çš„_config.ymlï¼š<br>    <figure class="highlight go"><table><tr><td class="code"><pre><span class="line">pace:</span><br><span class="line">    enable: <span class="literal">true</span></span><br><span class="line">    # Themes list:</span><br><span class="line">    # big-counter | bounce | barber-shop | center-atom | center-circle | center-radar | center-simple</span><br><span class="line">    # corner-indicator | fill-left | flat-top | flash | loading-bar | mac-osx | material | minimal</span><br><span class="line">    theme: minimal</span><br></pre></td></tr></table></figure></p>
<h3 id="reading-progress"><a href="#reading-progress" class="headerlink" title="reading_progress"></a>reading_progress</h3><p>githubåœ°å€ï¼š<a href="https://github.com/theme-next/theme-next-reading-progress">https://github.com/theme-next/theme-next-reading-progress</a></p>
<p>åŒ…å«ä½¿ç”¨è¯´æ˜å’Œå…·ä½“çš„æ­¥éª¤ï¼Œå°±ä¸æ¬è¿äº†ï¼ŒåŠæ—¶è°ƒæ•´ã€‚</p>
<h3 id="æ–‡ç« å­—æ•°å’Œé˜…è¯»æ—¶é—´ç»Ÿè®¡ï¼š"><a href="#æ–‡ç« å­—æ•°å’Œé˜…è¯»æ—¶é—´ç»Ÿè®¡ï¼š" class="headerlink" title="æ–‡ç« å­—æ•°å’Œé˜…è¯»æ—¶é—´ç»Ÿè®¡ï¼š"></a>æ–‡ç« å­—æ•°å’Œé˜…è¯»æ—¶é—´ç»Ÿè®¡ï¼š</h3><p>hexoé…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ï¼š<br>    <code>symbols_count_time</code> ä¸ºtrue.</p>
<h3 id="back2top"><a href="#back2top" class="headerlink" title="back2top"></a>back2top</h3><p>å¼€å¯æ¨¡å¼</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">back2top:</span><br><span class="line">  enable: true</span><br><span class="line">  # Back to top in sidebar.</span><br><span class="line">  sidebar: true</span><br><span class="line">  # Scroll percent label in b2t button.</span><br><span class="line">  scrollpercent: true</span><br></pre></td></tr></table></figure>
<h3 id="æŒç»­æ›´æ–°â€¦"><a href="#æŒç»­æ›´æ–°â€¦" class="headerlink" title="æŒç»­æ›´æ–°â€¦"></a>æŒç»­æ›´æ–°â€¦</h3><h3 id="END"><a href="#END" class="headerlink" title="END"></a>END</h3>]]></content>
      <tags>
        <tag>hexo</tag>
        <tag>hexoæ’ä»¶</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ10ã€go mutexè§£è¯»</title>
    <url>/archives/ff0d6c2b.html</url>
    <content><![CDATA[<p>ä¸Šæ¬¡è¯´åˆ°rwmutexè¯»å†™é”ï¼Œå…¶å®å°±æ˜¯åŠ å¼ºäº†é”çš„ç²’åº¦ï¼ŒåŒºåˆ†è¯»å’Œå†™æ—¶ä¸åŒçš„æƒ…å†µï¼Œæ ¸å¿ƒæ€æƒ³ï¼šå†™ä¼˜å…ˆäºè¯»ã€‚<br>è¿™æ¬¡æ¥çœ‹çœ‹mutexï¼Œgoä¸­çš„é”æ˜¯å¦‚ä½•å®ç°çš„ï¼Œç”¨ä¸€å¼ å›¾æ¥æ¦‚æ‹¬æ•´ä¸ªæµç¨‹ï¼š</p>
<a id="more"></a>
<p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/mutex.png"></p>
<blockquote>
<p>æ ¸å¿ƒæ€æƒ³ï¼šé¥¥é¥¿å’Œé˜Ÿåˆ—ï¼Œæ­£å¸¸æµç¨‹éƒ½æ˜¯åŠ å…¥åˆ°é˜Ÿåˆ—å°¾éƒ¨ï¼Œå¦‚æœè¶…è¿‡ä¸€å®šçš„æ—¶é—´é™åˆ¶åˆ™åŠ å…¥åˆ°é˜Ÿåˆ—å¤´éƒ¨ã€‚</p>
</blockquote>
<h3 id="å‰åº"><a href="#å‰åº" class="headerlink" title="å‰åº"></a>å‰åº</h3><blockquote>
<p>å¼€å§‹çœ‹ä»£ç æˆ–è€…åˆ†æä¹‹å‰ï¼Œå…ˆçœ‹ä¸‹æ–‡æ¡£è¯´æ˜åŠå…¶ç›¸å…³çš„èµ„æ–™ã€‚</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â—¯  go version</span><br><span class="line">go version go1.14.9 darwin&#x2F;amd64</span><br></pre></td></tr></table></figure>

<h3 id="src-sync-mutex-go"><a href="#src-sync-mutex-go" class="headerlink" title="src/sync/mutex.go"></a>src/sync/mutex.go</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	mutexLocked = <span class="number">1</span> &lt;&lt; <span class="literal">iota</span> <span class="comment">// mutex is locked      state &amp; mutexLocked 1==åŠ é”  0==æœªåŠ é”</span></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	mutexWoken                                      <span class="comment">//state &amp; mutexWoken 1==å”¤é†’  0==æœªå”¤é†’</span></span><br><span class="line">	mutexStarving                                   <span class="comment">// state &amp; mutexStarving 1==é¥¥é¥¿çŠ¶æ€   0==æ­£å¸¸çŠ¶æ€</span></span><br><span class="line">	mutexWaiterShift = <span class="literal">iota</span>                         <span class="comment">// state &gt;&gt; mutexWaiterShiftå¾—åˆ°å½“å‰çš„goroutineæ•°é‡</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Mutex fairness.</span></span><br><span class="line">	<span class="comment">// ä¸¤ç§æ¨¡å¼ï¼šæ­£å¸¸æˆ–é¥¥é¥¿</span></span><br><span class="line">    <span class="comment">// Mutex can be in 2 modes of operations: normal and starvation.</span></span><br><span class="line">    <span class="comment">//  æ­£å¸¸æ¨¡å¼å°±æ˜¯FIFOé˜Ÿåˆ—ã€‚</span></span><br><span class="line">	<span class="comment">// In normal mode waiters are queued in FIFO order, but a woken up waiter</span></span><br><span class="line">	<span class="comment">// does not own the mutex and competes with new arriving goroutines over</span></span><br><span class="line">	<span class="comment">// the ownership. New arriving goroutines have an advantage -- they are</span></span><br><span class="line">	<span class="comment">// already running on CPU and there can be lots of them, so a woken up</span></span><br><span class="line">	<span class="comment">// waiter has good chances of losing. In such case it is queued at front</span></span><br><span class="line">	<span class="comment">// of the wait queue. If a waiter fails to acquire the mutex for more than 1ms,  //è·å–é”çš„æ—¶é—´è¶…è¿‡1msï¼Œåˆ‡æ¢åˆ°é¥¥é¥¿æ¨¡å¼</span></span><br><span class="line">	<span class="comment">// it switches mutex to the starvation mode.</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="comment">// In starvation mode ownership of the mutex is directly handed off from        //é¥¥é¥¿æ¨¡å¼ä¸‹é”çš„æ‰€æœ‰æƒç›´æ¥ä»è§£é”goroutineçš„waiteræ‰‹ä¸­ç§»äº¤åˆ°é˜Ÿåˆ—çš„å‰é¢ã€‚</span></span><br><span class="line">	<span class="comment">// the unlocking goroutine to the waiter at the front of the queue.</span></span><br><span class="line">	<span class="comment">// New arriving goroutines don&#x27;t try to acquire the mutex even if it appears</span></span><br><span class="line">	<span class="comment">// to be unlocked, and don&#x27;t try to spin. Instead they queue themselves at</span></span><br><span class="line">	<span class="comment">// the tail of the wait queue.</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="comment">// If a waiter receives ownership of the mutex and sees that either         //å¦‚æœä¸€ä¸ªé”çš„æ‰€æœ‰æƒçš„ç­‰å¾…è€…æ˜¯ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¹‹ä¸€çš„ï¼š1ã€å¤„äºé˜Ÿåˆ—çš„æœ€åä¸€ä¸ª2ã€ç­‰å¾…æ—¶é—´å°‘äº1msï¼Œåˆ™åˆ‡æ¢åˆ°æ­£å¸¸æ¨¡å¼</span></span><br><span class="line">	<span class="comment">// (1) it is the last waiter in the queue, or (2) it waited for less than 1 ms,</span></span><br><span class="line">	<span class="comment">// it switches mutex back to normal operation mode.</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="comment">// Normal mode has considerably better performance as a goroutine can acquire</span></span><br><span class="line">	<span class="comment">// a mutex several times in a row even if there are blocked waiters.</span></span><br><span class="line">	<span class="comment">// Starvation mode is important to prevent pathological cases of tail latency.</span></span><br><span class="line">	starvationThresholdNs = <span class="number">1e6</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="åŠ é”æµç¨‹"><a href="#åŠ é”æµç¨‹" class="headerlink" title="åŠ é”æµç¨‹"></a>åŠ é”æµç¨‹</h3><blockquote>
<p>åŠ é”è¿‡ç¨‹å›¾å¦‚ä¸Šå›¾æåˆ°çš„æµç¨‹ã€‚</p>
</blockquote>
<blockquote>
<p>åŠ é”ä»£ç å…·ä½“æµç¨‹ï¼š</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Mutex)</span> <span class="title">Lock</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// Fast path: grab unlocked mutex.</span></span><br><span class="line">	<span class="keyword">if</span> atomic.CompareAndSwapInt32(&amp;m.state, <span class="number">0</span>, mutexLocked) &#123;</span><br><span class="line">		<span class="keyword">if</span> race.Enabled &#123;</span><br><span class="line">			race.Acquire(unsafe.Pointer(m))</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// Slow path (outlined so that the fast path can be inlined)</span></span><br><span class="line">	m.lockSlow()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Mutex)</span> <span class="title">lockSlow</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> waitStartTime <span class="keyword">int64</span> <span class="comment">//ç­‰å¾…æ—¶é—´</span></span><br><span class="line">	starving := <span class="literal">false</span>       <span class="comment">//æ˜¯å¦å¤„äºé¥¥é¥¿çŠ¶æ€</span></span><br><span class="line">	awoke := <span class="literal">false</span>          <span class="comment">//å”¤é†’çŠ¶æ€</span></span><br><span class="line">	iter := <span class="number">0</span>               <span class="comment">//è‡ªæ—‹æ¬¡æ•°</span></span><br><span class="line">	old := m.state          <span class="comment">//å½“å‰çŠ¶æ€copy</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="comment">// Don&#x27;t spin in starvation mode, ownership is handed off to waiters</span></span><br><span class="line">        <span class="comment">// so we won&#x27;t be able to acquire the mutex anyway.</span></span><br><span class="line">        <span class="comment">//åŠ é”ä¸”èƒ½å¤Ÿè‡ªæ—‹</span></span><br><span class="line">		<span class="keyword">if</span> old&amp;(mutexLocked|mutexStarving) == mutexLocked &amp;&amp; runtime_canSpin(iter) &#123;</span><br><span class="line">			<span class="comment">// Active spinning makes sense.</span></span><br><span class="line">			<span class="comment">// Try to set mutexWoken flag to inform Unlock</span></span><br><span class="line">            <span class="comment">// to not wake other blocked goroutines.</span></span><br><span class="line">            <span class="comment">//è‡ªæ—‹è¿‡ç¨‹å‘ç°æ²¡æœ‰è¢«ç½®wokenæ ‡è¯†ï¼Œè®¾ç½®æ ‡è¯†ï¼Œå°†è‡ªå·±ç½®ä¸ºå”¤é†’</span></span><br><span class="line">			<span class="keyword">if</span> !awoke &amp;&amp; old&amp;mutexWoken == <span class="number">0</span> &amp;&amp; old&gt;&gt;mutexWaiterShift != <span class="number">0</span> &amp;&amp;</span><br><span class="line">				atomic.CompareAndSwapInt32(&amp;m.state, old, old|mutexWoken) &#123;</span><br><span class="line">				awoke = <span class="literal">true</span></span><br><span class="line">			&#125;</span><br><span class="line">			runtime_doSpin()    <span class="comment">//è‡ªæ—‹</span></span><br><span class="line">			iter++              </span><br><span class="line">			old = m.state       <span class="comment">//çŠ¶æ€é‡ç½®</span></span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æ›´æ–°çŠ¶æ€</span></span><br><span class="line">		<span class="built_in">new</span> := old</span><br><span class="line">        <span class="comment">// Don&#x27;t try to acquire starving mutex, new arriving goroutines must queue.</span></span><br><span class="line">        <span class="comment">//éé¥¥é¥¿æ¨¡å¼ï¼Œåˆ™ç½®é”</span></span><br><span class="line">		<span class="keyword">if</span> old&amp;mutexStarving == <span class="number">0</span> &#123;</span><br><span class="line">			<span class="built_in">new</span> |= mutexLocked</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¤„äºé¥¥é¥¿æ¨¡å¼ä¸‹ï¼Œæ–°æ¥çš„goroutineè¿›å…¥é˜Ÿåˆ—ä¸­</span></span><br><span class="line">		<span class="keyword">if</span> old&amp;(mutexLocked|mutexStarving) != <span class="number">0</span> &#123;</span><br><span class="line">			<span class="built_in">new</span> += <span class="number">1</span> &lt;&lt; mutexWaiterShift</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// The current goroutine switches mutex to starvation mode.</span></span><br><span class="line">		<span class="comment">// But if the mutex is currently unlocked, don&#x27;t do the switch.</span></span><br><span class="line">		<span class="comment">// Unlock expects that starving mutex has waiters, which will not</span></span><br><span class="line">        <span class="comment">// be true in this case.</span></span><br><span class="line">        <span class="comment">//åˆ‡æ¢åˆ°é¥¥é¥¿æ¨¡å¼ä¸‹</span></span><br><span class="line">		<span class="keyword">if</span> starving &amp;&amp; old&amp;mutexLocked != <span class="number">0</span> &#123;</span><br><span class="line">			<span class="built_in">new</span> |= mutexStarving</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å½“å‰å¤„äºå”¤é†’çŠ¶æ€ï¼Œåˆ™é‡ç½®æ¸…é™¤å”¤é†’çŠ¶æ€ã€‚</span></span><br><span class="line">		<span class="keyword">if</span> awoke &#123;</span><br><span class="line">			<span class="comment">// The goroutine has been woken from sleep,</span></span><br><span class="line">			<span class="comment">// so we need to reset the flag in either case.</span></span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">new</span>&amp;mutexWoken == <span class="number">0</span> &#123;</span><br><span class="line">				throw(<span class="string">&quot;sync: inconsistent mutex state&quot;</span>)</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">new</span> &amp;^= mutexWoken</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//CASæ›´æ–°çŠ¶æ€ã€‚</span></span><br><span class="line">		<span class="keyword">if</span> atomic.CompareAndSwapInt32(&amp;m.state, old, <span class="built_in">new</span>) &#123;</span><br><span class="line">            <span class="comment">//è·å–åˆ°é”</span></span><br><span class="line">			<span class="keyword">if</span> old&amp;(mutexLocked|mutexStarving) == <span class="number">0</span> &#123;</span><br><span class="line">				<span class="keyword">break</span> <span class="comment">// locked the mutex with CAS</span></span><br><span class="line">			&#125;</span><br><span class="line">            <span class="comment">// If we were already waiting before, queue at the front of the queue.</span></span><br><span class="line">            <span class="comment">//ç­‰å¾…é˜Ÿåˆ—çš„æ—¶é—´</span></span><br><span class="line">			queueLifo := waitStartTime != <span class="number">0</span></span><br><span class="line">			<span class="keyword">if</span> waitStartTime == <span class="number">0</span> &#123;</span><br><span class="line">				waitStartTime = runtime_nanotime()</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//acquireé˜»å¡é˜Ÿåˆ—....</span></span><br><span class="line">            <span class="comment">// æ–°æ¥çš„ goroutine, queueLifo=false, åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œè€å¿ƒç­‰å¾…</span></span><br><span class="line">            <span class="comment">// å”¤é†’çš„ goroutine, queueLifo=true, åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—çš„å¤´éƒ¨</span></span><br><span class="line">			runtime_SemacquireMutex(&amp;m.sema, queueLifo, <span class="number">1</span>)</span><br><span class="line">			starving = starving || runtime_nanotime()-waitStartTime &gt; starvationThresholdNs</span><br><span class="line">            old = m.state</span><br><span class="line">            <span class="comment">//å¤„äºé¥¥é¥¿æ¨¡å¼</span></span><br><span class="line">			<span class="keyword">if</span> old&amp;mutexStarving != <span class="number">0</span> &#123;</span><br><span class="line">				<span class="comment">// If this goroutine was woken and mutex is in starvation mode,</span></span><br><span class="line">				<span class="comment">// ownership was handed off to us but mutex is in somewhat</span></span><br><span class="line">				<span class="comment">// inconsistent state: mutexLocked is not set and we are still</span></span><br><span class="line">				<span class="comment">// accounted as waiter. Fix that.</span></span><br><span class="line">				<span class="keyword">if</span> old&amp;(mutexLocked|mutexWoken) != <span class="number">0</span> || old&gt;&gt;mutexWaiterShift == <span class="number">0</span> &#123;</span><br><span class="line">					throw(<span class="string">&quot;sync: inconsistent mutex state&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//ç­‰å¾…çš„goroutine-1</span></span><br><span class="line">                delta := <span class="keyword">int32</span>(mutexLocked - <span class="number">1</span>&lt;&lt;mutexWaiterShift)</span><br><span class="line">                <span class="comment">// å¤„äºé˜Ÿåˆ—ä¸­æœ€åä¸€ä¸ªæˆ–è€…è¯·æ±‚é”çš„æ—¶é—´æœªè¶…è¿‡starvationThresholdNsï¼Œåˆ™å›é€€åˆ°æ­£å¸¸æ¨¡å¼ã€‚</span></span><br><span class="line">				<span class="keyword">if</span> !starving || old&gt;&gt;mutexWaiterShift == <span class="number">1</span> &#123;</span><br><span class="line">					<span class="comment">// Exit starvation mode.</span></span><br><span class="line">					<span class="comment">// Critical to do it here and consider wait time.</span></span><br><span class="line">					<span class="comment">// Starvation mode is so inefficient, that two goroutines</span></span><br><span class="line">					<span class="comment">// can go lock-step infinitely once they switch mutex</span></span><br><span class="line">					<span class="comment">// to starvation mode.</span></span><br><span class="line">					delta -= mutexStarving</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//æ›´æ–°çŠ¶æ€</span></span><br><span class="line">				atomic.AddInt32(&amp;m.state, delta)</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//é‡ç½®è¿­ä»£å™¨å’Œå”¤é†’è¡¨ç¤ºï¼Œç»§ç»­è·å–é”</span></span><br><span class="line">			awoke = <span class="literal">true</span></span><br><span class="line">			iter = <span class="number">0</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//CASå¤±è´¥ï¼Œåˆ™æ›´æ–°çŠ¶æ€ï¼Œç»§ç»­è·å–ã€‚</span></span><br><span class="line">			old = m.state</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> race.Enabled &#123;</span><br><span class="line">		race.Acquire(unsafe.Pointer(m))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="è§£é”è¿‡ç¨‹"><a href="#è§£é”è¿‡ç¨‹" class="headerlink" title="è§£é”è¿‡ç¨‹"></a>è§£é”è¿‡ç¨‹</h3><p>ç”¨ä¸€ä¸ªæµç¨‹å›¾æ¥è¡¨ç¤ºè§£é”è¿‡ç¨‹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/mutex-unlock.png"></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Mutex)</span> <span class="title">Unlock</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//state ä¸æ˜¯å¤„äºé”çš„çŠ¶æ€, é‚£ä¹ˆå°±æ˜¯ Unlock æ ¹æœ¬æ²¡æœ‰åŠ é”çš„ mutex, panic</span></span><br><span class="line">    <span class="built_in">new</span> := atomic.AddInt32(&amp;m.state, -mutexLocked)</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">new</span>+mutexLocked)&amp;mutexLocked == <span class="number">0</span> &#123;</span><br><span class="line">        throw(<span class="string">&quot;sync: unlock of unlocked mutex&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡Šæ”¾é”ï¼Œå¹¶é€šçŸ¥å…¶å®ƒç­‰å¾…è€…</span></span><br><span class="line">    <span class="comment">// é”å¦‚æœå¤„äºé¥¥é¥¿çŠ¶æ€ï¼Œç›´æ¥äº¤ç»™ç­‰å¾…é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ª, å”¤é†’å®ƒï¼Œè®©å®ƒå»è·å–é”</span></span><br><span class="line">    <span class="comment">// mutex æ­£å¸¸æ¨¡å¼</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">new</span>&amp;mutexStarving == <span class="number">0</span> &#123;</span><br><span class="line">        old := <span class="built_in">new</span></span><br><span class="line">        <span class="keyword">for</span> &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœæ²¡æœ‰ç­‰å¾…è€…ï¼Œæˆ–è€…å·²ç»å­˜åœ¨ä¸€ä¸ª goroutine è¢«å”¤é†’æˆ–å¾—åˆ°é”ã€æˆ–å¤„äºé¥¥é¥¿æ¨¡å¼</span></span><br><span class="line">            <span class="comment">// ç›´æ¥è¿”å›.</span></span><br><span class="line">            <span class="keyword">if</span> old&gt;&gt;mutexWaiterShift == <span class="number">0</span> || old&amp;(mutexLocked|mutexWoken|mutexStarving) != <span class="number">0</span> &#123;</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å°†ç­‰å¾…çš„ goroutine-1ï¼Œå¹¶è®¾ç½® woken æ ‡è¯†</span></span><br><span class="line">            <span class="built_in">new</span> = (old - <span class="number">1</span>&lt;&lt;mutexWaiterShift) | mutexWoken</span><br><span class="line">            <span class="comment">// è®¾ç½®æ–°çš„ state, è¿™é‡Œé€šè¿‡ä¿¡å·é‡ä¼šå”¤é†’ä¸€ä¸ªé˜»å¡çš„ goroutine å»è·å–é”.</span></span><br><span class="line">            <span class="keyword">if</span> atomic.CompareAndSwapInt32(&amp;m.state, old, <span class="built_in">new</span>) &#123;</span><br><span class="line">                runtime_Semrelease(&amp;m.sema, <span class="literal">false</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            old = m.state</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// mutex é¥¥é¥¿æ¨¡å¼ï¼Œç›´æ¥å°† mutex æ‹¥æœ‰æƒç§»äº¤ç»™ç­‰å¾…é˜Ÿåˆ—æœ€å‰ç«¯çš„ goroutine</span></span><br><span class="line">        <span class="comment">// æ³¨æ„æ­¤æ—¶ state çš„ mutex è¿˜æ²¡æœ‰åŠ é”ï¼Œå”¤é†’çš„ goroutine ä¼šè®¾ç½®å®ƒã€‚</span></span><br><span class="line">        <span class="comment">// åœ¨æ­¤æœŸé—´ï¼Œå¦‚æœæœ‰æ–°çš„ goroutine æ¥è¯·æ±‚é”ï¼Œ å› ä¸º mutex å¤„äºé¥¥é¥¿çŠ¶æ€ï¼Œ mutex è¿˜æ˜¯è¢«è®¤ä¸ºå¤„äºé”çŠ¶æ€ï¼Œ</span></span><br><span class="line">        <span class="comment">// æ–°æ¥çš„ goroutine ä¸ä¼šæŠŠé”æŠ¢è¿‡å».</span></span><br><span class="line">        runtime_Semrelease(&amp;m.sema, <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="å…³é”®ç‚¹"><a href="#å…³é”®ç‚¹" class="headerlink" title="å…³é”®ç‚¹"></a>å…³é”®ç‚¹</h3><ul>
<li>ä¸è¦é‡å¤é”å®šäº’æ–¥é”</li>
<li>ä¸è¦å¿˜è®°è§£é”äº’æ–¥é”</li>
<li>ä¸è¦åœ¨å¤šä¸ªå‡½æ•°ä¹‹é—´ç›´æ¥ä¼ é€’äº’æ–¥é”</li>
</ul>
<h3 id="END"><a href="#END" class="headerlink" title="END"></a>END</h3>]]></content>
      <tags>
        <tag>Go</tag>
        <tag>Goæºç </tag>
        <tag>Go Package</tag>
        <tag>é”</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ9ã€Go reflect ~ DeepEqual</title>
    <url>/archives/e2e7cc4e.html</url>
    <content><![CDATA[<p>ä»Šå¤©æ— æ„ä¸­çœ‹åˆ°Go101å‘äº†ä¸€ä¸ªæ¨ç‰¹:</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">&quot;fmt&quot;</span></span><br><span class="line">  <span class="string">&quot;reflect&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">p</span><span class="params">(a, b <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">  fmt.Print(<span class="string">&quot;:&quot;</span>, reflect.DeepEqual(a, b))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  a := [<span class="number">1</span>]<span class="function"><span class="keyword">func</span><span class="params">()</span></span>&#123;<span class="function"><span class="keyword">func</span><span class="params">()</span></span>&#123;&#125;&#125;</span><br><span class="line">  p(a, a)</span><br><span class="line">  p(a[:], a[:])</span><br><span class="line">  b := a</span><br><span class="line">  p(a[:], b[:])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¾“å‡ºç»“æœï¼Ÿï¼Ÿ :true:true:false</p>
</blockquote>
<a id="more"></a>

<blockquote>
<p>æ­£ç¡®ç­”æ¡ˆ :false:true:false</p>
</blockquote>
<h3 id="é”™è¯¯æ¥æº"><a href="#é”™è¯¯æ¥æº" class="headerlink" title="é”™è¯¯æ¥æº"></a>é”™è¯¯æ¥æº</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç¬¬ä¸€ä¸ªä¸ºå•¥æƒ³ç€ä¸ºtrue,ç¬¬ä¸€çœ¼çœ‹è¿‡å»ï¼Œæ¯”è¾ƒä¸¤ä¸ªaçš„å‡½æ•°ï¼Œé‚£ä¸¤ä¸ªå‡½æ•°è‚¯å®šæ˜¯ç›¸ç­‰çš„ï¼Œè¿™æ˜¯ç¬¬ä¸€ç›´è§‰(ç‹—å±ç›´è§‰).</span><br><span class="line">ç¬¬äºŒä¸ªä¸¤ä¸ªéƒ½ä¸ºniläº†ï¼Œè¿™ä¸ªæ˜¯æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä¸¤ä¸ªnilè‚¯å®šæ˜¯deepç›¸ç­‰çš„ã€‚</span><br><span class="line">ç¬¬ä¸‰ä¸ªè™½ç„¶æ˜¯é‡æ–°åˆå§‹åŒ–äº†ï¼Œæ‰€ä»¥ä¸¤ä¸ªè‚¯å®šä¸æ˜¯deepç›¸ç­‰çš„ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="æ€è·¯æ¯”å¯¹ï¼ˆé”™åœ¨å“ªé‡Œï¼‰"><a href="#æ€è·¯æ¯”å¯¹ï¼ˆé”™åœ¨å“ªé‡Œï¼‰" class="headerlink" title="æ€è·¯æ¯”å¯¹ï¼ˆé”™åœ¨å“ªé‡Œï¼‰"></a>æ€è·¯æ¯”å¯¹ï¼ˆé”™åœ¨å“ªé‡Œï¼‰</h3><p>æŸ¥é˜…æ–‡æ¡£ä¹‹åï¼Œå‘ç°ç†è§£é”™äº†ï¼š</p>
<p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/20200918-124746.png"></p>
<h3 id="DeepEqualæ­£ç¡®ç†è§£"><a href="#DeepEqualæ­£ç¡®ç†è§£" class="headerlink" title="DeepEqualæ­£ç¡®ç†è§£"></a>DeepEqualæ­£ç¡®ç†è§£</h3><blockquote>
<p>æºç ä¹Ÿå¾ˆç®€æ´ï¼š</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">DeepEqual</span><span class="params">(x, y <span class="keyword">interface</span>&#123;&#125;)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">  <span class="comment">//åŒnil</span></span><br><span class="line">	<span class="keyword">if</span> x == <span class="literal">nil</span> || y == <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> x == y</span><br><span class="line">	&#125;</span><br><span class="line">	v1 := ValueOf(x)</span><br><span class="line">  v2 := ValueOf(y)</span><br><span class="line">  <span class="comment">//å±äºåŒä¸€ç±»å‹</span></span><br><span class="line">	<span class="keyword">if</span> v1.Type() != v2.Type() &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> deepValueEqual(v1, v2, <span class="built_in">make</span>(<span class="keyword">map</span>[visit]<span class="keyword">bool</span>), <span class="number">0</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é™¤äº†ä¸Šé¢çœ‹æºç ï¼Œä¸»è¦è¿˜æ˜¯è¦çœ‹å®˜æ–¹çš„æ–‡æ¡£å’Œè¯´æ˜æ€§çš„ï¼Œè¿™ä¸ªç®—æ˜¯ç†è§£æºç çš„å‰ææŠŠï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// DeepEqual reports whether x and y are ``deeply equal,&#x27;&#x27; defined as follows.</span></span><br><span class="line"><span class="comment">// Two values of identical type are deeply equal if one of the following cases applies.</span></span><br><span class="line"><span class="comment">// Values of distinct types are never deeply equal.</span></span><br><span class="line"><span class="comment">//  æ¡ä»¶ï¼šæ•°ç»„æ·±åº¦ç›¸ç­‰ï¼Œç›¸åº”çš„å…ƒç´ éƒ½æ˜¯ç›¸ç­‰çš„ã€‚</span></span><br><span class="line"><span class="comment">// Array values are deeply equal when their corresponding elements are deeply equal.</span></span><br><span class="line"><span class="comment">//  æ¡ä»¶ï¼šç»“æ„ä½“ç›¸å¯¹åº”çš„å­—æ®µéƒ½æ˜¯ç›¸ç­‰çš„ã€‚</span></span><br><span class="line"><span class="comment">// Struct values are deeply equal if their corresponding fields,</span></span><br><span class="line"><span class="comment">// both exported and unexported, are deeply equal.</span></span><br><span class="line"><span class="comment">// æ¡ä»¶ï¼šå‡½æ•°éƒ½æ˜¯nilï¼Œåˆ™ä¸ºæ·±åº¦ç›¸ç­‰ï¼Œå…¶å®ƒæƒ…å†µä¸‹éƒ½æ˜¯ä¸ç›¸ç­‰çš„ã€‚</span></span><br><span class="line"><span class="comment">// Func values are deeply equal if both are nil; otherwise they are not deeply equal.</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// æ¡ä»¶ï¼šä¸¤ä¸ªinterfaceæŒæœ‰æ·±åº¦ç›¸åŒçš„å€¼ã€‚</span></span><br><span class="line"><span class="comment">// Interface values are deeply equal if they hold deeply equal concrete values.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">    æ¡ä»¶ï¼šä¸‹é¢æ¡ä»¶ä¸º<span class="literal">true</span>ï¼Œåˆ™æ·±åº¦ç›¸ç­‰ï¼š</span><br><span class="line">    ä¸¤ä¸ªå…¨æ˜¯<span class="literal">nil</span>ï¼Œæˆ–è€…å…¨non-<span class="literal">nil</span>ï¼Œæœ‰ç›¸åŒçš„é•¿åº¦å¹¶ä¸”æœ‰ç›¸åŒçš„å¯¹è±¡/keyå¯¹åº”çš„å€¼æ˜¯ç›¸ç­‰çš„ã€‚</span><br><span class="line"><span class="comment">// Map values are deeply equal when all of the following are true:</span></span><br><span class="line"><span class="comment">// they are both nil or both non-nil, they have the same length,</span></span><br><span class="line"><span class="comment">// and either they are the same map object or their corresponding keys</span></span><br><span class="line"><span class="comment">// (matched using Go equality) map to deeply equal values.</span></span><br><span class="line">    æ¡ä»¶ï¼šç”¨ == æ¯”è¾ƒæˆ–è€… pointçš„</span><br><span class="line"><span class="comment">// Pointer values are deeply equal if they are equal using Go&#x27;s == operator</span></span><br><span class="line"><span class="comment">// or if they point to deeply equal values.</span></span><br><span class="line">    æ¡ä»¶ï¼šä¸‹é¢æ¡ä»¶ä¸º<span class="literal">true</span>ï¼Œåˆ™æ·±åº¦ç›¸ç­‰ï¼š</span><br><span class="line">    ä¸¤ä¸ªå…¨æ˜¯<span class="literal">nil</span>ï¼Œæˆ–è€…å…¨non-<span class="literal">nil</span>ï¼Œæœ‰ç›¸åŒçš„é•¿åº¦ï¼ŒæŒ‡å‘ç›¸åŒçš„åˆå§‹åŒ–èŠ‚ç‚¹ï¼ˆå³ï¼šç›¸åŒçš„æ•°ç»„ï¼‰æˆ–ç›¸åŒçš„å…ƒç´ æ·±åº¦ç›¸ç­‰ã€‚</span><br><span class="line">    æ³¨æ„ï¼šemptyå’Œ<span class="literal">nil</span> sliceä¸æ˜¯æ·±åº¦ç›¸ç­‰çš„ã€‚</span><br><span class="line"><span class="comment">// Slice values are deeply equal when all of the following are true:</span></span><br><span class="line"><span class="comment">// they are both nil or both non-nil, they have the same length,</span></span><br><span class="line"><span class="comment">// and either they point to the same initial entry of the same underlying array</span></span><br><span class="line"><span class="comment">// (that is, &amp;x[0] == &amp;y[0]) or their corresponding elements (up to length) are deeply equal.</span></span><br><span class="line"><span class="comment">// Note that a non-nil empty slice and a nil slice (for example, []byte&#123;&#125; and []byte(nil))</span></span><br><span class="line"><span class="comment">// are not deeply equal.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Other values - numbers, bools, strings, and channels - are deeply equal</span></span><br><span class="line"><span class="comment">// if they are equal using Go&#x27;s == operator.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// In general DeepEqual is a recursive relaxation of Go&#x27;s == operator.</span></span><br><span class="line"><span class="comment">// However, this idea is impossible to implement without some inconsistency.</span></span><br><span class="line"><span class="comment">// Specifically, it is possible for a value to be unequal to itself,</span></span><br><span class="line"><span class="comment">// either because it is of func type (uncomparable in general)</span></span><br><span class="line"><span class="comment">// or because it is a floating-point NaN value (not equal to itself in floating-point comparison),</span></span><br><span class="line"><span class="comment">// or because it is an array, struct, or interface containing</span></span><br><span class="line"><span class="comment">// such a value.</span></span><br><span class="line"><span class="comment">// On the other hand, pointer values are always equal to themselves,</span></span><br><span class="line"><span class="comment">// even if they point at or contain such problematic values,</span></span><br><span class="line"><span class="comment">// because they compare equal using Go&#x27;s == operator, and that</span></span><br><span class="line"><span class="comment">// is a sufficient condition to be deeply equal, regardless of content.</span></span><br><span class="line"><span class="comment">// DeepEqual has been defined so that the same short-cut applies</span></span><br><span class="line"><span class="comment">// to slices and maps: if x and y are the same slice or the same map,</span></span><br><span class="line"><span class="comment">// they are deeply equal regardless of content.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// As DeepEqual traverses the data values it may find a cycle. The</span></span><br><span class="line"><span class="comment">// second and subsequent times that DeepEqual compares two pointer</span></span><br><span class="line"><span class="comment">// values that have been compared before, it treats the values as</span></span><br><span class="line"><span class="comment">// equal rather than examining the values to which they point.</span></span><br><span class="line"><span class="comment">// This ensures that DeepEqual terminates.</span></span><br></pre></td></tr></table></figure>

<p>å†çœ‹çœ‹è¯¦ç»†çš„deepValueEqual,å¤§è‡´çš„è¿‡ç¨‹ï¼š<br><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/20200920-103516@2x.png"></p>
<blockquote>
<p>å¤§è‡´åˆ†ä¸ºä¸‰ä¸ªè¿‡ç¨‹ï¼š</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1ã€åˆ¤æ–­ç±»å‹å’Œå€¼</span><br><span class="line">2ã€hardå›è°ƒ</span><br><span class="line">3ã€æŒ‰ç…§kindåˆ†ç±»å¤„ç†</span><br></pre></td></tr></table></figure>

<h4 id="æ•°ç»„ï¼š"><a href="#æ•°ç»„ï¼š" class="headerlink" title="æ•°ç»„ï¼š"></a>æ•°ç»„ï¼š</h4><p>æ¯”è¾ƒæ¯ä¸€ä¸ªå…ƒç´ </p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">  <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; v1.Len(); i++ &#123;</span><br><span class="line">	<span class="keyword">if</span> !deepValueEqual(v1.Index(i), v2.Index(i), visited, depth+<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h4 id="Slice"><a href="#Slice" class="headerlink" title="Slice"></a>Slice</h4><ul>
<li>æ¯”è¾ƒä¸ºnil</li>
<li>æ¯”è¾ƒé•¿åº¦</li>
<li>æ¯”è¾ƒåœ°å€</li>
<li>æ¯”è¾ƒæ¯ä¸€ä¸ªå…ƒç´ <figure class="highlight go"><table><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> v1.IsNil() != v2.IsNil() &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> v1.Len() != v2.Len() &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> v1.Pointer() == v2.Pointer() &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; v1.Len(); i++ &#123;</span><br><span class="line">	<span class="keyword">if</span> !deepValueEqual(v1.Index(i), v2.Index(i), visited, depth+<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="Interface"><a href="#Interface" class="headerlink" title="Interface"></a>Interface</h4><ul>
<li>æ¯”è¾ƒnil</li>
<li>é€’å½’æ¯”è¾ƒ<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> v1.IsNil() || v2.IsNil() &#123;</span><br><span class="line">	<span class="keyword">return</span> v1.IsNil() == v2.IsNil()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> deepValueEqual(v1.Elem(), v2.Elem(), visited, depth+<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h4 id="Ptr"><a href="#Ptr" class="headerlink" title="Ptr"></a>Ptr</h4></li>
<li>åœ°å€</li>
<li>é€’å½’æ¯”è¾ƒ<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> v1.Pointer() == v2.Pointer() &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> deepValueEqual(v1.Elem(), v2.Elem(), visited, depth+<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="struct"><a href="#struct" class="headerlink" title="struct"></a>struct</h4><ul>
<li>æ¯”è¾ƒæ¯ä¸€ä¸ªå…ƒç´ <figure class="highlight go"><table><tr><td class="code"><pre><span class="line">  <span class="keyword">for</span> i, n := <span class="number">0</span>, v1.NumField(); i &lt; n; i++ &#123;</span><br><span class="line">	<span class="keyword">if</span> !deepValueEqual(v1.Field(i), v2.Field(i), visited, depth+<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h4><ul>
<li>æ¯”è¾ƒNil</li>
<li>æ¯”è¾ƒé•¿åº¦</li>
<li>åœ°å€æ¯”è¾ƒ</li>
<li>æ¯ä¸€ä¸ªkeyå¯¹åº”çš„value</li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> v1.IsNil() != v2.IsNil() &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> v1.Len() != v2.Len() &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> v1.Pointer() == v2.Pointer() &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> _, k := <span class="keyword">range</span> v1.MapKeys() &#123;</span><br><span class="line">	val1 := v1.MapIndex(k)</span><br><span class="line">	val2 := v2.MapIndex(k)</span><br><span class="line">	<span class="keyword">if</span> !val1.IsValid() || !val2.IsValid() || !deepValueEqual(val1, val2, visited, depth+<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h4 id="Func"><a href="#Func" class="headerlink" title="Func"></a>Func</h4><ul>
<li>énilï¼Œä¸ºä¸ç­‰ã€‚<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">  <span class="keyword">if</span> v1.IsNil() &amp;&amp; v2.IsNil() &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Can&#x27;t do better than this:</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="paincæ³¨æ„ç‚¹ï¼š"><a href="#paincæ³¨æ„ç‚¹ï¼š" class="headerlink" title="paincæ³¨æ„ç‚¹ï¼š"></a>paincæ³¨æ„ç‚¹ï¼š</h3><p> deepValueEqualå‡½æ•°ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"> .....</span><br><span class="line"> ....</span><br><span class="line"> ...</span><br><span class="line"> ..</span><br><span class="line"> .</span><br><span class="line"> é€’å½’æ¬¡æ•°è¶…è¿‡<span class="number">10</span>æ¬¡åˆ™ä¼špainc....</span><br><span class="line"> <span class="comment">// if depth &gt; 10 &#123; panic(&quot;deepValueEqual&quot;) &#125;	// for debugging</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// We want to avoid putting more in the visited map than we need to.</span></span><br><span class="line"><span class="comment">// For any possible reference cycle that might be encountered,</span></span><br><span class="line"><span class="comment">// hard(v1, v2) needs to return true for at least one of the types in the cycle,</span></span><br><span class="line"><span class="comment">// and it&#x27;s safe and valid to get Value&#x27;s internal pointer.</span></span><br><span class="line">hard := <span class="function"><span class="keyword">func</span><span class="params">(v1, v2 Value)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">	<span class="keyword">switch</span> v1.Kind() &#123;</span><br><span class="line">	<span class="keyword">case</span> Map, Slice, Ptr, Interface:</span><br><span class="line">		<span class="comment">// Nil pointers cannot be cyclic. Avoid putting them in the visited map.</span></span><br><span class="line">		<span class="keyword">return</span> !v1.IsNil() &amp;&amp; !v2.IsNil()</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line"> &#125;</span><br><span class="line"> .</span><br><span class="line"> ..</span><br><span class="line"> ...</span><br><span class="line"> ....</span><br><span class="line"> .....</span><br><span class="line"> ......</span><br></pre></td></tr></table></figure>
<h3 id="END"><a href="#END" class="headerlink" title="END"></a>END</h3>]]></content>
      <tags>
        <tag>Go</tag>
        <tag>Go Package</tag>
        <tag>Day</tag>
        <tag>Go reflect</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ8ã€go rwmutexè§£è¯»</title>
    <url>/archives/3038b6c3.html</url>
    <content><![CDATA[<pre><code>å¥½ä¹…æ²¡æœ‰æ›´æ–°æ–‡ç« äº†ï¼Œè¡¨è¾¾èƒ½åŠ›ç”Ÿç–äº†è®¸å¤šğŸ˜„....
ä»Šå¤©æ‰¯æ‰¯:rwmutex è¢«ç§°ä¸ºè¯»å†™é”ã€‚ä¸€è¯´åˆ°ã€é”ã€‘æœ€ç›´æ¥çš„è”æƒ³å¯èƒ½å°±æ˜¯lock()ã€Rlock()ã€unlock()ã€Runlock()ä¹‹ç±»çš„ï¼Œä½†æ˜¯ä½œä¸ºç¨‹åºçŒ¿ï¼Œè¿˜æ˜¯è¦äº†è§£ä¸‹åº•å±‚çš„è®¾è®¡å’Œç›¸å…³çš„é€»è¾‘å®ç°ï¼Œä»¥ä¾¿äºæŠŠè¿™ç§é”çš„è®¾è®¡æ€æƒ³åº”ç”¨åˆ°å…¶å®ƒåœºæ™¯ä¸­ï¼Œå¥½äº†ï¼Œä¸åºŸè¯äº†ï¼Œå¼€é¢˜å§ã€‚
ä»é”çš„ç»“æ„è®¾è®¡--&gt;åŠ é”çš„è¿‡ç¨‹---&gt;åŠ é”çš„ç²’åº¦----&gt;è§£é”é‡Šæ”¾ï¼Œæ•´ä¸ªç”Ÿå‘½å‘¨æœŸæ¥çœ‹rwmutexçš„å…·ä½“å®ç°ã€‚</code></pre>
<a id="more"></a>
<h3 id="ç‰ˆæœ¬"><a href="#ç‰ˆæœ¬" class="headerlink" title="ç‰ˆæœ¬"></a>ç‰ˆæœ¬</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â—¯  go version</span><br><span class="line">go version go1.14.9 darwin&#x2F;amd64</span><br></pre></td></tr></table></figure>

<h3 id="åŒå‘å¯¹æ¯”rwmutexé”çš„è®¾è®¡"><a href="#åŒå‘å¯¹æ¯”rwmutexé”çš„è®¾è®¡" class="headerlink" title="åŒå‘å¯¹æ¯”rwmutexé”çš„è®¾è®¡"></a>åŒå‘å¯¹æ¯”rwmutexé”çš„è®¾è®¡</h3><pre><code>javaå®ç°ï¼šAQS(AbstractQueuedSynchronizer)</code></pre>
<h3 id="ç»“æ„è®¾è®¡"><a href="#ç»“æ„è®¾è®¡" class="headerlink" title="ç»“æ„è®¾è®¡"></a>ç»“æ„è®¾è®¡</h3><blockquote>
<p>åŸåˆ™ï¼šè¯»å†™äº’æ–¥ï¼Œä¼˜å…ˆå†™ã€‚</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> RWMutex <span class="keyword">struct</span> &#123;</span><br><span class="line">	w           Mutex  <span class="comment">// held if there are pending writers</span></span><br><span class="line">	writerSem   <span class="keyword">uint32</span> <span class="comment">// semaphore for writers to wait for completing readers  å†™ä¿¡å·é‡</span></span><br><span class="line">	readerSem   <span class="keyword">uint32</span> <span class="comment">// semaphore for readers to wait for completing writers  è¯»ä¿¡å·é‡</span></span><br><span class="line">	readerCount <span class="keyword">int32</span>  <span class="comment">// number of pending readers è¯»è®¡æ•°</span></span><br><span class="line">	readerWait  <span class="keyword">int32</span>  <span class="comment">// number of departing readers   è¯»ç­‰å¾…ï¼ˆwriteè¿›è¡Œï¼‰</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rwmutexMaxReaders = <span class="number">1</span> &lt;&lt; <span class="number">30</span>   <span class="comment">//æœ€å¤§è¯»é”çš„ä¸ªæ•°</span></span><br></pre></td></tr></table></figure>

<p>å…¶å®ƒå†åˆ†ç±»å°±æ˜¯å››ä¸ªä¸»è¦çš„å‡½æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">RLock</span><br><span class="line">RUnLock</span><br><span class="line">Lock</span><br><span class="line">UnLock</span><br></pre></td></tr></table></figure>
<h3 id="åŠ é”è¿‡ç¨‹"><a href="#åŠ é”è¿‡ç¨‹" class="headerlink" title="åŠ é”è¿‡ç¨‹"></a>åŠ é”è¿‡ç¨‹</h3><h4 id="RLockè¿‡ç¨‹"><a href="#RLockè¿‡ç¨‹" class="headerlink" title="RLockè¿‡ç¨‹"></a>RLockè¿‡ç¨‹</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(rw *RWMutex)</span> <span class="title">RLock</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> race.Enabled &#123;</span><br><span class="line">		_ = rw.w.state</span><br><span class="line">		race.Disable()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¦‚æœå†™é”è¢«è·å–çš„ï¼Œåˆ™readerCount&lt;0çš„ï¼Œé˜»å¡çŠ¶æ€</span></span><br><span class="line">    <span class="comment">//å¦‚æœå†™é”æ²¡æœ‰è¢«è·å–ï¼Œåˆ™readerCount &gt;0çš„ï¼Œè·å–è¯»é”ï¼Œä¸é˜»å¡</span></span><br><span class="line">	<span class="keyword">if</span> atomic.AddInt32(&amp;rw.readerCount, <span class="number">1</span>) &lt; <span class="number">0</span> &#123;</span><br><span class="line">        <span class="comment">// A writer is pending, wait for it. </span></span><br><span class="line">        <span class="comment">//å†™é”è¢«è·å–äº†ï¼ŒåŠ åˆ°Gé˜Ÿåˆ—åé¢ï¼ŒæŒ‚èµ·ã€‚</span></span><br><span class="line">		runtime_SemacquireMutex(&amp;rw.readerSem, <span class="literal">false</span>, <span class="number">0</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> race.Enabled &#123;</span><br><span class="line">		race.Enable()</span><br><span class="line">		race.Acquire(unsafe.Pointer(&amp;rw.readerSem))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Lockè¿‡ç¨‹"><a href="#Lockè¿‡ç¨‹" class="headerlink" title="Lockè¿‡ç¨‹"></a>Lockè¿‡ç¨‹</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Lock locks rw for writing.</span></span><br><span class="line"><span class="comment">// If the lock is already locked for reading or writing,</span></span><br><span class="line"><span class="comment">// Lock blocks until the lock is available.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(rw *RWMutex)</span> <span class="title">Lock</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> race.Enabled &#123;</span><br><span class="line">		_ = rw.w.state</span><br><span class="line">		race.Disable()</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// First, resolve competition with other writers.</span></span><br><span class="line">    <span class="comment">//ä½¿ç”¨mutexé”</span></span><br><span class="line">	rw.w.Lock()</span><br><span class="line">	<span class="comment">// Announce to readers there is a pending writer.</span></span><br><span class="line">	r := atomic.AddInt32(&amp;rw.readerCount, -rwmutexMaxReaders) + rwmutexMaxReaders</span><br><span class="line">	<span class="comment">// Wait for active readers.</span></span><br><span class="line">	<span class="keyword">if</span> r != <span class="number">0</span> &amp;&amp; atomic.AddInt32(&amp;rw.readerWait, r) != <span class="number">0</span> &#123;</span><br><span class="line">        <span class="comment">//ç­‰å¾…æ´»è·ƒçš„readerç»“æŸåï¼Œå†ç»™ä¸€ä¸ªå†™çš„ä¿¡å·é‡ï¼Œä¿è¯æ­¤åˆ»ä¹‹åçš„readeræŒ‚èµ·ã€‚</span></span><br><span class="line">		runtime_SemacquireMutex(&amp;rw.writerSem, <span class="literal">false</span>, <span class="number">0</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> race.Enabled &#123;</span><br><span class="line">		race.Enable()</span><br><span class="line">		race.Acquire(unsafe.Pointer(&amp;rw.readerSem))</span><br><span class="line">		race.Acquire(unsafe.Pointer(&amp;rw.writerSem))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åŠ é”çš„ç²’åº¦"><a href="#åŠ é”çš„ç²’åº¦" class="headerlink" title="åŠ é”çš„ç²’åº¦"></a>åŠ é”çš„ç²’åº¦</h3><blockquote>
<p>è¯» &amp; å†™ äº’ä¸å¹²æ‰°.</p>
</blockquote>
<h3 id="è§£é”é‡Šæ”¾"><a href="#è§£é”é‡Šæ”¾" class="headerlink" title="è§£é”é‡Šæ”¾"></a>è§£é”é‡Šæ”¾</h3><h4 id="RUnLock"><a href="#RUnLock" class="headerlink" title="RUnLock"></a>RUnLock</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(rw *RWMutex)</span> <span class="title">RUnlock</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> race.Enabled &#123;</span><br><span class="line">		_ = rw.w.state</span><br><span class="line">		race.ReleaseMerge(unsafe.Pointer(&amp;rw.writerSem))</span><br><span class="line">		race.Disable()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å†™é”ç­‰å¾…çŠ¶æ€ï¼Œæ£€æŸ¥å½“å‰æ˜¯å¦å¯ä»¥è¿›è¡Œè·å–</span></span><br><span class="line">	<span class="keyword">if</span> r := atomic.AddInt32(&amp;rw.readerCount, <span class="number">-1</span>); r &lt; <span class="number">0</span> &#123;</span><br><span class="line">		<span class="comment">// Outlined slow-path to allow the fast-path to be inlined</span></span><br><span class="line">		rw.rUnlockSlow(r)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> race.Enabled &#123;</span><br><span class="line">		race.Enable()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(rw *RWMutex)</span> <span class="title">rUnlockSlow</span><span class="params">(r <span class="keyword">int32</span>)</span></span> &#123;</span><br><span class="line">    <span class="comment">// r + 1 == 0è¡¨ç¤ºç›´æ¥æ‰§è¡ŒRUnlock()</span></span><br><span class="line">	<span class="comment">// r + 1 == -rwmutexMaxReadersè¡¨ç¤ºæ‰§è¡ŒLock()å†æ‰§è¡ŒRUnlock()</span></span><br><span class="line">	<span class="keyword">if</span> r+<span class="number">1</span> == <span class="number">0</span> || r+<span class="number">1</span> == -rwmutexMaxReaders &#123;</span><br><span class="line">		race.Enable()</span><br><span class="line">		throw(<span class="string">&quot;sync: RUnlock of unlocked RWMutex&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// A writer is pending.</span></span><br><span class="line">    <span class="comment">// å½“è¯»é”é‡Šæ”¾å®Œæ¯•åï¼Œé€šçŸ¥å†™é”</span></span><br><span class="line">	<span class="keyword">if</span> atomic.AddInt32(&amp;rw.readerWait, <span class="number">-1</span>) == <span class="number">0</span> &#123;</span><br><span class="line">		<span class="comment">// The last reader unblocks the writer.</span></span><br><span class="line">		runtime_Semrelease(&amp;rw.writerSem, <span class="literal">false</span>, <span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="UnLock"><a href="#UnLock" class="headerlink" title="UnLock"></a>UnLock</h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(rw *RWMutex)</span> <span class="title">Unlock</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> race.Enabled &#123;</span><br><span class="line">		_ = rw.w.state</span><br><span class="line">		race.Release(unsafe.Pointer(&amp;rw.readerSem))</span><br><span class="line">		race.Disable()</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Announce to readers there is no active writer.</span></span><br><span class="line">    r := atomic.AddInt32(&amp;rw.readerCount, rwmutexMaxReaders)</span><br><span class="line">    <span class="comment">//è¯´æ˜è¿™ä¸ªæ²¡æœ‰æ·é”ï¼Œæ²¡æ³•å†æ¬¡é‡Šæ”¾</span></span><br><span class="line">	<span class="keyword">if</span> r &gt;= rwmutexMaxReaders &#123;</span><br><span class="line">		race.Enable()</span><br><span class="line">		throw(<span class="string">&quot;sync: Unlock of unlocked RWMutex&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">// Unblock blocked readers, if any.</span></span><br><span class="line">    <span class="comment">//é‡Šæ”¾æ‰€æœ‰çš„é”ã€‚</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="keyword">int</span>(r); i++ &#123;</span><br><span class="line">		runtime_Semrelease(&amp;rw.readerSem, <span class="literal">false</span>, <span class="number">0</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// Allow other writers to proceed.</span></span><br><span class="line">	rw.w.Unlock()</span><br><span class="line">	<span class="keyword">if</span> race.Enabled &#123;</span><br><span class="line">		race.Enable()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><blockquote>
<p>è¯»&amp;å†™ï¼Œäº’ä¸å¹²æ‰°ã€‚</p>
</blockquote>
<ul>
<li><p>è¯»é”ä¸èƒ½é˜»å¡è¯»é”ï¼Œå¼•å…¥readerCount.</p>
</li>
<li><p>è¯»é”éœ€è¦é˜»å¡å†™é”ï¼Œç›´åˆ°æ‰€ä»¥è¯»é”éƒ½é‡Šæ”¾ï¼Œå¼•å…¥readerSem.</p>
</li>
<li><p>å†™é”éœ€è¦é˜»å¡è¯»é”ï¼Œç›´åˆ°æ‰€ä»¥å†™é”éƒ½é‡Šæ”¾ï¼Œå¼•å…¥wirterSem.</p>
</li>
<li><p>å†™é”éœ€è¦é˜»å¡å†™é”ï¼Œå¼•å…¥Metux.</p>
</li>
</ul>
<h3 id="END"><a href="#END" class="headerlink" title="END"></a>END</h3>]]></content>
      <tags>
        <tag>Go</tag>
        <tag>Goæºç </tag>
        <tag>Go Package</tag>
        <tag>é”</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ7ã€Go ContextåŒ…ä½¿ç”¨</title>
    <url>/archives/410dfaec.html</url>
    <content><![CDATA[<h3 id="ç‰ˆæœ¬"><a href="#ç‰ˆæœ¬" class="headerlink" title="ç‰ˆæœ¬"></a>ç‰ˆæœ¬</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â—¯  go version</span><br><span class="line">go version go1.14.9 darwin&#x2F;amd64</span><br></pre></td></tr></table></figure>

<h3 id="ç”¨Goçš„éƒ½ç¦»ä¸å¼€Contextï¼Œå¼•ç”¨å®˜ç½‘çš„ä¸€å¥è¯æ¥æè¿°ContextåŒ…ï¼š"><a href="#ç”¨Goçš„éƒ½ç¦»ä¸å¼€Contextï¼Œå¼•ç”¨å®˜ç½‘çš„ä¸€å¥è¯æ¥æè¿°ContextåŒ…ï¼š" class="headerlink" title="ç”¨Goçš„éƒ½ç¦»ä¸å¼€Contextï¼Œå¼•ç”¨å®˜ç½‘çš„ä¸€å¥è¯æ¥æè¿°ContextåŒ…ï¼š"></a>ç”¨Goçš„éƒ½ç¦»ä¸å¼€Contextï¼Œå¼•ç”¨å®˜ç½‘çš„ä¸€å¥è¯æ¥æè¿°ContextåŒ…ï¼š</h3><blockquote>
<p>Package context defines the Context type, which carries deadlines, cancellation signals, and other request-scoped values across API boundaries and between processes.</p>
</blockquote>
<p>ä¸»è¦æŒæ¡å››ä¸ªæ–¹æ³•çš„ä½¿ç”¨</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">WithCancel</span><br><span class="line">WithDeadline</span><br><span class="line">WithTimeout</span><br><span class="line">WithValue</span><br></pre></td></tr></table></figure>
<h3 id="å‰æœŸready"><a href="#å‰æœŸready" class="headerlink" title="å‰æœŸready"></a>å‰æœŸready</h3><p>è¦ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼Œå…ˆäº†è§£ä¸‹éƒ¨åˆ†ç»“æ„å’Œé€»è¾‘ï¼š</p>
<blockquote>
<p>æ—¢ç„¶contextå…¨éƒ¨éƒ½æ˜¯å’Œå–æ¶ˆç›¸å…³çš„ï¼Œæœ€èµ·ç Goåœ¨è®¾è®¡æ—¶ä¼šæœ‰è¿™ä¹ˆä¸€ä¸ªç»“æ„ã€‚</p>
</blockquote>
<a id="more"></a>

<blockquote>
<p>å…·ä½“çš„å–æ¶ˆè®¾è®¡ç»“æ„</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">type cancelCtx struct &#123;</span><br><span class="line">	Context</span><br><span class="line"></span><br><span class="line">	mu       sync.Mutex            &#x2F;&#x2F; protects following fields  åŠ é”ç”¨</span><br><span class="line">	done     chan struct&#123;&#125;         &#x2F;&#x2F; created lazily, closed by first cancel call   æ§åˆ¶channel</span><br><span class="line">	children map[canceler]struct&#123;&#125; &#x2F;&#x2F; set to nil by the first cancel call  cancelå‡½æ•°è°ƒç”¨åï¼Œé‡Šæ”¾å­ç±»</span><br><span class="line">	err      error                 &#x2F;&#x2F; set to non-nil by the first cancel call</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>timeræ§åˆ¶æ­»é”æ—¶é—´ç»“æ„ï¼š</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; A timerCtx carries a timer and a deadline. It embeds a cancelCtx to</span><br><span class="line">&#x2F;&#x2F; implement Done and Err. It implements cancel by stopping its timer then</span><br><span class="line">&#x2F;&#x2F; delegating to cancelCtx.cancel.</span><br><span class="line"></span><br><span class="line">type timerCtx struct &#123;</span><br><span class="line">	cancelCtx  </span><br><span class="line">	timer *time.Timer &#x2F;&#x2F; Under cancelCtx.mu.</span><br><span class="line"></span><br><span class="line">	deadline time.Time</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="WithCancel"><a href="#WithCancel" class="headerlink" title="WithCancel"></a>WithCancel</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">func WithCancel(parent Context) (ctx Context, cancel CancelFunc) &#123;</span><br><span class="line">    if parent &#x3D;&#x3D; nil &#123;  &#x2F;&#x2F;æ—¥å¸¸åˆ¤ç©º</span><br><span class="line">		panic(&quot;cannot create context from nil parent&quot;)</span><br><span class="line">	&#125;</span><br><span class="line">	c :&#x3D; newCancelCtx(parent) &#x2F;&#x2F;cancelCtx new</span><br><span class="line">	propagateCancel(parent, &amp;c)  &#x2F;&#x2F;å¾ªç¯ä¼ æ’­å–æ¶ˆå‡½æ•°for ctx</span><br><span class="line">	return &amp;c, func() &#123; c.cancel(true, Canceled) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>çœ‹ä¼¼å¾ˆç®€å•ï¼Œå››è¡Œè§£å†³ï¼Œä½†æ˜¯æ›´é‡è¦çš„æ˜¯å­¦ä¼šçœ‹æ³¨é‡Šè¯´æ˜å’Œç›¸å…³çš„è®¾è®¡æ€è·¯ï¼š<br>TODO </p>
</blockquote>
<p>å¼•ç”¨å®˜æ–¹çš„è¯­è¨€ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; WithCancel returns a copy of parent with a new Done channel. The returned</span><br><span class="line">&#x2F;&#x2F; context&#39;s Done channel is closed when the returned cancel function is called</span><br><span class="line">&#x2F;&#x2F; or when the parent context&#39;s Done channel is closed, whichever happens first.</span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line">&#x2F;&#x2F; Canceling this context releases resources associated with it, so code should</span><br><span class="line">&#x2F;&#x2F; call cancel as soon as the operations running in this Context complete.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Withcancel è¿”å›çš„æ˜¯ä¸€ä¸ªparentçš„é•œåƒ&#x2F;å¤åˆ¶ï¼Œä¼´éšä¸€ä¸ªDone channelé€šé“ã€‚</span><br><span class="line">Doneå…³é—­çŠ¶æ€å–å†³äº</span><br><span class="line">1ã€è¿”å›çš„cancelå‡½æ•°ã€‚</span><br><span class="line">2ã€parentçš„Done Channelå…³é—­ã€‚</span><br><span class="line">è¿™ä¸¤ä¸ªå“ªä¸ªå…ˆç¬¦åˆæ¡ä»¶äº†ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="WithDeadline-WithTimeout"><a href="#WithDeadline-WithTimeout" class="headerlink" title="WithDeadline/WithTimeout"></a>WithDeadline/WithTimeout</h3><p>è‡ªå·±æ¢³ç†çš„é€»è¾‘æ‰§è¡Œé¡ºåºï¼š</p>
<p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/20200907-152032.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Deadline&#x2F;WithTimeoutåŒºåˆ«ï¼š</span><br><span class="line"></span><br><span class="line">* deadline:çš„å…¥å‚æ˜¯ä¸€ä¸ªå…·ä½“çš„æˆªæ­¢æ—¶é—´ï¼šTime.time</span><br><span class="line">* withTimeout:å…¥å‚æ˜¯ä¸€ä¸ªå¤šå°‘æ—¶é—´åè¶…æ—¶ï¼šTime.Duration</span><br></pre></td></tr></table></figure>

<h3 id="WithValue"><a href="#WithValue" class="headerlink" title="WithValue"></a>WithValue</h3><blockquote>
<p>Withvalueå’Œvalueæ˜¯æˆå¯¹å‡ºç°çš„:</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1ã€ç»™ctxè®¾ç½®k,vï¼šwithvalue(ctx,k,v)</span><br><span class="line">2ã€è·å–ctxä¸­kçš„å€¼value(ctx,k)</span><br></pre></td></tr></table></figure>
<h3 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h3><h4 id="timerCtxè¯¦ç»†çš„è®¾è®¡æ€è·¯å’Œç»“æ„æ–‡æ¡£"><a href="#timerCtxè¯¦ç»†çš„è®¾è®¡æ€è·¯å’Œç»“æ„æ–‡æ¡£" class="headerlink" title="timerCtxè¯¦ç»†çš„è®¾è®¡æ€è·¯å’Œç»“æ„æ–‡æ¡£"></a>timerCtxè¯¦ç»†çš„è®¾è®¡æ€è·¯å’Œç»“æ„æ–‡æ¡£</h4><h4 id="æ¡†æ¶å›¾æ•´ç†"><a href="#æ¡†æ¶å›¾æ•´ç†" class="headerlink" title="æ¡†æ¶å›¾æ•´ç†"></a>æ¡†æ¶å›¾æ•´ç†</h4><h3 id="END"><a href="#END" class="headerlink" title="END"></a>END</h3>]]></content>
      <tags>
        <tag>Go</tag>
        <tag>Go Package</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ6ã€git åˆé˜¶:å®‰è£…é…ç½® ï½1</title>
    <url>/archives/bddc30f6.html</url>
    <content><![CDATA[<blockquote>
<p>è‡ªç›˜å¤å¼€å¤©è¾Ÿåœ°ï½ï½ï½ï½<br>æ‰¯è¿œäº†â€¦â€¦<br>å®Œæ•´çš„åˆ†äº«ä¸‹Gitçš„ä½¿ç”¨å’Œå­¦ä¹ çš„çŸ¥è¯†ç‚¹ï¼Œä¹‹å‰ç« èŠ‚ä¸­çš„<a href="http://blog.imrcrab.com/2020/09/01/Git%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7/">Gitå¸¸ç”¨æŠ€å·§</a>æ˜¯æˆ‘ä¹‹å‰éƒ¨åˆ†å¿«é€Ÿä½¿ç”¨çš„åœºæ™¯ï¼Œé€‚åˆäºæœ‰ç»éªŒçš„å¼€å‘è€…ï¼Œç°åœ¨æ¥ç³»ç»Ÿçš„åˆ†äº«ä¸‹å¯¹äºGitçš„ç†è§£ï¼Œä¹Ÿç®—æ˜¯è‡ªå·±å­¦ä¹ çš„è®°å½•ã€‚</p>
</blockquote>
<h2 id="å‰æ™¯"><a href="#å‰æ™¯" class="headerlink" title="å‰æ™¯"></a>å‰æ™¯</h2><p>SVNä¼°è®¡æ˜¯å®¶å–»æˆ·æ™“äº†ï¼Œä¸€ç›´è¢«ç”¨ä½œ<code>&#39;ç‰ˆæœ¬ç®¡ç†&#39;</code>å’Œ<code>ä»£ç ä»“åº“</code>ã€‚ï¼ˆps:ä¸ç®—æ˜¯å®Œæ•´çš„<code>ç‰ˆæœ¬ç®¡ç†</code>.ï¼‰<br>Gitçš„å‡ºç°ï¼Œæ˜¯linusä¹‹çˆ¶ä¼‘å‡æ—¶äº§å‡ºçš„â€œä½œå“â€,<code>ç‰ˆæœ¬ç®¡ç†</code> &amp; <code>ä»£ç ä»“åº“</code>çš„ä½œç”¨ã€‚æ€»è€Œè¨€ä¹‹ï¼Œç”¨ç†Ÿç»ƒGitäº†ï¼Œå°±å†ä¹Ÿå›ä¸å»äº†ã€‚</p>
<a id="more"></a>

<h2 id="æŒæ¡ç›®æ ‡ï¼š"><a href="#æŒæ¡ç›®æ ‡ï¼š" class="headerlink" title="æŒæ¡ç›®æ ‡ï¼š"></a>æŒæ¡ç›®æ ‡ï¼š</h2><blockquote>
<p>æœ€ç»ˆå¯ä»¥é¡ºåˆ©çš„æäº¤ä»£ç å³å¯ã€‚</p>
</blockquote>
<h2 id="æ­¤ç¯‡åªåˆ†äº«ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼š"><a href="#æ­¤ç¯‡åªåˆ†äº«ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼š" class="headerlink" title="æ­¤ç¯‡åªåˆ†äº«ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼š"></a>æ­¤ç¯‡åªåˆ†äº«ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼š</h2><blockquote>
<p>å®‰è£…Gitå’ŒGitåŸºæœ¬é…ç½®</p>
</blockquote>
<h3 id="Gitå®‰è£…"><a href="#Gitå®‰è£…" class="headerlink" title="Gitå®‰è£…"></a>Gitå®‰è£…</h3><p>è¯´å®‰è£…å…¶å®å°±æ˜¯å»å®˜ç½‘ä¸‹è½½è½¯ä»¶ï¼Œå®‰è£…åˆ°ä½ é€‰å®šåœ°æ–¹å³å¯ã€‚</p>
<p>åœ¨æ­¤é™„ä¸Šå®˜ç½‘çš„ä¸‹è½½é“¾æ¥ï¼š <a href="https://git-scm.com/download/">ç‚¹å‡»è¿›å…¥</a></p>
<p>é€‰æ‹©å¯¹åº”å¹³å°windows?linux?macos?  </p>
<p>ps:åˆ«é€‰é”™äº†ï¼Œé‚£å°±veryå°´å°¬äº†ã€‚</p>
<h3 id="åŸºæœ¬é…ç½®"><a href="#åŸºæœ¬é…ç½®" class="headerlink" title="åŸºæœ¬é…ç½®"></a>åŸºæœ¬é…ç½®</h3><p>è¯´åˆ°åŸºæœ¬é…ç½®ï¼Œå¤§å¤šæ•°éƒ½ä¼šæœ‰ï¼Œæ›´ä½•å†µæ˜¯å¦‚æ­¤å¼ºå¤§çš„ç‰ˆæœ¬æ§åˆ¶è½¯ä»¶ã€‚</p>
<h4 id="å‰æœŸåŸºæœ¬é…ç½®"><a href="#å‰æœŸåŸºæœ¬é…ç½®" class="headerlink" title="å‰æœŸåŸºæœ¬é…ç½®"></a>å‰æœŸåŸºæœ¬é…ç½®</h4><p>ä¸»è¦åˆ†ä¸‰ä¸ªåœ°æ–¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1ã€&#x2F;etc&#x2F;gitconfig æ–‡ä»¶: ç³»ç»Ÿä¸Šæ¯ä¸€ä¸ªç”¨æˆ·åŠå…¶ä»–ä»¬çš„ä»“åº“é…ç½®æ–‡ä»¶ã€‚</span><br><span class="line">2ã€~&#x2F;.gitconfig æˆ– ~&#x2F;.config&#x2F;git&#x2F;config æ–‡ä»¶ï¼š åªé’ˆå¯¹å½“å‰ç”¨æˆ·ç”Ÿæ•ˆã€‚ [globalé…ç½®]</span><br><span class="line">3ã€å½“å‰ä½¿ç”¨ä»“åº“çš„Gité…ç½®ï¼š .git&#x2F;configæ–‡ä»¶ï¼Œä»…ä»…å¯¹å½“å‰ä»“åº“é…ç½®ç”Ÿæ•ˆã€‚    [localé…ç½®]</span><br></pre></td></tr></table></figure>


<blockquote>
<p>ps: ä¼˜å…ˆæœºåˆ¶ï¼š3 &gt; 2 &gt; 1  [.git/configè¦†ç›–~/.gitconfigã€  ~/.gitconfigè¦†ç›–/etc/gitconfig]</p>
</blockquote>
<h5 id="æ³¨æ„ï¼š"><a href="#æ³¨æ„ï¼š" class="headerlink" title="æ³¨æ„ï¼š"></a>æ³¨æ„ï¼š</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">windowsä¸‹çš„~&#x2F;.gitconfigè·¯å¾„ä¸ºï¼šC:\Users\$USERä¸‹ï¼›$USERæŒ‡å½“å‰ç”µè„‘ç”¨æˆ·åç§°</span><br></pre></td></tr></table></figure>

<h5 id="æŸ¥çœ‹æ‰€æœ‰é…ç½®å‘½ä»¤"><a href="#æŸ¥çœ‹æ‰€æœ‰é…ç½®å‘½ä»¤" class="headerlink" title="æŸ¥çœ‹æ‰€æœ‰é…ç½®å‘½ä»¤"></a>æŸ¥çœ‹æ‰€æœ‰é…ç½®å‘½ä»¤</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git config --list --show-origin</span><br></pre></td></tr></table></figure>

<h4 id="ç”Ÿæˆå¯†é’¥-amp-å…³è”Github-Gitlab"><a href="#ç”Ÿæˆå¯†é’¥-amp-å…³è”Github-Gitlab" class="headerlink" title="ç”Ÿæˆå¯†é’¥&amp;å…³è”Github/Gitlab"></a>ç”Ÿæˆå¯†é’¥&amp;å…³è”Github/Gitlab</h4><h5 id="ç”Ÿæˆå¯†é’¥"><a href="#ç”Ÿæˆå¯†é’¥" class="headerlink" title="ç”Ÿæˆå¯†é’¥"></a>ç”Ÿæˆå¯†é’¥</h5><blockquote>
<p>æ ¹æ®é‚®ç®±ï¼Œä¼šè¦æ±‚è¾“å…¥å¯†ç ï¼Œè¿ç»­3ä¸ªå›è½¦å³å¯ã€‚</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;è¿™é‡Œæ¢ä¸Šä½ çš„é‚®ç®±&quot;</span><br></pre></td></tr></table></figure>

<p>æœ€åå¾—åˆ°id_rsaå’Œid_rsa.pubä¸¤ä¸ªæ–‡ä»¶ã€‚</p>
<p>è¿™é‡Œç”¨åˆ°çš„æ˜¯ä½ çš„ å…¬é’¥<code>id_rsa.pub</code>æ–‡ä»¶ï¼Œå¤åˆ¶æ–‡ä»¶é‡Œé¢çš„å†…å®¹åˆ°githubå¯†é’¥çš„ç•Œé¢ï¼š</p>
<p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/20200902075825.png"></p>
<p>æ·»åŠ SSHå®Œäº†ä¹‹åï¼Œå°±ç»‘å®šäº†ä½ æœ¬æœºå™¨å’Œgithubçš„å…³è”å…³ç³»ï¼Œç›¸å½“äºæˆæƒæˆåŠŸã€‚</p>
<h5 id="æ‹“å±•"><a href="#æ‹“å±•" class="headerlink" title="æ‹“å±•"></a>æ‹“å±•</h5><blockquote>
<p>ä¸Šè¿°ç”Ÿæˆå¯†é’¥æ—¶ä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ–‡ä»¶åç§°.æ­¤ç§æƒ…å†µé’ˆå¯¹ä½ æœ‰å¤šä¸ªgithubè´¦å·æ—¶ï¼Œæäº¤å…¬é’¥æ–‡ä»¶æ—¶ï¼Œæ‰¾å‡ºè‡ªå®šä¹‰åç§°çš„æ–‡ä»¶å³å¯ã€‚ï¼ˆä¸‹å›¾è‡ªå®šä¹‰ç”Ÿæˆæ–‡ä»¶åç§°pywang112,åˆ™å…¬é’¥ä¸ºpywang112.pubï¼Œçœ‹å¥½ä½ ç”Ÿæˆçš„è·¯å¾„å“¦ï¼‰</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/20200902080130.png"></p>
<h4 id="globalé…ç½®ï¼ˆå…¨å±€é…ç½®ï¼‰æˆ–-localé…ç½®ï¼ˆå½“å‰ä»“åº“é…ç½®ï¼‰"><a href="#globalé…ç½®ï¼ˆå…¨å±€é…ç½®ï¼‰æˆ–-localé…ç½®ï¼ˆå½“å‰ä»“åº“é…ç½®ï¼‰" class="headerlink" title="globalé…ç½®ï¼ˆå…¨å±€é…ç½®ï¼‰æˆ– localé…ç½®ï¼ˆå½“å‰ä»“åº“é…ç½®ï¼‰"></a>globalé…ç½®ï¼ˆå…¨å±€é…ç½®ï¼‰æˆ– localé…ç½®ï¼ˆå½“å‰ä»“åº“é…ç½®ï¼‰</h4><h5 id="globalé…ç½®ï¼ˆé’ˆå¯¹ä½ åªæœ‰ä¸€ä¸ªgitè´¦æˆ·çš„æƒ…å†µï¼‰"><a href="#globalé…ç½®ï¼ˆé’ˆå¯¹ä½ åªæœ‰ä¸€ä¸ªgitè´¦æˆ·çš„æƒ…å†µï¼‰" class="headerlink" title="globalé…ç½®ï¼ˆé’ˆå¯¹ä½ åªæœ‰ä¸€ä¸ªgitè´¦æˆ·çš„æƒ…å†µï¼‰"></a>globalé…ç½®ï¼ˆé’ˆå¯¹ä½ åªæœ‰ä¸€ä¸ªgitè´¦æˆ·çš„æƒ…å†µï¼‰</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æŸ¥çœ‹å‘½ä»¤ï¼š</span><br><span class="line">git config --global --list</span><br><span class="line"></span><br><span class="line">å…¨å±€é…ç½®ï¼š</span><br><span class="line"></span><br><span class="line">git config --global user.name &quot;crab&quot;</span><br><span class="line">git config --global user.email &quot;imrcrab@163.com&quot;</span><br><span class="line"></span><br><span class="line">ä»£ç†é…ç½®ï¼ˆæŒ‰éœ€å¯é€‰ï¼‰</span><br><span class="line"># http</span><br><span class="line">git config --global https.proxy http:&#x2F;&#x2F;127.0.0.1:1080 </span><br><span class="line"># sock</span><br><span class="line">git config --global http.proxy &#39;socks5:&#x2F;&#x2F;127.0.0.1:1080&#39; </span><br><span class="line"></span><br><span class="line">å–æ¶ˆä»£ç†ï¼š</span><br><span class="line">git config --global --unset http.proxy</span><br></pre></td></tr></table></figure>

<h5 id="localé…ç½®-å»ºè®®æœ¬åœ°ä»“åº“é…ç½®ï¼Œè¿™æ ·æ¯”è¾ƒçµæ´»"><a href="#localé…ç½®-å»ºè®®æœ¬åœ°ä»“åº“é…ç½®ï¼Œè¿™æ ·æ¯”è¾ƒçµæ´»" class="headerlink" title="localé…ç½® (å»ºè®®æœ¬åœ°ä»“åº“é…ç½®ï¼Œè¿™æ ·æ¯”è¾ƒçµæ´»)"></a>localé…ç½® (å»ºè®®æœ¬åœ°ä»“åº“é…ç½®ï¼Œè¿™æ ·æ¯”è¾ƒçµæ´»)</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æŸ¥çœ‹å‘½ä»¤ï¼š</span><br><span class="line">git config --local --list</span><br><span class="line"></span><br><span class="line">å…¨å±€é…ç½®ï¼š</span><br><span class="line"></span><br><span class="line">git config --local user.name &quot;crab&quot;</span><br><span class="line">git config --local user.email &quot;imrcrab@163.com&quot;</span><br><span class="line"></span><br><span class="line">ä»£ç†é…ç½®ï¼ˆæŒ‰éœ€å¯é€‰ï¼‰</span><br><span class="line"># http</span><br><span class="line">git config --local https.proxy http:&#x2F;&#x2F;127.0.0.1:1080 </span><br><span class="line"># sock</span><br><span class="line">git config --local http.proxy &#39;socks5:&#x2F;&#x2F;127.0.0.1:1080&#39; </span><br><span class="line"></span><br><span class="line">å–æ¶ˆä»£ç†ï¼š</span><br><span class="line">git config --local --unset http.proxy</span><br></pre></td></tr></table></figure>

<h4 id="é…ç½®å®Œæˆï¼Œclone-commitä»£ç "><a href="#é…ç½®å®Œæˆï¼Œclone-commitä»£ç " class="headerlink" title="é…ç½®å®Œæˆï¼Œclone/commitä»£ç "></a>é…ç½®å®Œæˆï¼Œclone/commitä»£ç </h4><h5 id="cloneä»“åº“ä»£ç "><a href="#cloneä»“åº“ä»£ç " class="headerlink" title="cloneä»“åº“ä»£ç "></a>cloneä»“åº“ä»£ç </h5><p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/20200902081306.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;crab21&#x2F;blog.git</span><br></pre></td></tr></table></figure>
<h5 id="commitä»£ç "><a href="#commitä»£ç " class="headerlink" title="commitä»£ç "></a>commitä»£ç </h5><blockquote>
<p>æŒ‰ç…§å¦‚ä¸Šé…ç½®å®Œæˆåï¼Œå°±å¯ä»¥å®ŒæˆåŸºæœ¬çš„pushå’Œpullä»“åº“ä»£ç äº†ã€‚</p>
</blockquote>
<h3 id="END"><a href="#END" class="headerlink" title="END"></a>END</h3>]]></content>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ5ã€Git GPGç­¾ç½²å·¥ä½œ</title>
    <url>/archives/580377d0.html</url>
    <content><![CDATA[<h3 id="GPGåœºæ™¯"><a href="#GPGåœºæ™¯" class="headerlink" title="GPGåœºæ™¯"></a>GPGåœºæ™¯</h3><p> Git è™½ç„¶æ˜¯å¯†ç çº§å®‰å…¨çš„ï¼Œä½†å®ƒä¸æ˜¯ä¸‡æ— ä¸€å¤±çš„ã€‚ å¦‚æœä½ ä»å› ç‰¹ç½‘ä¸Šçš„å…¶ä»–äººé‚£é‡Œæ‹¿å–å·¥ä½œï¼Œå¹¶ä¸”æƒ³è¦éªŒè¯æäº¤æ˜¯ä¸æ˜¯çœŸæ­£åœ°æ¥è‡ªäºå¯ä¿¡æ¥æºï¼Œ Git æä¾›äº†å‡ ç§é€šè¿‡ GPG æ¥ç­¾ç½²å’ŒéªŒè¯å·¥ä½œçš„æ–¹å¼ã€‚</p>
<p> æœ€ç»ˆæ•ˆæœï¼šå¦‚ä¸‹å›¾æ‰€ç¤º</p>
<p> <img src="https://raw.githubusercontent.com/crab21/Images/master/blog/20200902123343.png"></p>
<h3 id="å®‰è£…è¿‡ç¨‹"><a href="#å®‰è£…è¿‡ç¨‹" class="headerlink" title="å®‰è£…è¿‡ç¨‹"></a>å®‰è£…è¿‡ç¨‹</h3><p>windowså®‰è£…åœ°å€ï¼š <a href="https://www.gnupg.org/">ç‚¹å‡»ä¸‹è½½</a></p>
<p>mac osä¸ºä¾‹ï¼š</p>
<a id="more"></a>
<h4 id="å®‰è£…GPG"><a href="#å®‰è£…GPG" class="headerlink" title="å®‰è£…GPG"></a>å®‰è£…GPG</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">brew install gpg</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹ç»“æœï¼š</span><br><span class="line">Â± gpg --version                                                                                                                                                                                                                                     â</span><br><span class="line"></span><br><span class="line">gpg (GnuPG) 2.2.22</span><br><span class="line">libgcrypt 1.8.6</span><br><span class="line">Copyright (C) 2020 Free Software Foundation, Inc.</span><br><span class="line">License GPLv3+: GNU GPL version 3 or later &lt;https:&#x2F;&#x2F;gnu.org&#x2F;licenses&#x2F;gpl.html&gt;</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line"></span><br><span class="line">Home: &#x2F;Users&#x2F;gogoowang&#x2F;.gnupg</span><br><span class="line">æ”¯æŒçš„ç®—æ³•ï¼š</span><br><span class="line">å…¬é’¥ï¼š RSA, ELG, DSA, ECDH, ECDSA, EDDSA</span><br><span class="line">å¯†æ–‡ï¼š IDEA, 3DES, CAST5, BLOWFISH, AES, AES192, AES256, TWOFISH,</span><br><span class="line">    CAMELLIA128, CAMELLIA192, CAMELLIA256</span><br><span class="line">æ•£åˆ—ï¼š SHA1, RIPEMD160, SHA256, SHA384, SHA512, SHA224</span><br><span class="line">å‹ç¼©ï¼š  ä¸å‹ç¼©, ZIP, ZLIB, BZIP2</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="ç”Ÿæˆå¯†é’¥"><a href="#ç”Ÿæˆå¯†é’¥" class="headerlink" title="ç”Ÿæˆå¯†é’¥"></a>ç”Ÿæˆå¯†é’¥</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gpg --full-generate-key</span><br></pre></td></tr></table></figure>

<p>éœ€è¦å¡«å†™çš„åœ°æ–¹ï¼š<br><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/20200902123803.png"></p>
<h4 id="æŸ¥çœ‹å¯†é’¥å®Œæ•´ä¿¡æ¯"><a href="#æŸ¥çœ‹å¯†é’¥å®Œæ•´ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹å¯†é’¥å®Œæ•´ä¿¡æ¯"></a>æŸ¥çœ‹å¯†é’¥å®Œæ•´ä¿¡æ¯</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gpg --list-secret-keys --keyid-format LONG</span><br></pre></td></tr></table></figure>

<blockquote>
<p>secret keysï¼ˆçº¢åœˆåœ°æ–¹åç»­ç”¨åˆ°ï¼Œç•™æ„ä¸‹ï¼‰ï¼š</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/20200902124016.png"></p>
<h4 id="æ ¹æ®secret-keysç”ŸæˆPGP"><a href="#æ ¹æ®secret-keysç”ŸæˆPGP" class="headerlink" title="æ ¹æ®secret keysç”ŸæˆPGP"></a>æ ¹æ®secret keysç”ŸæˆPGP</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gpg --armor --export  7BB8CF3593CA174C</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆçš„PGPç»“æœï¼Œåç»­éœ€è¦å°†æ­¤ç»“æœå¯¼å…¥åˆ°Githubè´¦å·çš„é…ç½®ä¿¡æ¯ä¸­<br><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/20200902124305.png"></p>
<h4 id="Githubè´¦å·ä¸­è®¾ç½®"><a href="#Githubè´¦å·ä¸­è®¾ç½®" class="headerlink" title="Githubè´¦å·ä¸­è®¾ç½®"></a>Githubè´¦å·ä¸­è®¾ç½®</h4><p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/20200902124443.png"></p>
<p><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/20200902124527.png"></p>
<blockquote>
<p>å°†ä¸Šè¿°ç”Ÿæˆçš„PGPå¡«å…¥ï¼Œç‚¹å‡»[Add GPG Key]å³å¯</p>
</blockquote>
<h4 id="é…ç½®æœ¬åœ°GPGç­¾åä¿¡æ¯"><a href="#é…ç½®æœ¬åœ°GPGç­¾åä¿¡æ¯" class="headerlink" title="é…ç½®æœ¬åœ°GPGç­¾åä¿¡æ¯"></a>é…ç½®æœ¬åœ°GPGç­¾åä¿¡æ¯</h4><p>ä¾æ¬¡æ‰§è¡Œä¸‹é¢å‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1ã€git config --global user.signingkey 7BB8CF3593CA174C  #æ­¤å¤„çš„7BB8CF3593CA174Cä¸ºç”Ÿæˆçš„secret keys</span><br><span class="line">2ã€git config commit.gpgsign true</span><br><span class="line">3ã€git config --global commit.gpgsign true</span><br></pre></td></tr></table></figure>

<h4 id="Git-PGPç”Ÿæ•ˆ"><a href="#Git-PGPç”Ÿæ•ˆ" class="headerlink" title="Git PGPç”Ÿæ•ˆ"></a>Git PGPç”Ÿæ•ˆ</h4><blockquote>
<p>å†æ¬¡æäº¤commitå³å¯ç”Ÿæ•ˆã€‚äº§ç”Ÿå¦‚ä¸‹å›¾çš„ç­¾åæ•ˆæœï¼š<br><img src="https://raw.githubusercontent.com/crab21/Images/master/blog/20200902123343.png"></p>
</blockquote>
<h4 id="End"><a href="#End" class="headerlink" title="End"></a>End</h4>]]></content>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ4ã€Gitå¸¸ç”¨æŠ€å·§</title>
    <url>/archives/3c1dd822.html</url>
    <content><![CDATA[<h3 id="å­¦ä¹ æ–¹å¼"><a href="#å­¦ä¹ æ–¹å¼" class="headerlink" title="å­¦ä¹ æ–¹å¼"></a>å­¦ä¹ æ–¹å¼</h3><p>å¤šç»ƒå¤šå¾—ï¼Œç›´æ¥å­¦ä¹ <a href="https://git-scm.com/book/zh/v2/%E8%B5%B7%E6%AD%A5-%E5%85%B3%E4%BA%8E%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6">å®˜ç½‘</a>ç†è§£ã€‚</p>
<p>ä»¥ä¸‹ä»…ä»…æ˜¯éƒ¨åˆ†ç”¨åˆ°çš„åœºæ™¯å’Œéƒ¨åˆ†åœºæ™¯è®°å½•ï¼Œä¸ä»£è¡¨å…¨éƒ¨æƒ…å†µï¼Œå¦‚æœ‰é”™è¯¯ï¼Œè¯·åŠæ—¶æŒ‡æ­£ã€‚</p>
<h3 id="Gitç‰ˆæœ¬ï¼š"><a href="#Gitç‰ˆæœ¬ï¼š" class="headerlink" title="Gitç‰ˆæœ¬ï¼š"></a>Gitç‰ˆæœ¬ï¼š</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1944 Â± git version </span><br><span class="line">git version 2.28.0</span><br></pre></td></tr></table></figure>
<h3 id="å…ˆè¯´è¯´Gitçš„å¸¸ç”¨å‘½ä»¤ï¼š-å¯è·³è¿‡"><a href="#å…ˆè¯´è¯´Gitçš„å¸¸ç”¨å‘½ä»¤ï¼š-å¯è·³è¿‡" class="headerlink" title="å…ˆè¯´è¯´Gitçš„å¸¸ç”¨å‘½ä»¤ï¼š(å¯è·³è¿‡)"></a>å…ˆè¯´è¯´Gitçš„å¸¸ç”¨å‘½ä»¤ï¼š(å¯è·³è¿‡)</h3><a id="more"></a>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2081 â—¯  git </span><br><span class="line">ç”¨æ³•ï¼šgit [--version] [--help] [-C &lt;path&gt;] [-c &lt;name&gt;&#x3D;&lt;value&gt;]</span><br><span class="line">           [--exec-path[&#x3D;&lt;path&gt;]] [--html-path] [--man-path] [--info-path]</span><br><span class="line">           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]</span><br><span class="line">           [--git-dir&#x3D;&lt;path&gt;] [--work-tree&#x3D;&lt;path&gt;] [--namespace&#x3D;&lt;name&gt;]</span><br><span class="line">           &lt;command&gt; [&lt;args&gt;]</span><br><span class="line"></span><br><span class="line">è¿™äº›æ˜¯å„ç§åœºåˆå¸¸è§çš„ Git å‘½ä»¤ï¼š</span><br><span class="line"></span><br><span class="line">å¼€å§‹ä¸€ä¸ªå·¥ä½œåŒºï¼ˆå‚è§ï¼šgit help tutorialï¼‰</span><br><span class="line">   clone             å…‹éš†ä»“åº“åˆ°ä¸€ä¸ªæ–°ç›®å½•</span><br><span class="line">   init              åˆ›å»ºä¸€ä¸ªç©ºçš„ Git ä»“åº“æˆ–é‡æ–°åˆå§‹åŒ–ä¸€ä¸ªå·²å­˜åœ¨çš„ä»“åº“</span><br><span class="line"></span><br><span class="line">åœ¨å½“å‰å˜æ›´ä¸Šå·¥ä½œï¼ˆå‚è§ï¼šgit help everydayï¼‰</span><br><span class="line">   add               æ·»åŠ æ–‡ä»¶å†…å®¹è‡³ç´¢å¼•</span><br><span class="line">   mv                ç§»åŠ¨æˆ–é‡å‘½åä¸€ä¸ªæ–‡ä»¶ã€ç›®å½•æˆ–ç¬¦å·é“¾æ¥</span><br><span class="line">   restore           æ¢å¤å·¥ä½œåŒºæ–‡ä»¶</span><br><span class="line">   rm                ä»å·¥ä½œåŒºå’Œç´¢å¼•ä¸­åˆ é™¤æ–‡ä»¶</span><br><span class="line">   sparse-checkout   åˆå§‹åŒ–åŠä¿®æ”¹ç¨€ç–æ£€å‡º</span><br><span class="line"></span><br><span class="line">æ£€æŸ¥å†å²å’ŒçŠ¶æ€ï¼ˆå‚è§ï¼šgit help revisionsï¼‰</span><br><span class="line">   bisect            é€šè¿‡äºŒåˆ†æŸ¥æ‰¾å®šä½å¼•å…¥ bug çš„æäº¤</span><br><span class="line">   diff              æ˜¾ç¤ºæäº¤ä¹‹é—´ã€æäº¤å’Œå·¥ä½œåŒºä¹‹é—´ç­‰çš„å·®å¼‚</span><br><span class="line">   grep              è¾“å‡ºå’Œæ¨¡å¼åŒ¹é…çš„è¡Œ</span><br><span class="line">   log               æ˜¾ç¤ºæäº¤æ—¥å¿—</span><br><span class="line">   show              æ˜¾ç¤ºå„ç§ç±»å‹çš„å¯¹è±¡</span><br><span class="line">   status            æ˜¾ç¤ºå·¥ä½œåŒºçŠ¶æ€</span><br><span class="line"></span><br><span class="line">æ‰©å±•ã€æ ‡è®°å’Œè°ƒæ ¡æ‚¨çš„å†å²è®°å½•</span><br><span class="line">   branch            åˆ—å‡ºã€åˆ›å»ºæˆ–åˆ é™¤åˆ†æ”¯</span><br><span class="line">   commit            è®°å½•å˜æ›´åˆ°ä»“åº“</span><br><span class="line">   merge             åˆå¹¶ä¸¤ä¸ªæˆ–æ›´å¤šå¼€å‘å†å²</span><br><span class="line">   rebase            åœ¨å¦ä¸€ä¸ªåˆ†æ”¯ä¸Šé‡æ–°åº”ç”¨æäº¤</span><br><span class="line">   reset             é‡ç½®å½“å‰ HEAD åˆ°æŒ‡å®šçŠ¶æ€</span><br><span class="line">   switch            åˆ‡æ¢åˆ†æ”¯</span><br><span class="line">   tag               åˆ›å»ºã€åˆ—å‡ºã€åˆ é™¤æˆ–æ ¡éªŒä¸€ä¸ª GPG ç­¾åçš„æ ‡ç­¾å¯¹è±¡</span><br><span class="line"></span><br><span class="line">ååŒï¼ˆå‚è§ï¼šgit help workflowsï¼‰</span><br><span class="line">   fetch             ä»å¦å¤–ä¸€ä¸ªä»“åº“ä¸‹è½½å¯¹è±¡å’Œå¼•ç”¨</span><br><span class="line">   pull              è·å–å¹¶æ•´åˆå¦å¤–çš„ä»“åº“æˆ–ä¸€ä¸ªæœ¬åœ°åˆ†æ”¯</span><br><span class="line">   push              æ›´æ–°è¿œç¨‹å¼•ç”¨å’Œç›¸å…³çš„å¯¹è±¡</span><br><span class="line"></span><br><span class="line">å‘½ä»¤ &#39;git help -a&#39; å’Œ &#39;git help -g&#39; æ˜¾ç¤ºå¯ç”¨çš„å­å‘½ä»¤å’Œä¸€äº›æ¦‚å¿µå¸®åŠ©ã€‚</span><br><span class="line">æŸ¥çœ‹ &#39;git help &lt;å‘½ä»¤&gt;&#39; æˆ– &#39;git help &lt;æ¦‚å¿µ&gt;&#39; ä»¥è·å–ç»™å®šå­å‘½ä»¤æˆ–æ¦‚å¿µçš„</span><br><span class="line">å¸®åŠ©ã€‚</span><br><span class="line">æœ‰å…³ç³»ç»Ÿçš„æ¦‚è¿°ï¼ŒæŸ¥çœ‹ &#39;git help git&#39;</span><br></pre></td></tr></table></figure>

<h3 id="Gitä½¿ç”¨ï¼š"><a href="#Gitä½¿ç”¨ï¼š" class="headerlink" title="Gitä½¿ç”¨ï¼š"></a>Gitä½¿ç”¨ï¼š</h3><h4 id="ç”Ÿæˆå¯†é’¥"><a href="#ç”Ÿæˆå¯†é’¥" class="headerlink" title="ç”Ÿæˆå¯†é’¥"></a>ç”Ÿæˆå¯†é’¥</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;è¿™é‡Œæ¢ä¸Šä½ çš„é‚®ç®±&quot;</span><br></pre></td></tr></table></figure>

<p>æœ€åå¾—åˆ°<code>id_rsa</code>å’Œ<code>id_rsa.pub</code>ä¸¤ä¸ªæ–‡ä»¶ã€‚</p>
<h4 id="Gité…ç½®ä¿¡æ¯"><a href="#Gité…ç½®ä¿¡æ¯" class="headerlink" title="Gité…ç½®ä¿¡æ¯"></a>Gité…ç½®ä¿¡æ¯</h4><h5 id="æŸ¥çœ‹é…ç½®ä¿¡æ¯"><a href="#æŸ¥çœ‹é…ç½®ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹é…ç½®ä¿¡æ¯"></a>æŸ¥çœ‹é…ç½®ä¿¡æ¯</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æŸ¥çœ‹ç³»ç»Ÿé…ç½®ä¿¡æ¯</span><br><span class="line">* git config --system --list</span><br><span class="line"></span><br><span class="line">å½“å‰ç”¨æˆ·é…ç½®</span><br><span class="line">* git config --global --list</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹å½“å‰ä»“åº“é…ç½®</span><br><span class="line">* git config --local --list</span><br></pre></td></tr></table></figure>

<h5 id="è®¾ç½®ç”¨æˆ·ä¿¡æ¯"><a href="#è®¾ç½®ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="è®¾ç½®ç”¨æˆ·ä¿¡æ¯"></a>è®¾ç½®ç”¨æˆ·ä¿¡æ¯</h5><p>å…¨å±€è®¾ç½®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git config --global user.name &quot;crab&quot;</span><br><span class="line">git config --global user.email &quot;imrcrab@163.com&quot;</span><br></pre></td></tr></table></figure>

<p>å½“å‰ä»“åº“ç”Ÿæ•ˆï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git config --local user.name &quot;crab&quot;</span><br><span class="line">git config --local user.email &quot;imrcrab@163.com&quot;</span><br></pre></td></tr></table></figure>



<h4 id="Git-Remote"><a href="#Git-Remote" class="headerlink" title="Git Remote"></a>Git Remote</h4><h5 id="æ–°å¢remoteåœ°å€"><a href="#æ–°å¢remoteåœ°å€" class="headerlink" title="æ–°å¢remoteåœ°å€"></a>æ–°å¢remoteåœ°å€</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git remote add upstream http:&#x2F;&#x2F;github&#x2F;**remote**&#x2F;test.git</span><br><span class="line">git remote -v å¯ä»¥æŸ¥çœ‹å…·ä½“è·¯å¾„</span><br></pre></td></tr></table></figure>
<h5 id="merge-fetchè¿œç¨‹ä»£ç åˆ°XXXåˆ†æ”¯"><a href="#merge-fetchè¿œç¨‹ä»£ç åˆ°XXXåˆ†æ”¯" class="headerlink" title="merge/fetchè¿œç¨‹ä»£ç åˆ°XXXåˆ†æ”¯"></a>merge/fetchè¿œç¨‹ä»£ç åˆ°XXXåˆ†æ”¯</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1ã€git fetch upstreamã€‚</span><br><span class="line">2ã€åˆ‡å›åˆ°masteråˆ†æ”¯ã€‚</span><br><span class="line">3ã€git merge upstream&#x2F;master åˆå¹¶è¿œç¨‹upstreamåˆ†æ”¯åˆ°æœ¬åœ°masterã€‚</span><br><span class="line">4ã€è§£å†³å†²çªæˆ–å…¶ä»–é—®é¢˜ã€‚</span><br></pre></td></tr></table></figure>

<h4 id="Git-è¯¯åˆ é™¤æ¢å¤"><a href="#Git-è¯¯åˆ é™¤æ¢å¤" class="headerlink" title="Git è¯¯åˆ é™¤æ¢å¤"></a>Git è¯¯åˆ é™¤æ¢å¤</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1ã€git  fsck --lost -found :æŸ¥çœ‹æœ€è¿‘ç§»é™¤çš„æ–‡ä»¶.</span><br><span class="line">2ã€git show  &#39;è¯¯åˆ ç¼–å·&#39;ï¼šæŸ¥çœ‹åˆ é™¤æ–‡ä»¶å†…å®¹.</span><br><span class="line">3ã€git merge â€˜è¯¯åˆ ç¼–å·â€™ï¼š æœ¬åœ°åˆå¹¶è¯¯åˆ çš„æ–‡ä»¶å†…å®¹.</span><br></pre></td></tr></table></figure>

<h4 id="Git-resetæ’¤å›æ“ä½œ"><a href="#Git-resetæ’¤å›æ“ä½œ" class="headerlink" title="Git resetæ’¤å›æ“ä½œ"></a>Git resetæ’¤å›æ“ä½œ</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1ã€git reflog</span><br><span class="line">2ã€git reset COMMITID    å°±å¯ä»¥å›åˆ°COMMITIDé‚£ä¸ªåˆ†æ”¯å’Œç‰ˆæœ¬ã€‚</span><br></pre></td></tr></table></figure>

<h4 id="Gitåˆ†æ”¯"><a href="#Gitåˆ†æ”¯" class="headerlink" title="Gitåˆ†æ”¯"></a>Gitåˆ†æ”¯</h4><h5 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h5><blockquote>
<p>è·å–ç”¨æ³•ï¼šGit branch -d â€“help</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç”¨æ³•ï¼šgit branch [&lt;é€‰é¡¹&gt;] [-r | -a] [--merged | --no-merged]</span><br><span class="line">  æˆ–ï¼šgit branch [&lt;é€‰é¡¹&gt;] [-l] [-f] &lt;åˆ†æ”¯å&gt; [&lt;èµ·å§‹ç‚¹&gt;]</span><br><span class="line">  æˆ–ï¼šgit branch [&lt;é€‰é¡¹&gt;] [-r] (-d | -D) &lt;åˆ†æ”¯å&gt;...</span><br><span class="line">  æˆ–ï¼šgit branch [&lt;é€‰é¡¹&gt;] (-m | -M) [&lt;æ—§åˆ†æ”¯&gt;] &lt;æ–°åˆ†æ”¯&gt;</span><br><span class="line">  æˆ–ï¼šgit branch [&lt;é€‰é¡¹&gt;] (-c | -C) [&lt;è€åˆ†æ”¯&gt;] &lt;æ–°åˆ†æ”¯&gt;</span><br><span class="line">  æˆ–ï¼šgit branch [&lt;é€‰é¡¹&gt;] [-r | -a] [--points-at]</span><br><span class="line">  æˆ–ï¼šgit branch [&lt;é€‰é¡¹&gt;] [-r | -a] [--format]</span><br><span class="line"></span><br><span class="line">é€šç”¨é€‰é¡¹</span><br><span class="line">    -v, --verbose         æ˜¾ç¤ºå“ˆå¸Œå€¼å’Œä¸»é¢˜ï¼Œè‹¥å‚æ•°å‡ºç°ä¸¤æ¬¡åˆ™æ˜¾ç¤ºä¸Šæ¸¸åˆ†æ”¯</span><br><span class="line">    -q, --quiet           ä¸æ˜¾ç¤ºä¿¡æ¯</span><br><span class="line">    -t, --track           è®¾ç½®è·Ÿè¸ªæ¨¡å¼ï¼ˆå‚è§ git-pull(1)ï¼‰</span><br><span class="line">    -u, --set-upstream-to &lt;ä¸Šæ¸¸&gt;</span><br><span class="line">                          æ”¹å˜ä¸Šæ¸¸ä¿¡æ¯</span><br><span class="line">    --unset-upstream      å–æ¶ˆä¸Šæ¸¸ä¿¡æ¯çš„è®¾ç½®</span><br><span class="line">    --color[&#x3D;&lt;ä½•æ—¶&gt;]      ä½¿ç”¨å½©è‰²è¾“å‡º</span><br><span class="line">    -r, --remotes         ä½œç”¨äºè¿œç¨‹è·Ÿè¸ªåˆ†æ”¯</span><br><span class="line">    --contains &lt;æäº¤&gt;     åªæ‰“å°åŒ…å«è¯¥æäº¤çš„åˆ†æ”¯</span><br><span class="line">    --no-contains &lt;æäº¤&gt;  åªæ‰“å°ä¸åŒ…å«è¯¥æäº¤çš„åˆ†æ”¯</span><br><span class="line">    --abbrev[&#x3D;&lt;n&gt;]        ç”¨ &lt;n&gt; ä½æ•°å­—æ˜¾ç¤º SHA-1 å“ˆå¸Œå€¼</span><br><span class="line"></span><br><span class="line">å…·ä½“çš„ git-branch åŠ¨ä½œï¼š</span><br><span class="line">    -a, --all             åˆ—å‡ºè¿œç¨‹è·Ÿè¸ªåŠæœ¬åœ°åˆ†æ”¯</span><br><span class="line">    -d, --delete          åˆ é™¤å®Œå…¨åˆå¹¶çš„åˆ†æ”¯</span><br><span class="line">    -D                    åˆ é™¤åˆ†æ”¯ï¼ˆå³ä½¿æ²¡æœ‰åˆå¹¶ï¼‰</span><br><span class="line">    -m, --move            ç§»åŠ¨&#x2F;é‡å‘½åä¸€ä¸ªåˆ†æ”¯ï¼Œä»¥åŠå®ƒçš„å¼•ç”¨æ—¥å¿—</span><br><span class="line">    -M                    ç§»åŠ¨&#x2F;é‡å‘½åä¸€ä¸ªåˆ†æ”¯ï¼Œå³ä½¿ç›®æ ‡å·²å­˜åœ¨</span><br><span class="line">    -c, --copy            æ‹·è´ä¸€ä¸ªåˆ†æ”¯å’Œå®ƒçš„å¼•ç”¨æ—¥å¿—</span><br><span class="line">    -C                    æ‹·è´ä¸€ä¸ªåˆ†æ”¯ï¼Œå³ä½¿ç›®æ ‡å·²å­˜åœ¨</span><br><span class="line">    -l, --list            åˆ—å‡ºåˆ†æ”¯å</span><br><span class="line">    --show-current        æ˜¾ç¤ºå½“å‰åˆ†æ”¯å</span><br><span class="line">    --create-reflog       åˆ›å»ºåˆ†æ”¯çš„å¼•ç”¨æ—¥å¿—</span><br><span class="line">    --edit-description    æ ‡è®°åˆ†æ”¯çš„æè¿°</span><br><span class="line">    -f, --force           å¼ºåˆ¶åˆ›å»ºã€ç§»åŠ¨&#x2F;é‡å‘½åã€åˆ é™¤</span><br><span class="line">    --merged &lt;æäº¤&gt;       åªæ‰“å°å·²ç»åˆå¹¶çš„åˆ†æ”¯</span><br><span class="line">    --no-merged &lt;æäº¤&gt;    åªæ‰“å°å°šæœªåˆå¹¶çš„åˆ†æ”¯</span><br><span class="line">    --column[&#x3D;&lt;é£æ ¼&gt;]     ä»¥åˆ—çš„æ–¹å¼æ˜¾ç¤ºåˆ†æ”¯</span><br><span class="line">    --sort &lt;key&gt;          æ’åºçš„å­—æ®µå</span><br><span class="line">    --points-at &lt;å¯¹è±¡&gt;    åªæ‰“å°æŒ‡å‘è¯¥å¯¹è±¡çš„åˆ†æ”¯</span><br><span class="line">    -i, --ignore-case     æ’åºå’Œè¿‡æ»¤å±äºå¤§å°å†™ä¸æ•æ„Ÿ</span><br><span class="line">    --format &lt;æ ¼å¼&gt;       è¾“å‡ºæ ¼å¼</span><br></pre></td></tr></table></figure>

<h5 id="è·å–æ‰€æœ‰åˆ†æ”¯"><a href="#è·å–æ‰€æœ‰åˆ†æ”¯" class="headerlink" title="è·å–æ‰€æœ‰åˆ†æ”¯"></a>è·å–æ‰€æœ‰åˆ†æ”¯</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git branch -r | grep -v &#39;\-&gt;&#39; | while read remote; do git branch --track &quot;$&#123;remote#origin&#x2F;&#125;&quot; &quot;$remote&quot;; done</span><br><span class="line">git fetch --all</span><br><span class="line">git pull --all</span><br></pre></td></tr></table></figure>
<h5 id="add-removeåˆ†æ”¯"><a href="#add-removeåˆ†æ”¯" class="headerlink" title="add/removeåˆ†æ”¯"></a>add/removeåˆ†æ”¯</h5><p>æ–°å»º&amp;åˆ‡æ¢:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git checkout -b iss53</span><br><span class="line"></span><br><span class="line">æ˜¯ä¸‹é¢ä¸¤æ¡çš„ç®€å†™ï¼š</span><br><span class="line">git branch iss53</span><br><span class="line">git checkout iss53</span><br></pre></td></tr></table></figure>
<p>åˆ é™¤åˆ†æ”¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git branch -d iss53</span><br></pre></td></tr></table></figure>

<h4 id="Git-stash"><a href="#Git-stash" class="headerlink" title="Git stash"></a>Git stash</h4><h5 id="å¸¸ç”¨ï¼š"><a href="#å¸¸ç”¨ï¼š" class="headerlink" title="å¸¸ç”¨ï¼š"></a>å¸¸ç”¨ï¼š</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ï¼ˆ1ï¼‰git stash save &quot;save message&quot;  : æ‰§è¡Œå­˜å‚¨æ—¶ï¼Œæ·»åŠ å¤‡æ³¨ï¼Œæ–¹ä¾¿æŸ¥æ‰¾ï¼Œåªæœ‰git stash ä¹Ÿè¦å¯ä»¥çš„ï¼Œä½†æŸ¥æ‰¾æ—¶ä¸æ–¹ä¾¿è¯†åˆ«ã€‚</span><br><span class="line">ï¼ˆ2ï¼‰git stash list  ï¼šæŸ¥çœ‹stashäº†å“ªäº›å­˜å‚¨</span><br><span class="line">ï¼ˆ3ï¼‰git stash show ï¼šæ˜¾ç¤ºåšäº†å“ªäº›æ”¹åŠ¨ï¼Œé»˜è®¤showç¬¬ä¸€ä¸ªå­˜å‚¨,å¦‚æœè¦æ˜¾ç¤ºå…¶ä»–å­˜è´®ï¼Œåé¢åŠ stash@&#123;$num&#125;ï¼Œæ¯”å¦‚ç¬¬äºŒä¸ª git stash show stash@&#123;1&#125;</span><br><span class="line">ï¼ˆ4ï¼‰git stash show -p : æ˜¾ç¤ºç¬¬ä¸€ä¸ªå­˜å‚¨çš„æ”¹åŠ¨ï¼Œå¦‚æœæƒ³æ˜¾ç¤ºå…¶ä»–å­˜å­˜å‚¨ï¼Œå‘½ä»¤ï¼šgit stash show  stash@&#123;$num&#125;  -p ï¼Œæ¯”å¦‚ç¬¬äºŒä¸ªï¼šgit stash show  stash@&#123;1&#125;  -p</span><br><span class="line">ï¼ˆ5ï¼‰git stash apply :åº”ç”¨æŸä¸ªå­˜å‚¨,ä½†ä¸ä¼šæŠŠå­˜å‚¨ä»å­˜å‚¨åˆ—è¡¨ä¸­åˆ é™¤ï¼Œé»˜è®¤ä½¿ç”¨ç¬¬ä¸€ä¸ªå­˜å‚¨,å³stash@&#123;0&#125;ï¼Œå¦‚æœè¦ä½¿ç”¨å…¶ä»–ä¸ªï¼Œgit stash apply stash@&#123;$num&#125; ï¼Œ æ¯”å¦‚ç¬¬äºŒä¸ªï¼šgit stash apply stash@&#123;1&#125; </span><br><span class="line">ï¼ˆ6ï¼‰git stash pop ï¼šå‘½ä»¤æ¢å¤ä¹‹å‰ç¼“å­˜çš„å·¥ä½œç›®å½•ï¼Œå°†ç¼“å­˜å †æ ˆä¸­çš„å¯¹åº”stashåˆ é™¤ï¼Œå¹¶å°†å¯¹åº”ä¿®æ”¹åº”ç”¨åˆ°å½“å‰çš„å·¥ä½œç›®å½•ä¸‹,é»˜è®¤ä¸ºç¬¬ä¸€ä¸ªstash,å³stash@&#123;0&#125;ï¼Œå¦‚æœè¦åº”ç”¨å¹¶åˆ é™¤å…¶ä»–stashï¼Œå‘½ä»¤ï¼šgit stash pop stash@&#123;$num&#125; ï¼Œæ¯”å¦‚åº”ç”¨å¹¶åˆ é™¤ç¬¬äºŒä¸ªï¼šgit stash pop stash@&#123;1&#125;</span><br><span class="line">ï¼ˆ7ï¼‰git stash drop stash@&#123;$num&#125; ï¼šä¸¢å¼ƒstash@&#123;$num&#125;å­˜å‚¨ï¼Œä»åˆ—è¡¨ä¸­åˆ é™¤è¿™ä¸ªå­˜å‚¨</span><br><span class="line">ï¼ˆ8ï¼‰git stash clear ï¼šåˆ é™¤æ‰€æœ‰ç¼“å­˜çš„stash</span><br></pre></td></tr></table></figure>

<h4 id="Git-Tag"><a href="#Git-Tag" class="headerlink" title="Git Tag"></a>Git Tag</h4><h5 id="å¸¸ç”¨ï¼š-1"><a href="#å¸¸ç”¨ï¼š-1" class="headerlink" title="å¸¸ç”¨ï¼š"></a>å¸¸ç”¨ï¼š</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2097 Â± git tag -a --help</span><br><span class="line">ç”¨æ³•ï¼šgit tag [-a | -s | -u &lt;key-id&gt;] [-f] [-m &lt;æ¶ˆæ¯&gt; | -F &lt;æ–‡ä»¶&gt;]</span><br><span class="line">		&lt;æ ‡ç­¾å&gt; [&lt;å¤´&gt;]</span><br><span class="line">  æˆ–ï¼šgit tag -d &lt;æ ‡ç­¾å&gt;...</span><br><span class="line">  æˆ–ï¼šgit tag -l [-n[&lt;æ•°å­—&gt;]] [--contains &lt;æäº¤&gt;] [--no-contains &lt;æäº¤&gt;] [--points-at &lt;å¯¹è±¡&gt;]</span><br><span class="line">		[--format&#x3D;&lt;æ ¼å¼&gt;] [--[no-]merged [&lt;æäº¤&gt;]] [&lt;æ¨¡å¼&gt;...]</span><br><span class="line">  æˆ–ï¼šgit tag -v [--format&#x3D;&lt;æ ¼å¼&gt;] &lt;æ ‡ç­¾å&gt;...</span><br><span class="line"></span><br><span class="line">    -l, --list            åˆ—å‡ºæ ‡ç­¾åç§°</span><br><span class="line">    -n[&lt;n&gt;]               æ¯ä¸ªæ ‡ç­¾ä¿¡æ¯æ‰“å° &lt;n&gt; è¡Œ</span><br><span class="line">    -d, --delete          åˆ é™¤æ ‡ç­¾</span><br><span class="line">    -v, --verify          éªŒè¯æ ‡ç­¾</span><br><span class="line"></span><br><span class="line">æ ‡ç­¾åˆ›å»ºé€‰é¡¹</span><br><span class="line">    -a, --annotate        é™„æ³¨æ ‡ç­¾ï¼Œéœ€è¦ä¸€ä¸ªè¯´æ˜</span><br><span class="line">    -m, --message &lt;è¯´æ˜&gt;  æ ‡ç­¾è¯´æ˜</span><br><span class="line">    -F, --file &lt;æ–‡ä»¶&gt;     ä»æ–‡ä»¶ä¸­è¯»å–æäº¤è¯´æ˜</span><br><span class="line">    -e, --edit            å¼ºåˆ¶ç¼–è¾‘æ ‡ç­¾è¯´æ˜</span><br><span class="line">    -s, --sign            é™„æ³¨å¹¶é™„åŠ  GPG ç­¾åçš„æ ‡ç­¾</span><br><span class="line">    --cleanup &lt;æ¨¡å¼&gt;      è®¾ç½®å¦‚ä½•åˆ é™¤æäº¤è¯´æ˜é‡Œçš„ç©ºæ ¼å’Œ#æ³¨é‡Š</span><br><span class="line">    -u, --local-user &lt;key-id&gt;</span><br><span class="line">                          ä½¿ç”¨å¦å¤–çš„ç§é’¥ç­¾åè¯¥æ ‡ç­¾</span><br><span class="line">    -f, --force           å¦‚æœå­˜åœ¨ï¼Œæ›¿æ¢ç°æœ‰çš„æ ‡ç­¾</span><br><span class="line">    --create-reflog       åˆ›å»ºå¼•ç”¨æ—¥å¿—</span><br><span class="line"></span><br><span class="line">æ ‡ç­¾åˆ—è¡¨é€‰é¡¹</span><br><span class="line">    --column[&#x3D;&lt;é£æ ¼&gt;]     ä»¥åˆ—çš„æ–¹å¼æ˜¾ç¤ºæ ‡ç­¾åˆ—è¡¨</span><br><span class="line">    --contains &lt;æäº¤&gt;     åªæ‰“å°åŒ…å«è¯¥æäº¤çš„æ ‡ç­¾</span><br><span class="line">    --no-contains &lt;æäº¤&gt;  åªæ‰“å°ä¸åŒ…å«è¯¥æäº¤çš„æ ‡ç­¾</span><br><span class="line">    --merged &lt;æäº¤&gt;       åªæ‰“å°å·²ç»åˆå¹¶çš„æ ‡ç­¾</span><br><span class="line">    --no-merged &lt;æäº¤&gt;    åªæ‰“å°å°šæœªåˆå¹¶çš„æ ‡ç­¾</span><br><span class="line">    --sort &lt;key&gt;          æ’åºçš„å­—æ®µå</span><br><span class="line">    --points-at &lt;å¯¹è±¡&gt;    åªæ‰“å°æŒ‡å‘è¯¥å¯¹è±¡çš„æ ‡ç­¾</span><br><span class="line">    --format &lt;æ ¼å¼&gt;       è¾“å‡ºæ ¼å¼</span><br><span class="line">    --color[&#x3D;&lt;ä½•æ—¶&gt;]      éµç…§æ ¼å¼ä¸­çš„é¢œè‰²è¾“å‡º</span><br><span class="line">    -i, --ignore-case     æ’åºå’Œè¿‡æ»¤å±äºå¤§å°å†™ä¸æ•æ„Ÿ</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git tagæŒ‰ç…§versionæ’åºï¼š</span><br><span class="line">git tag -n</span><br><span class="line"></span><br><span class="line">git tagæŒ‰ç…§æ—¶é—´æ’åº</span><br><span class="line">git tag -n --sort&#x3D;taggerdate</span><br></pre></td></tr></table></figure>

<h5 id="æ‰“Tag"><a href="#æ‰“Tag" class="headerlink" title="æ‰“Tag"></a>æ‰“Tag</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git tag -a v0.0.1 -m &quot;V0.0.1&quot; </span><br></pre></td></tr></table></figure>

<h5 id="åˆ é™¤Tag"><a href="#åˆ é™¤Tag" class="headerlink" title="åˆ é™¤Tag"></a>åˆ é™¤Tag</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git tag -d v0.0.1</span><br></pre></td></tr></table></figure>

<h5 id="æ¨é€Tag"><a href="#æ¨é€Tag" class="headerlink" title="æ¨é€Tag"></a>æ¨é€Tag</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push origin master --tags</span><br></pre></td></tr></table></figure>

<h4 id="Git-push"><a href="#Git-push" class="headerlink" title="Git push"></a>Git push</h4><h5 id="ç”¨æ³•-1"><a href="#ç”¨æ³•-1" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç”¨æ³•ï¼šgit push [&lt;é€‰é¡¹&gt;] [&lt;ä»“åº“&gt; [&lt;å¼•ç”¨è§„æ ¼&gt;...]]</span><br><span class="line"></span><br><span class="line">    -v, --verbose         æ›´åŠ è¯¦ç»†</span><br><span class="line">    -q, --quiet           æ›´åŠ å®‰é™</span><br><span class="line">    --repo &lt;ä»“åº“&gt;         ä»“åº“</span><br><span class="line">    --all                 æ¨é€æ‰€æœ‰å¼•ç”¨</span><br><span class="line">    --mirror              é•œåƒæ‰€æœ‰å¼•ç”¨</span><br><span class="line">    -d, --delete          åˆ é™¤å¼•ç”¨</span><br><span class="line">    --tags                æ¨é€æ ‡ç­¾ï¼ˆä¸èƒ½ä½¿ç”¨ --all or --mirrorï¼‰</span><br><span class="line">    -n, --dry-run         æ¼”ä¹ </span><br><span class="line">    --porcelain           æœºå™¨å¯è¯»çš„è¾“å‡º</span><br><span class="line">    -f, --force           å¼ºåˆ¶æ›´æ–°</span><br><span class="line">    --force-with-lease[&#x3D;&lt;å¼•ç”¨å&gt;:&lt;æœŸæœ›å€¼&gt;]</span><br><span class="line">                          è¦æ±‚å¼•ç”¨æ—§çš„å–å€¼ä¸ºè®¾å®šå€¼</span><br><span class="line">    --recurse-submodules (check|on-demand|no)</span><br><span class="line">                          æ§åˆ¶å­æ¨¡ç»„çš„é€’å½’æ¨é€</span><br><span class="line">    --thin                ä½¿ç”¨ç²¾ç®€æ‰“åŒ…</span><br><span class="line">    --receive-pack &lt;receive-pack&gt;</span><br><span class="line">                          æ¥æ”¶åŒ…ç¨‹åº</span><br><span class="line">    --exec &lt;receive-pack&gt;</span><br><span class="line">                          æ¥æ”¶åŒ…ç¨‹åº</span><br><span class="line">    -u, --set-upstream    è®¾ç½® git pull&#x2F;status çš„ä¸Šæ¸¸</span><br><span class="line">    --progress            å¼ºåˆ¶æ˜¾ç¤ºè¿›åº¦æŠ¥å‘Š</span><br><span class="line">    --prune               æ¸…é™¤æœ¬åœ°åˆ é™¤çš„å¼•ç”¨</span><br><span class="line">    --no-verify           ç»•è¿‡ pre-push é’©å­</span><br><span class="line">    --follow-tags         æ¨é€ç¼ºå¤±ä½†æœ‰å…³çš„æ ‡ç­¾</span><br><span class="line">    --signed[&#x3D;(yes|no|if-asked)]</span><br><span class="line">                          ç”¨ GPG ä¸ºæ¨é€ç­¾å</span><br><span class="line">    --atomic              éœ€è¦è¿œç«¯æ”¯æŒåŸå­äº‹åŠ¡</span><br><span class="line">    -o, --push-option &lt;server-specific&gt;</span><br><span class="line">                          ä¼ è¾“é€‰é¡¹</span><br><span class="line">    -4, --ipv4            åªä½¿ç”¨ IPv4 åœ°å€</span><br><span class="line">    -6, --ipv6            åªä½¿ç”¨ IPv6 åœ°å€</span><br></pre></td></tr></table></figure>

<h4 id="Git-rebase"><a href="#Git-rebase" class="headerlink" title="Git rebase"></a>Git rebase</h4><h5 id="å˜åŸºéµå®ˆçš„åŸåˆ™"><a href="#å˜åŸºéµå®ˆçš„åŸåˆ™" class="headerlink" title="å˜åŸºéµå®ˆçš„åŸåˆ™"></a>å˜åŸºéµå®ˆçš„åŸåˆ™</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å¦‚æœæäº¤å­˜åœ¨äºä½ çš„ä»“åº“ä¹‹å¤–ï¼Œè€Œåˆ«äººå¯èƒ½åŸºäºè¿™äº›æäº¤è¿›è¡Œå¼€å‘ï¼Œé‚£ä¹ˆä¸è¦æ‰§è¡Œå˜åŸºã€‚---[å®˜ç½‘å˜åŸº](https:&#x2F;&#x2F;git-scm.com&#x2F;book&#x2F;zh&#x2F;v2&#x2F;Git-%E5%88%86%E6%94%AF-%E5%8F%98%E5%9F%BA)</span><br><span class="line"></span><br><span class="line">TODO åç»­æ›´æ–°æ­¤è¿‡ç¨‹</span><br></pre></td></tr></table></figure>


<h5 id="ç»å…¸ç”¨æ³•ï¼š"><a href="#ç»å…¸ç”¨æ³•ï¼š" class="headerlink" title="ç»å…¸ç”¨æ³•ï¼š"></a>ç»å…¸ç”¨æ³•ï¼š</h5><blockquote>
<p>git rebase â€“help</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Assume the following history exists and the current branch is &quot;topic&quot;:</span><br><span class="line"></span><br><span class="line">              A---B---C topic</span><br><span class="line">             &#x2F;</span><br><span class="line">        D---E---F---G master</span><br><span class="line">From this point, the result of either of thefollowing </span><br><span class="line"></span><br><span class="line">commands:</span><br><span class="line">    git rebase master</span><br><span class="line">    git rebase master topic</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">would be:</span><br><span class="line">                      A&#39;--B&#39;--C&#39; topic</span><br><span class="line">                     &#x2F;</span><br><span class="line">        D---E---F---G master</span><br></pre></td></tr></table></figure>

<h5 id="rebaseåœºæ™¯ï¼š"><a href="#rebaseåœºæ™¯ï¼š" class="headerlink" title="rebaseåœºæ™¯ï¼š"></a>rebaseåœºæ™¯ï¼š</h5><p><a href="https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E5%8F%98%E5%9F%BA">å®˜ç½‘ä¾‹å­</a></p>
<h3 id="Git-å¿«é€Ÿåœºæ™¯ï¼š"><a href="#Git-å¿«é€Ÿåœºæ™¯ï¼š" class="headerlink" title="Git å¿«é€Ÿåœºæ™¯ï¼š"></a>Git å¿«é€Ÿåœºæ™¯ï¼š</h3><p>å…¶å®è¿˜æ˜¯å¯¹ä¸Šè¿°å‘½ä»¤çš„æ´»å­¦æ´»ç”¨ã€‚</p>
<h4 id="Git-Resetåœºæ™¯"><a href="#Git-Resetåœºæ™¯" class="headerlink" title="Git Resetåœºæ™¯"></a>Git Resetåœºæ™¯</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1. æœ¬åœ°ä¿®æ”¹äº†ä¸€å †æ–‡ä»¶(å¹¶æ²¡æœ‰ä½¿ç”¨git addåˆ°æš‚å­˜åŒº)ï¼Œæƒ³æ”¾å¼ƒä¿®æ”¹ã€‚</span><br><span class="line">å•ä¸ªæ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹ï¼š</span><br><span class="line"></span><br><span class="line">git checkout -- filename</span><br><span class="line"></span><br><span class="line">æ‰€æœ‰æ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹ï¼š</span><br><span class="line"></span><br><span class="line">git checkout .</span><br><span class="line"> </span><br><span class="line">2. æœ¬åœ°æ–°å¢äº†ä¸€å †æ–‡ä»¶(å¹¶æ²¡æœ‰git addåˆ°æš‚å­˜åŒº)ï¼Œæƒ³æ”¾å¼ƒä¿®æ”¹ã€‚</span><br><span class="line">å•ä¸ªæ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹ï¼š</span><br><span class="line"></span><br><span class="line">$ rm filename &#x2F; rm dir -rf</span><br><span class="line"></span><br><span class="line">æ‰€æœ‰æ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹ï¼š</span><br><span class="line"></span><br><span class="line">$ git clean -xdf</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; åˆ é™¤æ–°å¢çš„æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶å·²ç»å·²ç»git addåˆ°æš‚å­˜åŒºï¼Œå¹¶ä¸ä¼šåˆ é™¤ï¼</span><br><span class="line"></span><br><span class="line">3. æœ¬åœ°ä¿®æ”¹&#x2F;æ–°å¢äº†ä¸€å †æ–‡ä»¶ï¼Œå·²ç»git addåˆ°æš‚å­˜åŒºï¼Œæƒ³æ”¾å¼ƒä¿®æ”¹ã€‚</span><br><span class="line">å•ä¸ªæ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹ï¼š</span><br><span class="line"></span><br><span class="line">git reset HEAD filename</span><br><span class="line"></span><br><span class="line">æ‰€æœ‰æ–‡ä»¶&#x2F;æ–‡ä»¶å¤¹ï¼š</span><br><span class="line"></span><br><span class="line">git reset HEAD .</span><br><span class="line"> </span><br><span class="line">4. æœ¬åœ°é€šè¿‡git add &amp; git commit ä¹‹åï¼Œæƒ³è¦æ’¤é”€æ­¤æ¬¡commitå’Œä»£ç </span><br><span class="line"></span><br><span class="line">git reset commit_id</span><br><span class="line"></span><br><span class="line">è¿™ä¸ªidæ˜¯ä½ æƒ³è¦å›åˆ°çš„é‚£ä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥é€šè¿‡git logæŸ¥çœ‹ï¼Œå¯ä»¥åªé€‰å‰6ä½</span><br><span class="line">&#x2F;&#x2F; æ’¤é”€ä¹‹åï¼Œä½ æ‰€åšçš„å·²ç»commitçš„ä¿®æ”¹è¿˜åœ¨å·¥ä½œåŒºï¼</span><br><span class="line"></span><br><span class="line">git reset --hard commit_id</span><br><span class="line"></span><br><span class="line">è¿™ä¸ªidæ˜¯ä½ æƒ³è¦å›åˆ°çš„é‚£ä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥é€šè¿‡git logæŸ¥çœ‹ï¼Œå¯ä»¥åªé€‰å‰6ä½</span><br><span class="line">&#x2F;&#x2F; æ’¤é”€ä¹‹åï¼Œä½ æ‰€åšçš„å·²ç»commitçš„ä¿®æ”¹å°†ä¼šæ¸…é™¤ï¼Œä»åœ¨å·¥ä½œåŒº&#x2F;æš‚å­˜åŒºçš„ä»£ç ä¸ä¼šæ¸…é™¤ï¼</span><br><span class="line"></span><br><span class="line">5. git add &amp; git commit æäº¤åï¼Œåªæƒ³å›æ»šcommitï¼š</span><br><span class="line">	git reset --soft HEAD^</span><br><span class="line">	æ³¨æ„è¿™ä»…ä»…æ˜¯å›æ»šäº†ä½ çš„commitï¼Œä»£ç ä¾æ—§åœ¨çš„ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="æŒç»­æ›´æ–°â€¦â€¦"><a href="#æŒç»­æ›´æ–°â€¦â€¦" class="headerlink" title="æŒç»­æ›´æ–°â€¦â€¦"></a>æŒç»­æ›´æ–°â€¦â€¦</h3>]]></content>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ3ã€git czè§„èŒƒæäº¤</title>
    <url>/archives/458b44c2.html</url>
    <content><![CDATA[<h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p><a href="https://github.com/commitizen/cz-cli">å®˜æ–¹ specification</a><br>ç®€å•çš„è¯´ä¸ºäº†ä»£ç æäº¤æ›´åŠ è§„èŒƒ</p>
<h3 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h3><p>git commitä½¿ç”¨<br><a href="https://github.com/commitizen/cz-cli/raw/master/meta/screenshots/add-commit.png">https://github.com/commitizen/cz-cli/raw/master/meta/screenshots/add-commit.png</a></p>
<h3 id="ä½¿ç”¨æ­¥éª¤"><a href="#ä½¿ç”¨æ­¥éª¤" class="headerlink" title="ä½¿ç”¨æ­¥éª¤"></a>ä½¿ç”¨æ­¥éª¤</h3><ul>
<li>å®‰è£…nodejsï¼Œç‰ˆæœ¬å»ºè®®æœ€æ–°.<a href="https://nodejs.org/zh-cn/">å®˜ç½‘</a> </li>
<li>æ‰“å¼€ä½ çš„å‘½ä»¤è¡Œï¼š<a id="more"></a>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnpm install -g commitizen</span><br><span class="line">windowsåº”è¯¥æ˜¯cmdå§ã€‚</span><br><span class="line">macç”¨ç»ˆç«¯æˆ–è€…iterm2éƒ½å¯ä»¥ã€‚</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æç¤ºä»¥ä¸‹ä¿¡æ¯å³æˆåŠŸã€‚</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-&gt; % sudo npm install -g commitizen</span><br><span class="line">Password:</span><br><span class="line">npm WARN deprecated resolve-url@0.2.1: https:&#x2F;&#x2F;github.com&#x2F;lydell&#x2F;resolve-url#deprecated</span><br><span class="line">npm WARN deprecated urix@0.1.0: Please see https:&#x2F;&#x2F;github.com&#x2F;lydell&#x2F;urix#deprecated</span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;bin&#x2F;cz -&gt; &#x2F;usr&#x2F;local&#x2F;lib&#x2F;node_modules&#x2F;commitizen&#x2F;bin&#x2F;git-cz</span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;bin&#x2F;git-cz -&gt; &#x2F;usr&#x2F;local&#x2F;lib&#x2F;node_modules&#x2F;commitizen&#x2F;bin&#x2F;git-cz</span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;bin&#x2F;commitizen -&gt; &#x2F;usr&#x2F;local&#x2F;lib&#x2F;node_modules&#x2F;commitizen&#x2F;bin&#x2F;commitizen</span><br><span class="line">+ commitizen@4.2.1</span><br><span class="line">updated 1 package in 8.132s</span><br></pre></td></tr></table></figure>
3ã€è¿›å…¥gité¡¹ç›®ä¸­ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤åˆå§‹åŒ–ç¯å¢ƒã€‚<br><code>commitizen init cz-conventional-changelog --save --save-exact</code></li>
</ul>
<p>4ã€åœ¨æäº¤ä»£ç æ—¶ä½¿ç”¨</p>
<blockquote>
<p>git cz æ›¿æ¢ git commitå‘½ä»¤</p>
</blockquote>
<h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><ul>
<li>å®‰è£…æ–¹å¼å¯é€‰æ‹©å…¨å±€å®‰è£…<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install -g commitizen cz-conventional-changelog</span><br><span class="line">echo &#39;&#123; &quot;path&quot;: &quot;cz-conventional-changelog&quot; &#125;&#39; &gt; ~&#x2F;.czrc</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ2ã€vscode å¸¸è§æ’ä»¶åŠå…¶ä½¿ç”¨</title>
    <url>/archives/8cf3cbca.html</url>
    <content><![CDATA[<blockquote>
<p>vscodeä¸­ä¸€äº›å¸¸è§çš„å‘ç‚¹â€¦</p>
</blockquote>
<h3 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h3><h4 id="æ ·å¼æ–¹é¢ï¼š"><a href="#æ ·å¼æ–¹é¢ï¼š" class="headerlink" title="æ ·å¼æ–¹é¢ï¼š"></a>æ ·å¼æ–¹é¢ï¼š</h4><ul>
<li>Indent Rainbo</li>
<li>Bracket Pair Colorizer # æ‹¬å·é¢œè‰²</li>
<li>Chinese Language       # æ±‰åŒ–<a id="more"></a>

</li>
</ul>
<h4 id="åŠŸèƒ½æ–¹é¢"><a href="#åŠŸèƒ½æ–¹é¢" class="headerlink" title="åŠŸèƒ½æ–¹é¢"></a>åŠŸèƒ½æ–¹é¢</h4><ul>
<li>Git Blame              # Gitæäº¤æŸ¥çœ‹</li>
<li>Code Spell Checker     # æ‹¼å†™æ£€æŸ¥</li>
<li>Reload                 # é‡æ–°åŠ è½½</li>
<li>Todo Tree              # ä»£åŠäº‹é¡¹</li>
<li>Settings Sync          # è®¾ç½®åŒæ­¥</li>
</ul>
]]></content>
      <tags>
        <tag>vscode</tag>
        <tag>å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Œ1ã€é‡æ‹¾é‚£ä»½æŠ˜è…¾ä¹‹å¿ƒï¼Œåšå®šè„šæ­¥</title>
    <url>/archives/640b5696.html</url>
    <content><![CDATA[<pre><code>ä»å‰ï¼Œç°åœ¨ï¼Œå°†æ¥...</code></pre>
]]></content>
      <tags>
        <tag>life</tag>
      </tags>
  </entry>
</search>
